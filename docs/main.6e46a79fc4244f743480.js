(()=>{var t={21:t=>{t.exports='<div class="w3-animate-left">\r\n  <div class="w3-teal w3-padding">TypeScript-app</div>\r\n\t<div class="w3-bar w3-black w3-card">\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-HOME"><i class="fa fa-home" aria-hidden="true"></i></button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-TABLES">Tablas-ListView</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-PUB-SUB">Pub-Sub</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-COMMANDS">Commands</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-REPORTS">Reports</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-REPORTS-V2">Reports V2</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-REPORTS-JS">JsReports</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-CONTENT-EDITABLE">Content-editable</button>\r\n  </div>\r\n\r\n  <div id="VIEW-TABLES"     class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n  <div id="VIEW-PUB-SUB"    class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-COMMANDS"   class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-REPORTS"    class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-REPORTS-V2" class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-REPORTS-JS" class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n  <div id="VIEW-CONTENT-EDITABLE" class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\r\n  <div id="VIEW-HOME" class="w3-display-container city w3-animate-opacity">\r\n    <div class="w3-teal w3-center w3-padding">Página principal</div>\r\n    <div class="w3-padding">\r\n      <p>\r\n        Prueba de concepto de un framework para el desarrollo de aplicaciones con TypeScript.\r\n      </p>\r\n      <button class="w3-button w3-border" on-click="doAction:tree">core.tree</button>\r\n      <button class="w3-button w3-border" on-click="doAction:bar">Bar chart</button>\r\n      <button class="w3-button w3-border" on-click="doAction:svg-bar">Svg bar chart</button>\r\n      <button class="w3-button w3-border" on-click="doAction:pie">Pie chart</button>\r\n      <button class="w3-button w3-border" on-click="doAction:lines">Line chart</button>\r\n    </div>\r\n\r\n    <div class="w3-container" on-publish="msg/main-page/test/content"></div>\r\n\r\n  </div>\r\n\r\n</div>'},101:t=>{t.exports="\r\n.svc_viewer{overflow:hidden;}\r\n.scv_Main  {position:absolute;top:0;left:0;right:0;bottom:0;overflow:auto;padding:0;}     \r\n.scv_TextContainer{ position:absolute;top:0;left:4.4em;right:0;height:auto;z-index:4;margin:0;user-select: text; }\r\n.scv_TextContainer{ padding:.4em;white-space:pre;overflow:initial;font-family:Monospace;tab-size:4;}\r\n.scv_LineContainer{ padding:.4em;position:absolute;top:0;left:0;height:auto;margin:0;z-index:5;overflow:hidden;background-color:lightyellow;border-right:solid 1px silver;}\r\n.scv_LineContainer{ font-weight:bold;font-family:Monospace;color:Gray;text-align:right;width:3.5em;box-sizing:border-box;user-select:none }\r\n"},100:t=>{t.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">CommandManager</div>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <p style="text-indent:1em;">\r\n      Ejemplo de uso del manejador de comandos que permite hacer y deshacer operaciones sobre un objeto o "documento".\r\n    </p>\r\n\r\n    <button on-click="doCommand">Probar comando</button>\r\n    <div message-container class="w3-container w3-padding">\r\n\r\n    </div>\r\n\r\n    <p style="text-indent:1em;">\r\n      <h3>Código del ejemplo</h3>\r\n      <div class="w3-code jsHigh notranslate" style="overflow: auto;white-space: pre;">var _commandManager = CommandManager(this._document);\r\nthis._document.name = \'Valor inicial\';\r\nlet __container = this._content.querySelector&lt;HTMLElement&gt;(\'[message-container]\');\r\n__container.innerHTML = this._document.name + \'&lt;br/&gt;\';\r\nthis._commandManager.executeCommad(ToUpperCaseCommand());\r\n__container.innerHTML += this._document.name + \'&lt;br/&gt;\';\r\nthis._commandManager.undo();\r\n__container.innerHTML += this._document.name + \'&lt;br/&gt;\';\r\nthis._commandManager.redo();\r\n__container.innerHTML += this._document.name + \'&lt;br/&gt;\';</div>\r\n    </p>\r\n\r\n    <p style="text-indent:1em;">\r\n      <h3>Código del comando</h3>\r\n      Comando para convertir el contenido del documento a mayúsculas y reestablecer su estado si se deshace la operación.\r\n      <div class="w3-code jsHigh notranslate" style="overflow: auto;white-space: pre;">function ToUpperCaseCommand(): Command {\r\nlet __command = {\r\n  bak     : \'\',\r\n  execute : function (doc:any): Command {\r\n    this.bak = doc.name;\r\n    doc.name = doc.name.toUpperCase();\r\n    return __command;\r\n  },\r\n  undo    : function (doc:any): Command {\r\n    doc.name = this.bak;\r\n    return __command;\r\n  }\r\n}\r\nreturn __command;\r\n}</div>\r\n    </p>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},549:t=>{t.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">Content-editable</div>\r\n\r\n  <h2 class="w3-margin">\r\n    Edición de tablas.\r\n  </h2>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <table class="w3-table-all"> \r\n      <thead>\r\n        <tr>\r\n          <th style="width:1%;"></th>\r\n          <th class="">Id</th>\r\n          <th class="">Descripción</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr xbind xfor="item in this.data" id="row-{item.id}">\r\n          <td xbind class="w3-border-right">\r\n            <input type="checkbox" disabled />\r\n          </td>\r\n          <td><div xbind data-index="{index}" contenteditable="true">{item.id}</div></td>\r\n          <td><div xbind data-index="{index}" contenteditable="true">{item.descripcion}</div></td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <div class="w3-padding">\r\n      <button on-click="doSave">Guardar</button>\r\n    </div>\r\n\t  <div log class="w3-code w3-padding" style="overflow: auto;white-space: pre;" on-publish="msg/log:writeLog:append"></div>\r\n\r\n  </div>\r\n\r\n  <h2 class="w3-margin">\r\n    Visor de texto\r\n  </h2>\r\n  <div class="w3-container w3-margin w3-round w3-border" style="height:250px;position:relative" text-viewer>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},345:t=>{t.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">Pub-Sub</div>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <p style="text-indent:1em;">\r\n      Ejemplo de uso del patrón Publisher/Subscriber.\r\n    </p>\r\n    <button on-click="doPublish">Publicar mensaje</button>\r\n\t  <div class="w3-container w3-padding" on-publish="TOPICS.NOTIFICATION:innerHTML">\r\n    </div>\r\n\r\n    <p style="text-indent:1em;">\r\n      <h3>Código Js del ejemplo</h3>\r\n      <div class="w3-code jsHigh notranslate" style="overflow: auto;white-space: pre;">import pubSub from \'../../lib/core.pub-sub\';\r\ndoPublish : function(){\r\n  pubSub.publish(pubSub.TOPICS.NOTIFICATION, \'Botón doPublish\'); \r\n  setTimeout( function(){\r\n    pubSub.publish(pubSub.TOPICS.NOTIFICATION, \'\'); \r\n  }, 2000);\r\n}</div>\r\n      <h3>Html</h3>\r\n      <div class="w3-code htmlHigh notranslate" style="overflow: auto;white-space: pre;">&lt;div class="w3-container w3-padding" on-publish="TOPICS.NOTIFICATION:innerHTML"&gt;</div>\r\n    </p>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},445:t=>{t.exports="<div>\r\n\r\n  <div class=\"w3-teal w3-center w3-padding\">Informes Js</div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Listado</h3>\r\n      <ul>\r\n        <li>En esta versión TODO el contenido del informe está en un único fichero javaScript. Este fichero se incluye como un <code class=\"w3-codespan\">include('./js/pro-0001.js').then((cancel:Function) => {}</code>.</li>\r\n        <li>La generación del contenido se realiza por medio de <code class=\"w3-codespan\">String.format(context)</code>.\r\n         <div class=\"w3-code jsHigh notranslate\" \r\n             style=\"overflow: auto;white-space: pre;\">'{0|toFixed,2}'.format(55);\r\n'{0|toUpperCase}'.format('aaa');\r\n'{0|toUpperCase:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format=>1;2}'.format('aaa', { format(value,a,b){ return '->' + value + a + b; } });\r\n'{format}'.format({ id : 55, format(){ return this.id; }});\r\n'{format:url;@window.location.href|toUpperCase b}'.format({ format(value, href, b){ return value + ' ' + href;}});\r\n'{id}'.format({ id : 55, format(){ return this.id; }});\r\n'{id|toFixed,3}'.format({ id : 55 });\r\n'{id|toFixed,3:format}'.format({ id : 55, format(v){ return v + ' €'; }});\r\n'{id:format=>@window.location.href|toUpperCase;b;c}'.format({ id : 55, format(v,a,b,c){ return v + ' €'; }});</div>\r\n        </li>\r\n        <li>Es posible especificar una plantilla o una función para crear el contenido <code class=\"w3-codespan\">CREATE group key:_descripcion id:Group01_tipo headerValueProviderfn:BS.fn.header_provider_fn</code>.</li>\r\n        <li>Se pueden crear una o más secciones de cabecera y de resumen del informe.</li>\r\n        <li>Se pueden crear una o más secciones de detalle.</li>\r\n        <li>Se pueden crear agrupaciones y dentro de estas indicar una cabecera y pie de grupo.</li>\r\n      </ul>\r\n    </p>\r\n    <div class=\"w3-padding w3-border\" report-container=\"\" style=\"overflow:auto; max-height:400px;\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Código JavaScript</h3>\r\n      <div class=\"w3-code jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre; height:200px\">import { ReportEngine } from '../../lib/core.tabbly.v2.engine';\r\nimport { loader } from '../../lib/core.tabbly.v2.loader';\r\n\r\nprivate __loadReport(target:HTMLElement){\r\n    \r\n    /* ==========================================================================\r\n    // Receptor de mensajes\r\n    // ========================================================================*/\r\n    var __handler = { \r\n      buffer  : '' ,\r\n      send    : function(data:string){ this.buffer += data; },\r\n      message : function(message:any){ \r\n        /*console.log(message);*/ \r\n      },\r\n      flush   : function(){ },\r\n      clear   : function(){ this.buffer = ''; }\r\n    };\r\n\r\n    /* =============================================================================\r\n    // Definición del informe\r\n    // ===========================================================================*/\r\n    include('./js/pro-0001.js').then((cancel:Function) => {\r\n      var __rd = (window as any).__reportDefinition(loader, core);\r\n      /* =======================================================================\r\n      // Cargar los datos\r\n      // =====================================================================*/\r\n      ajax.get('./js/data/proveedores.json')\r\n          .then((res:string) => {\r\n            __handler.clear()\r\n            new ReportEngine().generateReport(__rd, JSON.parse(res), __handler);\r\n            target.appendChild(core.build('div', { innerHTML : __handler.buffer }));\r\n            addEventListeners(target, {}, __rd.getContext());\r\n            cancel();      \r\n      });\r\n    });     \r\n}</div>\r\n    </p>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Definición del informe</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/definition:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/data:localInnerText\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>"},794:t=>{t.exports="<div>\r\n\r\n  <div class=\"w3-teal w3-center w3-padding\">Informes V2</div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Listado</h3>\r\n      <ul>\r\n        <li>En esta versión el fichero se carga por medio de Ajax. Las funciones javaScript están definidas en el fichero de texto.</li>\r\n        <li>La generación del contenido se realiza por medio de <code class=\"w3-codespan\">String.format(context)</code>.\r\n         <div class=\"w3-code jsHigh notranslate\" \r\n             style=\"overflow: auto;white-space: pre;\">'{0|toFixed,2}'.format(55);\r\n'{0|toUpperCase}'.format('aaa');\r\n'{0|toUpperCase:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format=>1;2}'.format('aaa', { format(value,a,b){ return '->' + value + a + b; } });\r\n'{format}'.format({ id : 55, format(){ return this.id; }});\r\n'{format:url;@window.location.href|toUpperCase b}'.format({ format(value, href, b){ return value + ' ' + href;}});\r\n'{id}'.format({ id : 55, format(){ return this.id; }});\r\n'{id|toFixed,3}'.format({ id : 55 });\r\n'{id|toFixed,3:format}'.format({ id : 55, format(v){ return v + ' €'; }});\r\n'{id:format=>@window.location.href|toUpperCase;b;c}'.format({ id : 55, format(v,a,b,c){ return v + ' €'; }});</div>\r\n        </li>\r\n        <li>Es posible especificar una plantilla o una función para crear el contenido <code class=\"w3-codespan\">CREATE group key:_descripcion id:Group01_tipo headerValueProviderfn:BS.fn.header_provider_fn</code>.</li>\r\n        <li>Se pueden crear una o más secciones de cabecera y de resumen del informe.</li>\r\n        <li>Se pueden crear una o más secciones de detalle.</li>\r\n        <li>Se pueden crear agrupaciones y dentro de estas indicar una cabecera y pie de grupo.</li>\r\n      </ul>\r\n    </p>\r\n    <div class=\"w3-padding w3-border\" report-container style=\"overflow:auto; max-height:400px;\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Código JavaScript</h3>\r\n      <div class=\"w3-code jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre; height:200px\">import { ReportEngine } from '../../lib/core.tabbly.v2.engine';\r\nimport { loader } from '../../lib/core.tabbly.v2.loader';\r\n\r\nprivate __loadReport(target:HTMLElement){\r\n    \r\n    /* ==========================================================================\r\n    // Receptor de mensajes\r\n    // ========================================================================*/\r\n    var __handler = { \r\n      buffer  : '' ,\r\n      send    : function(data:string){ this.buffer += data; },\r\n      message : function(message:any){ \r\n        /*console.log(message);*/ \r\n      },\r\n      flush   : function(){ },\r\n      clear   : function(){ this.buffer = ''; }\r\n    };\r\n\r\n    /* =============================================================================\r\n    // Definición del informe\r\n    // ===========================================================================*/\r\n    ajax.get('./js/pro-0001-v2.txt')\r\n        .then((res:string) => {\r\n          var __rd = loader.load(res);\r\n          /* =======================================================================\r\n          // Datos del informe\r\n          // =====================================================================*/\r\n          ajax.get('./js/data/proveedores.json')\r\n              .then((res:string) => {\r\n                new ReportEngine().generateReport(__rd, JSON.parse(res), __handler);\r\n                target.appendChild(core.build('div', { innerHTML : __handler.buffer }));\r\n\r\n                addEventListeners(target, {}, __rd.getContext());            \r\n              });                          \r\n        });      \r\n}</div>\r\n    </p>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Definición del informe</h3>\r\n      <div class=\"w3-code w3-border\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/definition:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/data:localInnerText\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"},287:t=>{t.exports="<div>\r\n\r\n  <div class=\"w3-teal w3-center w3-padding\">Informes</div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Listado</h3>\r\n        <ul>\r\n          <li>Esta es la primera versión del generador de informes (Tabbly). Primeramente se genera una tabla html con la información del fichero.\r\n          Esta tabla se corresponde con la estructura del informe. Se le aplica la función de transformación para generar el contenido.\r\n          </li>\r\n          <li>La generación del contenido se realiza por medio de <code class=\"w3-codespan\">__fillTemplate(e: HTMLElement, scope : any)</code>.</li>\r\n          <li>El fichero .txt con la definición del informe se carga por medio de Ajax generalmente. Las funciones javaScript están definidas en el fichero de texto.</li>\r\n          <li>La función de transformación <code class=\"w3-codespan\">__fillTemplate</code> es la propia del motor</li>\r\n          <li>Se utiliza la función <code class=\"w3-codespan\">core.getValue(key : string, scope? : any)</code> por lo que se puede \r\n          aplicar una función del prototipo al valor solicitado. <code class=\"w3-codespan\">libro.name|htmlDecode,p1,p2,...</code></li>\r\n          <li>Se pueden establecer valores de atributos. <code class=\"w3-codespan\">ADD_COL xbind:'' id:'txt-{BS.data._id}'</code></li>\r\n          <li>\r\n            Se puede utilizar el reemplazo de cadena <code class=\"w3-codespan\">DEFINE  __COL_5_INNERHTML = &lt;div class=\"w3-red\"&gt;&lt;h2 xbind>{BS.data._nombre|toUpperCase}&lt;/h2&gt;&lt;/div&gt;</code>\r\n            La función de transformación <code class=\"w3-codespan\">merge(template: string, scope: any, HTMLElemnt?:HTMLElement)</code> es la de core.templates\r\n          </li>\r\n          <li>Merge:<br />\r\n    <div class=\"w3-code jsHigh notranslate\" \r\n             style=\"overflow: auto;white-space: pre;\">'{0|toFixed,2}'.format(55);\r\n'{0|toUpperCase}'.format('aaa');\r\n'{0|toUpperCase:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format=>1;2}'.format('aaa', { format(value,a,b){ return '->' + value + a + b; } });\r\n'{format}'.format({ id : 55, format(){ return this.id; }});\r\n'{format:url;@window.location.href|toUpperCase b}'.format({ format(value, href, b){ return value + ' ' + href;}});\r\n'{id}'.format({ id : 55, format(){ return this.id; }});\r\n'{id|toFixed,3}'.format({ id : 55 });\r\n'{id|toFixed,3:format}'.format({ id : 55, format(v){ return v + ' €'; }});\r\n'{id:format=>@window.location.href|toUpperCase;b;c}'.format({ id : 55, format(v,a,b,c){ return v + ' €'; }});</div>\r\n          </li>\r\n          <li>Para establecer los valores con xbind se puede utilizar:\r\n            <ul>\r\n              <li><code class=\"w3-codespan\">xbind:'innerHTML:BS.data._nif|toUpperCase'</code></li>\r\n              <li><code class=\"w3-codespan\">xbind:'innerHTML:BS.fn.fixDate2 @BS.data._fechaDeAlta,abc,9'</code> la función recibe los parámetros de la siguiente forma  <code class=\"w3-codespan\"></code> function(scope, sender, value, a, b, c)</li>\r\n              <li><code class=\"w3-codespan\">xbind:'innerHTML:BS.data._fechaDeAlta BS.fn.fixDate extraParams'</code> la función recibe los parámetros de la siguiente forma  <code class=\"w3-codespan\">function(_value, extraParams, scope, child);</code></li>\r\n            </ul>          \r\n          </li>\r\n        </ul>\r\n    </p>\r\n\r\n    <div class=\"w3-padding w3-border\" report-container=\"4\" style=\"overflow:auto; max-height:400px;\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Código JavaScript</h3>\r\n      <div class=\"w3-code jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre; height:200px\">import { ReportEngine as reportEngine } from '../../lib/core.tabbly.engine';\r\nimport { loader as reportLoader } from '../../lib/core.tabbly.loader';\r\n\r\najax.get('./js/pro-0001.txt')\r\n    .then((res:string) => {\r\n      var __rd = reportLoader.load(res);\r\n\r\n      pubSub.publish('msg/rpt/definition', res);\r\n\r\n      ajax.get('./js/data/proveedores.json')\r\n          .then((res:string) => {\r\n\r\n            pubSub.publish('msg/rpt/data', res);\r\n\r\n            new reportEngine()\r\n              .fromReportDefinition(__rd, JSON.parse(res), (html:string) => { \r\n                target.append(core.build('div', { innerHTML : html }, true));\r\n                addEventListeners(target, {}, __rd.getContext());                       \r\n              });\r\n                \r\n          });              \r\n    });      \r\n}</div>\r\n    </p>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Definición del informe</h3>\r\n      <div class=\"w3-code w3-border\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/definition:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/data:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"},640:t=>{t.exports='<div class="">\r\n\r\n  <div header class="w3-bar w3-border-bottom ">\r\n    <button class="w3-button w3-xlarge w3-left fa fa-th-large w3-border-right" \r\n            style="padding: 7px 4px;" \r\n            title="Rejilla"\r\n            on-click="doAction:grid"\r\n            on-publish="msg/view/change:syncViewButtons:grid"></button>\r\n    <button class="w3-button w3-xlarge w3-left fa fa-bars w3-border-right" \r\n            style="padding: 7px 4px;" \r\n            title="Lista" \r\n            on-click="doAction:list"\r\n            on-publish="msg/view/change:syncViewButtons:list"></button>\r\n\r\n    <span xbind="innerHTML:title" class="w3-left" style="padding:6px 0 4px 8px;"></span>\r\n\r\n    <button class="w3-button w3-xlarge w3-right fa fa-plus w3-border-left" style="padding: 7px 4px;" title="Insertar" on-click="doAction:new"></button>\r\n    <button class="w3-button w3-xlarge w3-right fa fa-trash w3-border-left" style="padding: 7px 4px;" title="Eliminar" on-click="doAction:delete"></button>\r\n    <button class="w3-button w3-xlarge w3-right fa fa-edit w3-border-left" style="padding: 9px 4px 5px 4px;" title="Editar" on-click="doAction:edit"></button>\r\n\r\n    <button on-click="doAction:last" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10095;&#10095;</button>\r\n    <button on-click="doAction:next" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10095;</button>\r\n    <input on-change="doGoToPage" xbind="value:currentPage" class="w3-right w3-center" style="width: 3em;padding:8px; border:none" />\r\n    <button on-click="doAction:previous" class="w3-button w3-right w3-border-left w3-border-right" style="padding: 8px;">&#10094;</button>\r\n    <button on-click="doAction:first" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10094;&#10094;</button>\r\n\r\n  </div>\r\n\r\n  <div list-view-body style="overflow:auto">\r\n\r\n  </div>\r\n\r\n</div>\r\n'},933:t=>{t.exports='<div class="">\r\n\r\n  <h1>Proveedores</h1>\r\n\r\n  <div header class="w3-bar w3-border-top w3-border-left w3-border-right">\r\n\r\n    <span xbind="innerHTML:title" class="w3-left" style="padding:6px 0 4px 8px;"></span>\r\n\r\n    <button class="w3-button w3-xlarge w3-right fa fa-plus w3-border-left" style="padding: 7px 4px;" title="Insertar" on-click="doAction:new"></button>\r\n    <button class="w3-button w3-xlarge w3-right fa fa-trash w3-border-left" style="padding: 7px 4px;" title="Eliminar" on-click="doAction:delete"></button>\r\n    <button class="w3-button w3-xlarge w3-right fa fa-edit w3-border-left" style="padding: 9px 4px 5px 4px;" title="Editar" on-click="doAction:edit"></button>\r\n\r\n    <button on-click="doAction:last" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10095;&#10095;</button>\r\n    <button on-click="doAction:next" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10095;</button>\r\n    <input on-change="doGoToPage" xbind="value:currentPage" class="w3-right w3-center" style="width: 3em;padding:8px; border:none" />\r\n    <button on-click="doAction:previous" class="w3-button w3-right w3-border-left w3-border-right" style="padding: 8px;">&#10094;</button>\r\n    <button on-click="doAction:first" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10094;&#10094;</button>\r\n\r\n    <div class="w3-right w3-border-left" style="margin:0; padding:0">\r\n      <input on-change="doSearch" type="text" class="w3-right" style="padding:8px; border:none" placeholder="Buscar.." /> \r\n    </div>\r\n\r\n  </div>\r\n\r\n  <table class="w3-table-all">\r\n    <thead>\r\n      <tr on-click="doSort">\r\n        <th style="width:1%;"></th>\r\n        <th class="w3-hover-gray sorteable">Id</th>\r\n        <th class="w3-hover-gray sorteable">Nif</th>\r\n        <th class="w3-hover-gray sorteable">Nombre</th>\r\n        <th class="w3-hover-gray sorteable">Descripción</th>\r\n        <th class="w3-hover-gray sorteable">Fecha</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr xbind xfor="proveedor in this.visibleItems" id="row-{proveedor._id}">\r\n        <td xbind class="w3-border-right">\r\n          <input xbind="checked:fn.checked=>@proveedor" type="checkbox" on-click="doAction:check-item:{index}" />\r\n        </td>\r\n        <td xbind on-click="doAction:edit-row:{proveedor._id}">{proveedor._id}</td>\r\n        <td xbind>{proveedor._nif}</td>\r\n        <td xbind>{proveedor._nombre}</td>\r\n        <td xbind>{proveedor._descripcion|toUpperCase}</td>\r\n        <td xbind>\r\n          {proveedor._fechaDeAlta|fixDate}\r\n          <button xbind title="Añadir a favoritos" class="fa fa-star" style="float:right" on-click="doAddToFavorites:{proveedor._id}"></button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n\r\n  <form id="proveedor-edit-dialog" class="" style="display:none">\r\n    <label for="txt-id">Id</label>\r\n    <input xbind="value:_id" id="txt-id" type="text" class="w3-input w3-border w3-round" readonly /><br />\r\n    <label for="txt-nif">Nif</label>\r\n    <input xbind="value:_nif" id="txt-nif" type="text" class="w3-input w3-border w3-round" /><br />\r\n\r\n    <label for="txt-nombre">Nombre</label>\r\n    <input xbind="value:_nombre" id="txt-nombre" type="text" class="w3-input w3-border w3-round"  /><br />\r\n    <label for="txt-descripcion">Descripción</label>\r\n    <input xbind="value:_descripcion" id="txt-descripcion" type="text" class="w3-input w3-border w3-round" /><br />\r\n  </form>\r\n\r\n</div>\r\n'},500:t=>{t.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">Edición de entidades/ListView</div>\r\n\r\n  <div class="w3-padding">\r\n    <h3>ListView</h3>\r\n    <p style="text-indent:1em;">\r\n      Ejemplo de la implementación de un ListView que utiliza JsReports para la generación del contenido. \r\n      Se crea una cabecera, un grupo, el detalle y finalmente un pie de grupo en el que se hace un resumen de los elementos listados en cada grupo.\r\n    </p>\r\n    <div list-view-container>\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class="w3-padding">\r\n    <p style="text-indent:1em;">\r\n      <h3>Página de edición de entidades</h3>\r\n      Ejemplo de una página para la edición de entidades. Se utiliza FillTemplate para la generación de la tabla.\r\n    </p>\r\n    <div class="w3-padding w3-border" table-container>\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <div class="w3-half w3-padding">\r\n      <h3>Código JavaScript</h3>\r\n      <div class="w3-code w3-border js notranslate" \r\n           style="overflow: auto;white-space: pre;" >/* ==========================================================================\r\n// Manejadores de eventos de los botones de navegación\r\n// ========================================================================*/        \r\naddEventListeners( \r\n  container, {\r\n    doAction : (sender:HTMLElement, event:MouseEvent, name:any, data:any) => {\r\n      this.doAction({name, data });\r\n    },\r\n    doGoToPage : (sender:HTMLInputElement, event:MouseEvent) => {\r\n      this.doAction({name: \'page\', data : sender.value});\r\n    },\r\n    doSearch : (sender:HTMLInputElement, event:MouseEvent) => {\r\n      this.doAction({name: \'search\', data : sender.value});\r\n    },\r\n    doSort : (sender:HTMLElement, event:MouseEvent) => {\r\n      let __field = [\'_id\',\r\n                     \'_nif\',\r\n                     \'_nombre\',\r\n                     \'_descripcion\',\r\n                     \'_fechaDeAlta\'][(event.target as HTMLTableCellElement).cellIndex - 1];\r\n      this.doSort(__field);\r\n    }\r\n  }, {});\r\n\r\n/* ==========================================================================\r\n// Generación de la tabla\r\n// ========================================================================*/\r\nsyncTable() {\r\n  this.syncTitle();\r\n  this._tbody.innerHTML = \'\';\r\n  this._tbody.appendChild(this._tr_template.cloneNode(true));\r\n    \r\n  (this.paginationInfo as any).fn = {\r\n    checked : (proveedor:any, b:HTMLInputElement) => { \r\n      return proveedor.__checked ? \'checked\' : \'\';\r\n    }\r\n  }\r\n\r\n  addEventListeners( \r\n    fillTemplate(this._tbody, this.paginationInfo), \r\n    {\r\n      doAction : (sender:HTMLElement, event:MouseEvent, name:any, data:any) => {\r\n        this.doAction({name, data });\r\n      },\r\n      doAddToFavorites: (sender: HTMLButtonElement, event:MouseEvent, name:any, data:any) => {\r\n        console.log(\'Current -> Id : {_id}, Nif : {_nif}\'.merge(this.proveedores[0])); \r\n        console.log(this.proveedores.select(\'_id\'));\r\n        console.log(\'Add to favorites {0}, {1}\'.format(1, 2));\r\n      }\r\n    }, {});\r\n}\r\n\r\n/* ==========================================================================\r\n// Actualización de la cabecera de la tabla\r\n// ========================================================================*/\r\nsyncTitle() {\r\n  let __total      = this.paginationInfo.totalItems\r\n  let __selected   = this.paginationInfo.getChecked().length;\r\n  let __template   = \'Proveedores: {0} elementos\'.format(__total);\r\n  let __template_s = \' ({0} seleccionados)\'.format(__selected);\r\n  if (__selected) {\r\n    this.paginationInfo.title = __template + __template_s;\r\n  } else {\r\n    this.paginationInfo.title = __template;\r\n  }\r\n  fillTemplate(this._header, this.paginationInfo);\r\n}</div>\r\n    </div>\r\n\r\n    <div class="w3-half w3-padding">\r\n      <h3>Plantilla de transformación</h3>\r\n      <div class="w3-code w3-border" \r\n           style="overflow: auto;white-space: pre;" \r\n           on-publish="msg/table/template:localInnerText:html">\r\n      </div>\r\n    </div>\r\n\r\n    <div class="w3-half w3-padding">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class="w3-code w3-border jsHigh notranslate" \r\n           style="overflow: auto;white-space: pre;" \r\n           on-publish="msg/table/data:localInnerText:js">\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n'}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(21),e=n.n(t),r=function(){function t(){}return t.APP_CONFIG_NAME="ts-app",t.COLORS={GOLD:"Gold",SILVER:"Silver",BRONZE:"Bronze"},t}();function o(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}Object.create,Object.create;var i=new(function(){function t(){}return t.prototype.isNull=function(t){return null===t},t.prototype.toArray=function(t){return Array.from?Array.from(t):Array.prototype.slice.call(t)},t.prototype.isArray=function(t){return Array.isArray(t)},t.prototype.isString=function(t){return"string"==typeof t},t.prototype.isBoolean=function(t){return"boolean"==typeof t},t.prototype.isNumber=function(t){return"number"==typeof t},t.prototype.isFunction=function(t){return"function"==typeof t},t.prototype.isObject=function(t){return t&&"object"==typeof t},t.prototype.apply=function(t,e,n){if(n&&this.apply(t,n),t&&e&&this.isObject(e))for(var r in e)this.isArray(e[r])?t[r]=this.clone(e[r]):this.isObject(e[r])?this.apply(t[r]=t[r]||{},e[r]):t[r]=e[r];return t},t.prototype.clone=function(t){var e=this;return this.isArray(t)?t.slice(0):this.isObject(t)&&t.clone?t.clone():this.isObject(t)?Object.keys(t).reduce((function(n,r){return n[r]=e.clone(t[r]),n}),{}):t},t.prototype.join=function(t,e,n){return t.reduce((function(t,n){return t.append(n[e||"id"])}),[]).join(void 0===n?"-":n||"")},t.prototype.createStringBuilder=function(t){return{value:t||"",append:function(t){return this.value=this.value+t,this},appendLine:function(t){return this.value=this.value+(t||"")+"\n",this}}},t.prototype.$=function(t,e){var n;return document.getElementById(t)||((n=e?e.querySelectorAll(t):document.querySelectorAll(t)).length?n.toArray():null)},t.prototype.element=function(t,e){return document.getElementById(t)||this.elements(t,e)[0]},t.prototype.elements=function(t,e){return(e||document).querySelectorAll(t).toArray()},t.prototype.build=function(t,e,n){var r=this.isString(e)?{innerHTML:e}:e,o=this.apply(document.createElement(t),r);return n?o.firstElementChild:o},t.prototype.parseQueryString=function(){return location.search.slice(1).split("&").reduce((function(t,e){return t[e.split("=")[0]]=e.split("=")[1]||"",t}),{})},t.prototype.config=function(t){return{write:function(e,n){return localStorage.setItem("{0}.{1}".format(t,e),n),this},read:function(e){return localStorage.getItem("{0}.{1}".format(t,e))}}},t.prototype.getValue=function(t,e){return t.split(/\.|\[|\]/).reduce((function(t,e){if(""===e)return t;if("this"===e)return t;var n=e,r=e.indexOf("|")>-1,o=[];if(r){var a=String.trimValues(e.split("|"));n=a[0],o=String.trimValues(a[1].split(","))}var s=t[n];return void 0===s&&t.outerScope&&(s=i.getValue(n,t.outerScope)),null!=s?r?s.__proto__[o[0]].apply(s,o.slice(1)):s:t===self?"":self}),e||self)},t}());String.leftPad=function(t,e,n){var r=""+t;for(null!=n&&""!==n||(n=" ");r.length<e;)r=n+r;return r},String.trimValues=function(t){return t.map((function(t){return t.trim()}))},String.prototype.format=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1]||self,r=function(t,e,r){var o=String.trimValues(e).reduce((function(t,e){return t.push("@"==e.charAt(0)?i.getValue(e.slice(1),n):e),t}),r);return t.apply(n,o)};return this.replace(/\{(\d+|[^{]+)\}/g,(function(e,o){var a,s=String.trimValues(o.split(":")),d=s[0],c=s[1];if(/^\d+/.test(d)){var l=String.trimValues(d.split("|")),u=~~l[0],p=0==l.length?"data":["data"].concat(l.slice(1)).join("|"),h={data:t[u],outerScope:n};a=i.getValue(p,h)}else a=i.getValue(d,n);if(i.isFunction(a))return r(a,c?c.split(/\s|\;/):[],[]);if(c){var f=String.trimValues(c.split(/=>/)),m=f[0],g=f[1];return r(i.getValue(m,n),g?g.split(/\s|\;/):[],[a])}return a}))},String.prototype.replaceAll=function(t,e){return this.split(t).join(e)},String.prototype.fixDate=function(){return this.split(" ")[0]},String.prototype.fixTime=function(){return this.split(" ")[1]},String.prototype.fixYear=function(){return this.fixDate().split("/")[2]},String.prototype.paddingLeft=function(t){return(t+this).slice(-t.length)},String.prototype.merge=function(t){return this.replace(/{([^{]+)?}/g,(function(e,n){if(n.indexOf(":")>0){var r=n.split(":");return i.getValue(r[0],t)(i.getValue(r[1],t),t)}var o=i.getValue(n,t);return"function"==typeof o?o(t):o}))},String.prototype.toXmlDocument=function(){return(new DOMParser).parseFromString(this,"text/xml")},String.prototype.htmlDecode=function(){return(new DOMParser).parseFromString(this,"text/html").documentElement.textContent},String.prototype.startsWith=String.prototype.startsWith||function(t){return 0==this.indexOf(t)},Array.prototype.remove=function(t){var e=this.indexOf(t);return-1!=e&&this.splice(e,1),this},Array.prototype.add=function(t){return this.push(t),t},Array.prototype.append=function(t){return this.push(t),this},Array.prototype.select=function(t){return i.isString(t)?this.map((function(e){return e[t]})):this.map(t)},Array.prototype.item=function(t,e,n){return this.filter((function(n){return n[t]==e}))[0]||n},Array.prototype.contains=function(t,e){return this.item(t,e)},Array.prototype.lastItem=function(){return this[this.length-1]},Array.prototype.where=function(t){return i.isFunction(t)?this.filter(t):i.isObject(t)?this.filter(new Function("a",Object.keys(t).reduce((function(e,n,r){return e+(r>0?" && ":"")+((o=t[n])instanceof RegExp?"{1}.test(a.{0})".format(n,o):i.isString(o)?"a.{0} === '{1}'".format(n,o):"a.{0} === {1}".format(n,o));var o}),"return "))):this},Array.prototype.sortBy=function(t,e){var n=[],r=t.split(",").map((function(t,e){var r=t.split(" ");return n[e]=r[1]&&"DESC"==r[1].toUpperCase()?-1:1,r[0]}));return n[0]=e?-1:1,this.sort((function(t,e){var o=0,i=function(t,e){var a=t[r[o]],s=e[r[o]];return a<s?-1*n[o]:a>s?1*n[o]:++o<r.length?i(t,e):0};return i(t,e)})),this},Array.prototype.orderBy=function(t){var e=i.isString(t)?function(e){return e[t]}:t;return this.map((function(t){return t})).sort((function(t,n){var r=e(t),o=e(n);return r<o?-1:r>o?1:0}))},Array.prototype.distinct=function(t){void 0===t&&(t="");var e=i.isString(t)?function(e){return t?e[t]:e}:t,n=[];return this.forEach((function(t){var r=e(t);-1==n.indexOf(r)&&n.push(r)})),n},Array.prototype.groupBy=function(t){return this.reduce((function(e,n){var r,o=(r=n,t.split(",").map((function(t){return r[t]})).join("__"));return(e[o]=e[o]||[]).push(n),e}),{})},Array.prototype.toGroupWrapper=function(t){var e=this,n=function(r,o,i){return t[i]={},e.distinct((function(t){return t[r]})).forEach((function(n){t[i][n]=e.reduce((function(t,e){return e[r]==n?t+e[o]:t}),0)})),n};return n},Array.prototype.sum=function(t){return this.reduce((function(e,n){return e+n[t]}),0)},Array.prototype.toDictionary=function(t,e){return this.reduce((function(n,r){return n[r[t]]=e?r[e]:r,n}),{})},Array.prototype.split=function(t){return this.reduce((function(e,n,r,i){return r%t?e:o(o([],e,!0),[i.slice(r,r+t)],!1)}),[])},Array.prototype.includes=Array.prototype.includes||function(t,e){return-1!=this.indexOf(t)},NodeList.prototype.toArray=function(){return Array.from?Array.from(this):i.toArray(this)},Object.entries=Object.entries||function(t){return Object.keys(t).map((function(e){return[e,t[e]]}))};var a=new Map,s=-1;const d={subscribe:function(t,e){a.has(t)||a.set(t,[]);var n=(++s).toString();return a.get(t).push({token:n,func:e}),n},publish:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return!!a.has(t)&&(setTimeout((function(){for(var n,r=a.get(t),i=r?r.length:0;i--;)(n=r[i]).func.apply(n,o([t],e,!1))}),0),!0)},unsubscribe:function(t){for(var e in a.keys){var n=a.get(e);if(n)for(var r=0,o=n.length;r<o;r++)if(n[r].token===t)return n.splice(r,1),t}return!1},TOPICS:{VIEW_CHANGE:"view:change",VALUE_CHANGE:"value:change",MUNICIPIO_CHANGE:"municipio:change",WINDOW_SCROLL:"window.scroll",WINDOW_RESIZE:"window.resize",NOTIFICATION:"notification.show"}};var c=["[on-click]","[on-publish]","[route-link]","[on-change]"];function l(t,e,n){var r={innerHTML:function(t,e,n){return t.innerHTML=e},innerText:function(t,e,n){return t.innerText=e},className:function(t,e){return t.className=e},append:function(t,e,n){return t.innerHTML+=e}};c.forEach((function(a,s){t.querySelectorAll(a).toArray().concat([t]).forEach((function(t){var c=a.replace("[","").replace("]","");if(t.attributes.getNamedItem(c)){var l=t.attributes.getNamedItem(c).value,u=l.split(":");if(0!==s){if(1===s){var p=i.getValue(u[0],d);p=p===window?u[0]:p,d.subscribe(p,(function(a,s){var d=u[1];if(d){var c=r[d]||e[d]||i.getValue(d,n);c&&c.apply(n,o([t,s],u.slice(2),!0))}else r.innerHTML(t,s,u[1])}))}if(2===s&&(t.onclick=function(t){return!1}),3===s){var h="SELECT"===t.tagName;if("publish"===l)return void(h?t.onchange=function(){return d.publish(d.TOPICS.VALUE_CHANGE,t)}:t.oninput=function(){return d.publish(d.TOPICS.VALUE_CHANGE,t)});var f=e[l]||i.getValue(l,n);h?t.onchange=function(){return f.apply(n,[t])}:t.oninput=function(){return f.apply(n,[t])},t.onblur=function(){return f.apply(n,[t])}}}else{var m=e[u[0]]||i.getValue(u[0],n);t.onclick=function(e){var r=u.slice(1).reduce((function(t,e){return t.push("@"==e.charAt(0)?i.getValue(e.slice(1),n):e),t}),[t,e]);return m.apply(n,r)}}}}))}))}var u={get:function(t,e){return new Promise((function(n,r){var o=u.createXMLHttpRequest();o.open("GET",t,!0),e&&e(o),o.onreadystatechange=function(){4==o.readyState&&n(o.responseText)},o.onerror=function(t){r(t)},o.send(null)}))},post:function(t,e,n){return new Promise((function(r,o){var i=u.createXMLHttpRequest();i.open("POST",t,!0),n?n(i):i.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset:ISO-8859-1"),i.onreadystatechange=function(){4==i.readyState&&r(i.responseText)},i.send(e)}))},callWebMethod:function(t,e,n){var r=u.createXMLHttpRequest();r.open("POST",t,!0),r.onreadystatechange=function(){4==r.readyState&&n(r.responseText)},r.setRequestHeader("Content-type","application/json; charset=utf-8"),r.send(e)},createXMLHttpRequest:function(){return new XMLHttpRequest}};function p(t,e,n){var r=function(t,r,o){var a=String.trimValues(r).reduce((function(t,n){return t.push("@"==n.charAt(0)?i.getValue(n.slice(1),e):n),t}),o);return n&&a.push(n),t.apply(e,a)};return t.replace(/{([^{]+)?}/g,(function(t,n){if(n.indexOf(":")>0){var o=String.trimValues(n.split(":")),a=i.getValue(o[0],e),s=String.trimValues(o[1].split(/=>/)),d=s[0],c=s[1],l=c?String.trimValues(c.split(/\s|\;/)):[];return r(i.getValue(d,e),l,[a])}var u=String.trimValues(n.split(/=>/)),p=u[0],h=u[1],f=i.getValue(p,e);return i.isFunction(f)?r(f,h.split(/\s|\;/),[]):f}))}function h(t,e){var n=t,r=n.querySelectorAll("[xfor]").toArray(),a=r.reduce((function(t,e){return t.concat(i.$("[xbind]",e))}),o([],r,!0)),s=n.querySelectorAll("[xbind]").toArray().filter((function(t){return!a.includes(t)}));return n.attributes.getNamedItem("xbind")&&s.push(n),s.forEach((function(t){if(t.attributes.getNamedItem("xif")){var n=new Function("ctx","return {0};".format(t.attributes.getNamedItem("xif").value).replaceAll("@","this."));t.style.display=n.apply(e)?"":"none"}i.toArray(t.attributes).where({value:/{[^{]+?}/g}).map((function(n){return n.value=p(n.value,e,t)})),i.toArray(t.childNodes).where({nodeType:3}).where({textContent:/{[^{]+?}/g}).forEach((function(t){return t.textContent=p(t.textContent,e,t)})),String.trimValues(t.attributes.getNamedItem("xbind").value.split(";")).forEach((function(n){if(""!==n){var r=String.trimValues(n.split(":")),o=r[0],a=r[1],s=String.trimValues(a.split(/=>/)),d=s[0],c=s[1],l=i.getValue(d,e);if(i.isFunction(l)){var u=String.trimValues((c||"").split(/\s|#/)).reduce((function(t,n){return t.push("@"==n.charAt(0)?i.getValue(n.slice(1),e):n),t}),[]);u.push(t),l=l.apply(e,u)}o&&(t[o]=l)}}))})),r.map((function(t){var n=String.trimValues(t.attributes.getNamedItem("xfor").value.split(" in ")),r=n[0],o=n[1],a=i.getValue(o,e);return a&&a!=window&&a.map((function(n,o){var a={index:o,outerScope:e};a[r]=i.clone(n);var s=h(t.cloneNode(!0),a);t.parentNode.insertBefore(s,t)})),t})).forEach((function(t){return t.parentNode.removeChild(t)})),t}function f(t,e,n){var r=i.isString(t)?i.$(t):t,o=e.reduce((function(t,e,o){var i={index:o,data:e,node:h(r.cloneNode(!0),e)};return t.nodes.push(i),n||t.html.push(i.node.outerHTML.replace(/xbind="[^"]*"/g,"")),t}),{nodes:[],html:[]});return n?o.nodes:o.html.join("")}var m=function(){function t(){}return t.createTree=function(t,e){var n=t.groupBy(e.join(","));return Object.entries(n).reduce((function(t,e){return e[0].split("__").reduce((function(t,n,r,i){return t[n]=t[n]||(r==i.length-1?{rows:o([],e[1],!0)}:{})}),t),t}),{})},t.treeToHtml=function(t,e,n){var r=0,o=function(t,i,a){var s={name:i,parent:a,deep:r++,rows:t.rows,innerHTML:"",children:Object.keys(t).where((function(t){return"rows"!=t})).sort().map((function(e){return{name:e,value:t[e]}}))};return t.rows?(r--,f(n,[s])):(s.innerHTML=s.children.reduce((function(t,e){return t+o(e.value,e.name,s)}),""),r--,e.format(s))};return o(t,"root")},t.treeToText=function(t){var e=0,n=function(t,r,o){var a={name:r,parent:o,deep:e++,rows:t.rows,innerText:"",children:Object.keys(t).where((function(t){return"rows"!=t})).sort().map((function(e){return{name:e,value:t[e]}}))};return t.rows?(e--,"{0} {1}\n{0}  {2}\n".format(" ".repeat(2*a.deep),a.name,i.join(t.rows,"ID","\n"+" ".repeat(2+2*a.deep)))):(a.innerText=a.children.reduce((function(t,e){return t+n(e.value,e.name,a)}),""),e--,"{0} {name}\n{innerText}".format(" ".repeat(2*a.deep),a))};return n(t,"root")},t}(),g=function(){function t(t,e){this.x=t,this.y=e}return t.fromArrayi=function(e){return new t(~~e[0],~~e[1])},t.sum=function(e,n){return new t(e.x+n.x,e.y+n.y)},t.difference=function(e,n){return new t(e.x-n.x,e.y-n.y)},t.dot=function(t,e){return t.x*e.x+t.y*e.y},t.cross=function(t,e){return t.x*e.y-t.y*e.x},t.distance=function(t,e){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)},t.distanceSquared=function(t,e){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},t.equals=function(t,e){return t.x==e.x&&t.y==e.y},t.lerp=function(t,e,n,r){var o=t.x,i=t.y;return r.x=(e.x-o)*n+o,r.y=(e.y-i)*n+i,r},t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.invert=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.scale=function(t,e){return this.x*=t,this.y*=e,this},t.prototype.normalize=function(){var t=1/this.length();return this.scale(t,t)},t.prototype.normalisedCopy=function(){return new t(this.x,this.y).normalize()},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.mul=function(t){return this.x*=t,this.y*=t,this},t.prototype.divide=function(t){return this.x/=t,this.y/=t,this},t.prototype.equals=function(t){return this==t||!!t&&this.x==t.x&&this.y==t.y},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.x*e-this.y*n,o=this.y*e+this.x*n;return this.x=r,this.y=o,this},t.Vector2_ZERO=new t(0,0),t.Vector2_UNIT_X=new t(1,0),t.Vector2_UNIT_Y=new t(0,1),t.Vector2_NEGATIVE_UNIT_X=new t(-1,0),t.Vector2_NEGATIVE_UNIT_Y=new t(0,-1),t.Vector2_UNIT_SCALE=new t(1,1),t.rotateAroundPoint=function(t,e,n){return t.clone().subtract(e).rotate(n).add(e)},t}(),v=function(){function t(t,e,n,r){this.left=r,this.top=t,this.right=e,this.bottom=n}return t.prototype.clone=function(){return new t(this.top,this.right,this.bottom,this.left)},t.prototype.toRect=function(){return new w(this.left,this.top,this.right-this.left,this.bottom-this.top)},t.prototype.centerPoint=function(){return new g(this.left+(this.right-this.left>>1),this.top+(this.bottom-this.top>>1))},t}(),w=function(){function t(t,e,n,r){this.left=t,this.top=e,this.width=n,this.height=r}return t.prototype.clone=function(){return new t(this.left,this.top,this.width,this.height)},t.prototype.toBox=function(){return new v(this.top,this.left+this.width,this.top+this.height,this.left)},t.prototype.centerPoint=function(){return new g(this.left+(this.width>>1),this.top+(this.height>>1))},t.prototype.contains=function(e){return e instanceof t?this.left<=e.left&&this.left+this.width>=e.left+e.width&&this.top<=e.top&&this.top+this.height>=e.top+e.height:e.x>=this.left&&e.x<=this.left+this.width&&e.y>=this.top&&e.y<=this.top+this.height},t}();function y(t,e){return Math.random()*(t-e+1)+e}function b(t){return t*Math.PI/180}function x(t,e,n,r){var o=b(r);return{x:t+n*Math.cos(o),y:e+n*Math.sin(o)}}var _=function(t){for(var e=[0,51,102,153,204,255],n=e.length-1,r=[],o=0;o<t;)r.add("rgba({0},{1},{2},.9)".format(e[~~y(n,0)],e[~~y(n,0)],e[~~y(n,0)])),o++;return{current:-1,values:r,next:function(){return this.current=++this.current%this.values.length,this.values[this.current]}}},S=function(t,e,n){var r=a(e-t,!1),o=a(r/(n-1),!0),i={range:r,min:Math.floor(t/o)*o,max:Math.ceil(e/o)*o,tickSpacing:o,values:Array()};function a(t,e){var n=Math.floor(Math.log10(t)),r=t/Math.pow(10,n);return e?r<1.5?Math.pow(10,n):r<3?2*Math.pow(10,n):r<7?5*Math.pow(10,n):10*Math.pow(10,n):r<=1?Math.pow(10,n):r<=2?2*Math.pow(10,n):r<=5?5*Math.pow(10,n):10*Math.pow(10,n)}for(var s=i.max;s>i.min;s-=i.tickSpacing)i.values.push(s);return i},T=function(){function t(){}return t.line=function(t,e){var n=e.x-t.x,r=e.y-t.y;return{length:Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),angle:Math.atan2(r,n)}},t.controlPoint=function(t,e){return function(n,r,o,i){var a=t(r||n,o||n),s=a.angle+(i?Math.PI:0),d=a.length*e,c=n.x+Math.cos(s)*d,l=n.y+Math.sin(s)*d;return new g(c,l)}},t.bezierCommand=function(t){return function(e,n,r){var o=t(r[n-1],r[n-2],e),i=t(e,r[n-1],r[n+1],!0);return"C {0},{1} {2},{3} {x},{y}".format(o.x,o.y,i.x,i.y,e)}},t.svgPath=function(t,e,n){return t.reduce((function(t,r,o,i){return 0==o?"M {x},{y}".format(r):n&&o==i.length-2||n&&o==i.length-1?t+" L {x},{y}".format(r):t+" "+e(r,o,i)}),"")+(n?" z":"")},t.createPath=function(e,n,r){void 0===r&&(r=!0);var o=t.bezierCommand(t.controlPoint(t.line,n));return t.svgPath(e,o,r)},t}(),E=_(30),C=function(){function t(t,e,n,r){var o=this;this.showBars=!0,this.showDots=!0,this.showLine=!0,this.showValues=!0,this.closeLines=!0,this.worldToScreenY=function(t){return t*o.ratio*o.bounds.height/100},this.getControl=function(){return o.svg},this.fonts=[],this.currentFont={fontFamily:"Verdana",fontSize:"11px",textAnchor:"middle"},this.showBars=!r||null==r.showBars||r.showBars,this.showDots=!r||null==r.showDots||r.showDots,this.showLine=!r||null==r.showLine||r.showLine,this.showValues=!r||null==r.showValues||r.showValues,this.closeLines=!r||null==r.closeLines||r.closeLines,this.width=t,this.height=e,this.padding=r&&r.padding?r.padding:new v(0,0,0,0),this.bounds=new w(this.padding.left,this.padding.top,this.width-this.padding.left-this.padding.right,this.height-this.padding.top-this.padding.bottom);var a='<svg viewbox ="0 0 {width} {height}">  <defs>    <clipPath id="JJJ">      <rect y="{bounds.top}"            x="{bounds.left}"            width="{bounds.width}"            height="{0}" />     </clipPath>  </defs>  <g class="lines"></g>  <g class="data" style="clip-path:url(#JJJ)"></g>  <g class="text"></g></svg>'.format(this.bounds.height-1,this);this.svg=i.build("div",a,!0),this.data=n.map((function(t,e){return{value:t[0],legend:t[1]||"",serie:t[2]||"",fill:t[3]||E.next()}})),this.maxValue=1.05*this.data.reduce((function(t,e){return Math.max(e.value,t)}),-1/0),this.ratio=100/this.maxValue,this.series=Object.entries(this.data.groupBy("serie")).map((function(t){return{key:t[0],text:t[0],fill:t[1][0].fill,rows:t[1]}})).where((function(t){return t.key})),this.legends=Object.entries(this.data.groupBy("legend")).map((function(t){var e=t[1],n=e[0].fill;return o.series.length&&e.forEach((function(t){return t.fill=n})),{key:t[0],text:t[0],fill:n,rows:e}})),this.calcLayout()}return t.prototype.calcLayout=function(){var t=this,e=this.bounds.width/this.data.length,n=.1*e,r=2*n,o=e-n/this.data.length,i=0,a=function(e){e.forEach((function(e,r,a){var s=t.worldToScreenY(e.value),d=t.bounds.top+t.bounds.height-s,c=t.bounds.left+n+i;e.bar=new w(c,d,o-n,s),i+=o}))};this.series.length?(o-=r*this.series.length/this.data.length,this.series.forEach((function(e){e.left=t.bounds.left+i,a(e.rows),i+=r,e.width=t.bounds.left+i-e.left,e.right=t.bounds.left+i-r}))):a(this.data),this.draw()},t.prototype.draw=function(){this.drawAxisY(),this.drawVerticalLines(),this.drawAxisX(),this.drawBars(),this.drawLine(),this.drawSeries()},t.prototype.drawAxisX=function(){var t='<line x1="{0}" y1="{1}" x2="{2}" y2="{1}"      stroke="black"      stroke-width="2" />'.format(this.bounds.left-4,this.bounds.top+this.bounds.height,this.bounds.left+this.bounds.width+4);this.svg.querySelector("g.lines").insertAdjacentHTML("beforeend",t)},t.prototype.drawAxisY=function(){var t=this,e="";this.saveContext(),this.currentFont.textAnchor="end",S(0,this.maxValue,25).values.forEach((function(n){var r=t.worldToScreenY(n),o=t.bounds.top+t.bounds.height-r;o<t.bounds.top||(e+='<line x1="{0}" y1="{1}" x2="{2}" y2="{1}"      stroke="silver"      stroke-width="1"/>'.format(t.bounds.left-4,o,t.bounds.left+t.bounds.width),t.appendText(t.bounds.left-6,o+4,n.toFixed(0)))})),this.restoreContext(),e+='<line x1="{0}" y1="{1}" x2="{0}" y2="{2}"      stroke="black"      stroke-width="2" />'.format(this.bounds.left,this.bounds.top-2,this.bounds.top+this.bounds.height+4),this.svg.querySelector("g.lines").insertAdjacentHTML("beforeend",e)},t.prototype.drawVerticalLines=function(){var t=this,e='<line x1="{0}" y1="{1}" x2="{0}" y2="{2}"      stroke="{3}"      stroke-width="1" />',n=this.data.reduce((function(n,r,o){var i=r.bar.centerPoint();return n+e.format(i.x,t.bounds.top-4,t.bounds.top+t.bounds.height+4,"silver")}),"")+this.series.reduce((function(n,r,o,i){return o==i.length-1?n:n+e.format(r.left+r.width,t.bounds.top-4,t.bounds.top+t.bounds.height,"black")}),"");this.svg.querySelector("g.lines").insertAdjacentHTML("beforeend",n)},t.prototype.drawBars=function(){var t=this,e=this.data.reduce((function(e,n,r){var o=n.bar;if(t.appendText(o.centerPoint().x,t.bounds.top+t.bounds.height+14,n.legend),t.showBars)return t.showValues&&t.appendText(o.centerPoint().x,o.centerPoint().y,n.value),e+'<rect x="{0}" y="{1}" width="{2}" height="{3}"      stroke="black"      stroke-width="2"      fill="{4}"      data-index="{5}" />'.format(o.left,o.top,o.width,o.height,n.fill,r)}),"");this.svg.querySelector("g.data").insertAdjacentHTML("beforeend",e)},t.prototype.drawSeries=function(){var t=this;this.saveContext(),this.currentFont.fontSize="20px",this.currentFont.textAnchor="middle",this.series.forEach((function(e,n){t.appendText(e.left+e.width/2,t.bounds.top+t.bounds.height+40,e.text)})),this.restoreContext()},t.prototype.drawLine=function(){var t=this,e=function(e,n){t.showLine&&t.showValues&&e.forEach((function(e,n){var r=e.bar;t.appendText(r.centerPoint().x,r.top-12,e.value)}));var r=e.map((function(t){return t.bar})).map((function(t){return new g(t.centerPoint().x,t.top)})).concat(t.closeLines?n:[]),o=T.createPath(r,.1,t.closeLines),i='<path d="{0}" fill="{1}"      stroke-dasharray=""      stroke="{2}"      stroke-width="2"/>'.format(o,t.closeLines?E.next():"none","black"),a=e.reduce((function(t,e,n){var r=e.bar;return t+'<circle cx="{0}" cy="{1}" r="3"         stroke="black"        stroke-width="1"         fill="white" />'.format(r.centerPoint().x,r.top,e.fill)}),"");return(t.showLine?i:"")+(t.showDots?a:"")},n="";if(this.series.length)n=this.series.map((function(n){var r=[new g(n.right,t.bounds.top+t.bounds.height),new g(n.left,t.bounds.top+t.bounds.height)];return e(n.rows,r)})).join("");else{var r=[new g(this.bounds.left+this.bounds.width,this.bounds.top+this.bounds.height),new g(this.bounds.left,this.bounds.top+this.bounds.height)];n=e(this.data,r)}this.svg.querySelector("g.data").insertAdjacentHTML("beforeend",n)},t.prototype.saveContext=function(){this.fonts.push(i.clone(this.currentFont))},t.prototype.restoreContext=function(){this.fonts.length&&(this.currentFont=this.fonts.pop())},t.prototype.appendText=function(t,e,n){this.svg.querySelector("g.text").insertAdjacentHTML("beforeend",'<text x="{0}" y="{1}" font-family="{fontFamily}"  font-size="{fontSize}" text-anchor="{textAnchor}">{2}</text>'.format(t,e,n,this.currentFont))},t}();const L=C;var A=_(30),M=function(){function t(t,e,n,r){var o=this;this.getControl=function(){return o.svg},this.worldToScreenX=function(t){return o.bounds.left+t*o.ratio.x*o.bounds.width/100},this.worldToScreenY=function(t){return o.bounds.top+o.bounds.height-(t-o.document.view.y.min)*o.ratio.y*o.bounds.height/100},this.screenToWorldX=function(t){var e=t*(o.width/o.svg.clientWidth);return o.document.view.x.min+100*(e-o.bounds.left)/(o.bounds.width*o.ratio.x)},this.indexPoinAt=function(t){var e=-1;return o.document.distances.forEach((function(n){n>t||e++})),e},this.onMouseLeave=function(t){o.mouse.mouseDown&&(o.mouse.mouseDown=!1,o.mouse.drag=!1,o.clearLayer())},this.onTouchEnd=function(t){var e=function(){o.mouse.mouseDown=!1,o.mouse.drag=!1,o.clearLayer(),t.preventDefault()};if(o.mouse.drag)return d.publish("msg/line_chart/range",{sender:o,start:o.mouse.dragStart<0?0:o.mouse.dragStart,end:o.mouse.dragEnd}),e(),void o.updateLayer();d.publish("msg/line_chart/tap",{sender:o,x:o.screenToWorldX(o.mouse.mouseDownPosition.x)}),e()},this.onMouseUp=function(t){var e={x:t.offsetX,y:t.offsetY},n=function(){o.mouse.mouseDown=!1,o.mouse.drag=!1,o.clearLayer(),t.preventDefault()};return o.mouse.mouseDown&&o.mouse.mouseDownPosition.x==e.x&&o.mouse.mouseDownPosition.y==e.y?(d.publish("msg/line_chart/tap",{sender:o,position:e,x:o.screenToWorldX(e.x)}),n()):o.mouse.drag?(d.publish("msg/line_chart/range",{sender:o,start:o.mouse.dragStart<0?0:o.mouse.dragStart,end:o.mouse.dragEnd}),n(),void o.updateLayer()):void n()},this.onTouchStart=function(t){var e=window.document.createEvent("MouseEvent"),n=t.touches[0];e.initMouseEvent("mousedown",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(e),t.preventDefault()},this.onMouseDown=function(t){o.mouse.mouseDown=!0,o.mouse.mouseDownPosition={x:t.offsetX,y:t.offsetY},o.mouse.dragStart=o.mouse.dragEnd=o.indexPoinAt(o.screenToWorldX(o.mouse.mouseDownPosition.x)),-1==o.mouse.dragStart&&(o.mouse.dragStart=0),t.preventDefault()},this.onTouchMove=function(t){var e=window.document.createEvent("MouseEvent"),n=t.touches[0];e.initMouseEvent("mousemove",!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(e),t.preventDefault()},this.onMouseMove=function(t){var e={x:t.offsetX,y:t.offsetY};o.mouse.drag=o.mouse.mouseDown,o.mouse.drag&&(o.mouse.dragEnd=o.indexPoinAt(o.screenToWorldX(e.x)),-1==o.mouse.dragEnd&&(o.mouse.dragEnd=0),o.updateLayerDrag(e)),t.preventDefault()},this.states=[],this.currentFont={fontFamily:"Verdana",fontSize:"11px",textAnchor:"middle"},this.mouse={},this.width=t,this.height=e,this.padding=r&&r.padding?r.padding:new v(0,0,0,0),this.bounds=new w(this.padding.left,this.padding.top,this.width-this.padding.left-this.padding.right,this.height-this.padding.top-this.padding.bottom);var a='<svg viewbox ="0 0 {width} {height}">  <defs>    <clipPath id="JJJ">      <rect y="0"            x="{bounds.left}"            width="{bounds.width}"            height="{0}" />     </clipPath>  </defs>  <g class="lines"></g>  <g class="data" style="clip-path:url(#JJJ)"></g>  <g class="layer" style="clip-path:url(#JJJ)">    <rect x="0" y="0" width="0" height="{0}" stroke="none"       fill="rgb(0,0,200,.5)" />  </g>  <g class="text"></g></svg>'.format(this.bounds.height+this.bounds.top-1,this);this.svg=i.build("div",a,!0),this.svg.onmousemove=this.onMouseMove,this.svg.onmouseup=this.onMouseUp,this.svg.onmousedown=this.onMouseDown,this.svg.onmouseleave=this.onMouseLeave,this.svg.ontouchstart=this.onTouchStart,this.svg.ontouchend=this.onTouchEnd,this.svg.ontouchmove=this.onTouchMove,this.layer=i.element("g.layer rect",this.svg),this.document=n,this.ratio=new g(100/this.document.view.x.range,100/this.document.view.y.range),this.draw()}return t.prototype.draw=function(){this.drawScaleY(),this.drawScaleX(),this.drawAxes(),this.drawLines()},t.prototype.drawAxes=function(){var t='<line x1="{0}" y1="{1}" x2="{2}" y2="{1}" stroke="black" stroke-width="2" />'.format(this.bounds.left-4,this.bounds.top+this.bounds.height,this.bounds.left+this.bounds.width+4)+'<line x1="{0}" y1="{1}" x2="{0}" y2="{2}" stroke="black" stroke-width="2" />'.format(this.bounds.left,this.bounds.top-2,this.bounds.top+this.bounds.height+4);this.svg.querySelector("g.lines").insertAdjacentHTML("beforeend",t)},t.prototype.drawScaleY=function(){var t=this,e="",n='<line x1="{0}" y1="{1}" x2="{2}" y2="{1}" stroke="silver" stroke-width="1"/>',r=this.bounds.left+this.bounds.width;this.saveContext(),this.currentFont.fontSize="9px",this.currentFont.textAnchor="end";var o=this.document.series[0],i=S(o.view.min,o.view.max,8);i.values.forEach((function(i){var a=o.transform?o.transform(t,i):t.worldToScreenY(i);if(!(a<t.bounds.top)){e+=n.format(t.bounds.left-4,a,r);var s="{0} {1}".format(i.toFixed(0),o.unit||"m");t.appendText(t.bounds.left-6,a+3,s)}})),this.document.series[1]&&(this.currentFont.textAnchor="start",o=this.document.series[1],(i=S(o.view.min,o.view.max,8)).values.forEach((function(i){var a=o.transform?o.transform(t,i):t.worldToScreenY(i);if(!(a<t.bounds.top||a>t.bounds.top+t.bounds.height)){e+=n.format(r-4,a,r);var s="{0} {1}".format(i.toFixed(0),o.unit||"m");t.appendText(r+2,a+3,s)}}))),this.restoreContext(),this.svg.querySelector("g.lines").insertAdjacentHTML("beforeend",e)},t.prototype.drawScaleX=function(){var t=this;this.saveContext();var e=this.worldToScreenX(this.document.view.x.min)-this.bounds.left,n="",r=S(this.document.view.x.min,this.document.view.x.max,Math.floor(this.bounds.width/50));this.currentFont.fontSize="9px",r.values.forEach((function(r){var o=t.worldToScreenX(r)-e;o<t.bounds.left||o>t.bounds.left+t.bounds.width||(n+='<line x1="{0}" y1="{1}" x2="{0}" y2="{2}" stroke="gray" stroke-width="1" />'.format(o,t.bounds.top-4,t.bounds.top+t.bounds.height+4),t.appendText(o,t.bounds.top+t.bounds.height+12,"{0} km".format((r/1e3).toFixed(1))))})),this.svg.querySelector("g.lines").insertAdjacentHTML("beforeend",n),this.restoreContext()},t.prototype.drawLines=function(){var t=this,e=this.worldToScreenX(this.document.view.x.min)-this.bounds.left,n="";this.document.series.forEach((function(r,o){var i=t.document[r.name].map((function(n,o){var i=t.worldToScreenX(t.document.distances[o]),a=r.transform?r.transform(t,n):t.worldToScreenY(n);return new g(i-e,a)})),a=i.reduce((function(t,e,n,r){return t+'<circle cx="{0}" cy="{1}" r="3"         stroke="black"        stroke-width="1"         fill="white" />'.format(e.x,e.y,"white")}),""),s=t.worldToScreenY(r.view.min),d=t.worldToScreenX(t.document.view.x.min)-e,c=t.worldToScreenX(t.document.view.x.max)-e;i=i.concat(r.closeLine?[new g(c,s),new g(d,s)]:[]);var l=T.createPath(i,.1,r.closeLine),u='<path d="{0}" fill="{1}"       stroke-dasharray=""       stroke="{2}"       stroke-width="{3}" />'.format(l,r.closeLine?r.fillStyle||A.next():"none",r.strokeStyle||"black",r.lineWidth||1);n+=u+a})),this.svg.querySelector("g.data").insertAdjacentHTML("beforeend",n)},t.prototype.updateLayerDrag=function(t){var e=this.width/this.svg.clientWidth*Math.min(t.x,this.mouse.mouseDownPosition.x),n=this.width/this.svg.clientWidth*Math.max(t.x,this.mouse.mouseDownPosition.x);this.layer.setAttribute("x",e.toString()),this.layer.setAttribute("width",(n-e).toString())},t.prototype.updateLayer=function(){var t=this.worldToScreenX(this.document.distances[Math.min(this.mouse.dragStart,this.mouse.dragEnd)]),e=this.worldToScreenX(this.document.distances[Math.max(this.mouse.dragStart,this.mouse.dragEnd)]);this.layer.setAttribute("x",t.toString()),this.layer.setAttribute("width",(e-t).toString())},t.prototype.clearLayer=function(){this.layer.setAttribute("width","0")},t.prototype.saveContext=function(){this.states.push(i.clone(this.currentFont))},t.prototype.restoreContext=function(){this.states.length&&(this.currentFont=this.states.pop())},t.prototype.appendText=function(t,e,n){this.svg.querySelector("g.text").insertAdjacentHTML("beforeend",'<text x="{0}" y="{1}" font-family="{fontFamily}"  font-size="{fontSize}" text-anchor="{textAnchor}">{2}</text>'.format(t,e,n,this.currentFont))},t}();const I=M;var k=_(30),P=function(){function t(){}return t.prototype.run=function(){var t=60,e=[[~~y(t,10),"Ovino","Toledo",""],[~~y(t,10),"Caprino","Toledo",""],[~~y(t,10),"Bovino","Toledo"],[~~y(t,10),"Otros","Toledo"],[~~y(t,10),"Ovino","Madrid"],[~~y(t,10),"Caprino","Madrid"],[~~y(t,10),"Bovino","Madrid"],[~~y(t,10),"Ovino","Sevilla"],[~~y(t,10),"Caprino","Sevilla"],[~~y(t,10),"Bovino","Sevilla"],[~~y(t,10),"Ovino","Ávila"],[~~y(t,10),"Caprino","Ávila"],[~~y(t,10),"Bovino","Ávila"]],n=[[~~y(t,40),"lunes 4","","red"],[~~y(t,4),"martes 5",""],[~~y(t,4),"miércoles 6",""],[~~y(t,4),"jueves 7",""],[~~y(t,4),"viernes 8",""],[~~y(t,4),"lunes 11",""],[~~y(t,4),"martes 12",""],[~~y(t,4),"miércoles 13",""],[~~y(t,4),"lunes 18",""],[~~y(t,4),"lunes 25",""]],r=[[~~y(t,4),"00:00"],[~~y(t,4),"01:00"],[~~y(t,4),"02:00"],[~~y(t,4),"03:00"],[~~y(t,4),"04:00"],[~~y(t,4),"05:00"],[~~y(t,4),"06:00"],[~~y(t,4),"07:00"],[~~y(t,4),"08:00"],[~~y(t,4),"09:00"],[~~y(t,4),"10:00"],[~~y(t,4),"11:00"],[~~y(t,4),"12:00"]];d.publish("msg/main-page/test/content","<p>Control de gráficos de barras (svg)</p>"+new L(650,230,e,{padding:new v(20,20,40,40),showBars:!0,showDots:!1,showLine:!1,showValues:!0}).getControl().outerHTML+new L(650,230,e,{padding:new v(20,20,40,40),showBars:!1,showDots:!0,showLine:!0,showValues:!0,closeLines:!0}).getControl().outerHTML+new L(650,230,n,{padding:new v(20,20,40,40),showBars:!1,showDots:!0,showLine:!0,showValues:!0}).getControl().outerHTML+new L(650,230,r,{padding:new v(20,20,40,40),showBars:!1,showDots:!0,showLine:!0,showValues:!0,closeLines:!1}).getControl().outerHTML+new L(650,230,r,{padding:new v(20,20,40,40),showBars:!1,showDots:!1,showLine:!0,showValues:!1,closeLines:!1}).getControl().outerHTML),setTimeout((function(){i.element("svg g.data").onclick=function(t){console.log(t.target.dataset.index)}}),1e3)},t}(),H=function(){function t(){}return t.prototype.run=function(){this.loadData()},t.prototype.loadData=function(){var t=this;u.get("js/data/libros.json").then((function(e){t._books=JSON.parse(e).sortBy("publisher_date,language,publisher,ID"),t.createBarChart()}))},t.prototype.createBarChart=function(){var t=m.createTree(this._books,["publisher_date"]),e=i.build("div",{className:"w3-margin-bottom w3-border",innerHTML:'<svg width="500"     height="200">  <g transform="translate(0,200) scale(1,-1)">    <rect xfor="value in values"          xbind="id:fn.calc=>all"           style="transition: height .51s ease-out;fill:rgb(0,0,255);stroke-width:2;stroke:rgb(0,0,0)" >    </rect>  </g></svg>'}),n={values:Object.keys(t).map((function(e){return t[e].rows.length})),fn:{calc:function(t,e){var r=500/n.values.length,o=.1*r;return e.setAttribute("x",""+(o+this.index*r)),e.setAttribute("width",(r-o).toString()),e.setAttribute("height","0"),"bar-{0}".format(this.index)}}};setTimeout((function(){var t=100/Math.max.apply(null,n.values);i.elements("rect").forEach((function(e,r){e.setAttribute("height","{0}%".format(n.values[r]*t))}))}),200),d.publish("msg/main-page/test/content","<p>Generación de gráficos de barras (svg + executeTemplate)</p>"+f(e,[n]))},t}(),O=function(){function t(){}return t.prototype.run=function(){this.loadData()},t.prototype.loadData=function(){this.createPieChart()},t.prototype.createPieChart=function(){var t,e,n,r=i.build("div",{className:"w3-margin-bottom w3-border w3-center",innerHTML:'<svg viewbox ="-200 -200 400 400">  <circle cx="0" cy="0" r="149" stroke="black" stroke-width="1" fill="antiquewhite" />  <g xfor="value in values">    <path stroke-width="1"           stroke="gray"           fill="silver"           xbind="id:fn.calc=>@value" >    </path>    <text text-anchor="middle" font-size="12px"           stroke-width="0"           stroke="white"           fill="black"           xbind="id:fn.calcLine=>@value">{value.text}</text>  </g></svg>',style:{width:"50%"}}),o={values:(t=[~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50)),~~y(345,~~y(100,50))].slice(0,~~y(9,2)),e=t.reduce((function(t,e){return t+e})),n=0,t.sort((function(t,e){return e-t})).map((function(t,r,o){var i=100*t/e,a={index:r,value:t,percent:i,text:"{0}%".format(i.toFixed(1)),offset:n,arc_start:3.6*n,arc_center:3.6*(n+i/2),arc_end:3.6*(n+i),angle:b(3.6*(n+i/2)-90),direction:new g(0,0)};return a.direction=new g(Math.cos(a.angle),Math.sin(a.angle)),n+=i,a}))),fn:{calc:function(t,e){var n,r,o,i,a,s,d,c,l=t.direction.clone().mul(4);return e.setAttribute("d",(n=0,r=0,o=150,i=t.arc_start,s=x(n,r,o,(a=t.arc_end)-90),d=x(n,r,o,i-90),c=a-i<=180?"0":"1",["M",s.x,s.y,"A",o,o,0,c,0,d.x,d.y,"L",n,r,"L",s.x,s.y].join(" "))),e.setAttribute("transform","translate({x},{y})".format(l)),e.setAttribute("fill",k.next()),"sector-{0}".format(t.index)},calcLine:function(t,e){var n=t.direction.clone().mul(160.5);return e.setAttribute("x",n.x.toString()),e.setAttribute("y",n.y.toString()),e.setAttribute("transform","rotate({0},{x},{y})".format(t.arc_center,n)),"text-{0}".format(t.index)}}};d.publish("msg/main-page/test/content","<p>Generación de gráficos de tarta (svg + executeTemplate)</p>"+f(r,[o]))},t}(),j=function(){function t(){}return t.prototype.run=function(){var t=function(t){function e(t,e,n){for(var r={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,range:void 0},o=e;o<=n;)r.min=Math.min(r.min,t[o]),r.max=Math.max(r.max,t[o]),o++;return r.min=r.min,r.range=r.max-r.min,r}var n={series:[],length:t.streams.distance.data.length,distances:t.streams.distance.data,altitude:t.streams.altitude.data,s2:t.streams.s2.data,offset:0,view:{},getRange:e,configureView:function(t,r){return n.view.start=t,n.view.end=r,n.view.x={},n.view.x.max=1.005*n.distances[r],n.view.x.min=n.distances[t],n.view.x.range=n.view.x.max-n.view.x.min,n.view.y=e(n.altitude,t,r),n.view.h=e(n.s2,t,r),n.series=[],n.series.push({name:"altitude",closeLine:!0,showDots:!0,unit:"m",view:n.view.y,fillStyle:"rgba(225,125,125,.8)",lineWidth:1,strokeStyle:"rgba(0,0,0,.8)",ratio:100/n.view.y.range}),n.series.push({name:"s2",closeLine:!1,showDots:!1,unit:"ppm",view:n.view.h,fillStyle:"rgba(150,0,0,.8)",lineWidth:3,strokeStyle:"rgba(00,0,250,.9)",ratio:100/n.view.h.range,transform:function(t,e){return t.bounds.top+t.bounds.height-(e-t.document.view.h.min)*this.ratio*t.bounds.height/120}}),n},resetView:function(){return n.configureView(0,n.length-1)}};return n.resetView()}({streams:{distance:{data:[0,100,200,300,500,800,900,950,1e3]},altitude:{data:[150,50,26,155,60,45,40,80,0]},s2:{data:[150,50,200,185,160,145,120,80,0]}}});d.publish("msg/main-page/test/content",'<p>Control de gráficos de lineas (svg)</p><div class="jjj-5"></div>'),setTimeout((function(){var e=new I(650,300,t,{padding:new v(20,40,40,40)}).getControl();i.element(".jjj-5").appendChild(e),d.subscribe("msg/line_chart/range",(function(t,e){})),d.subscribe("msg/line_chart/tap",(function(t,e){}))}),100)},t}(),N=n(100),D=n.n(N),B=[];function V(t){return new Promise((function(e){if(B.indexOf(t.toLowerCase())>-1)e(null);else{var n=document.createElement("script");n.type="text/javascript",n.onload=function(){B.push(t.toLowerCase()),e((function(){document.getElementsByTagName("head")[0].removeChild(n),B.remove(t.toLowerCase())}))},n.src=t,document.getElementsByTagName("head")[0].appendChild(n)}}))}var R,F,q=function(){function t(){var t,e;this._config=i.config(r.APP_CONFIG_NAME),this._document={name:"Valor inicial"},this._commandManager=(t=this._document,e={getDocument:function(){return t},undos:new Array,redos:new Array,clear:function(){e.undos.length=0,e.redos.length=0},executeCommad:function(n){try{e.undos.push(n.execute(t)),e.redos.length=0}catch(t){console.error(t)}},undo:function(){e.undos.length>0&&e.redos.push(e.undos.pop().undo(t))},redo:function(){e.redos.length>0&&e.undos.push(e.redos.pop().execute(t))}}),this._config.write("CommandsView",Date.now.toString())}return t.prototype.render=function(t){var e=this;this._content=i.build("div",{innerHTML:D()},!0),t.innerHTML="",t.appendChild(this._content),l(t,{doCommand:function(){e._document.name="Valor inicial";var t,n=e._content.querySelector("[message-container]");n.innerHTML=e._document.name+"<br/>",e._commandManager.executeCommad(t={bak:"",execute:function(e){return this.bak=e.name,e.name=e.name.toUpperCase(),t},undo:function(e){return e.name=this.bak,t}}),n.innerHTML+=e._document.name+"<br/>",e._commandManager.undo(),n.innerHTML+=e._document.name+"<br/>",e._commandManager.redo(),n.innerHTML+=e._document.name+"<br/>"}},{}),V("./js/w3codecolor.js").then((function(){return e.__colorize()}))},t.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(t){return{e:t,mode:t.classList.contains("jsHigh")?"js":"html"}})).forEach((function(t){return t.e.innerHTML=w3CodeColorize(t.e.innerHTML,t.mode)}))},t}(),G=0,z=function(){function t(t){this._name=t,this._subscribers=new Map}return t.prototype.dispatch=function(t){var e=this;return this._subscribers.forEach((function(n){return n(e._name,t)})),this},t.prototype.add=function(t){return this._subscribers.set(++G,t),G},t.prototype.remove=function(t){return this._subscribers.delete(t)},t}(),W=0,U=function(){function t(t,e,n,r){void 0===t&&(t="t�tulo"),void 0===n&&(n=function(t){}),void 0===r&&(r="10em");var o=this;this.loaded=!1,this.collapsed=!0,this.onexpand=new z("CollapsibleBox.onexpand"),this._onExpand=function(t){},this._control=i.build("div",{innerHTML:'<div id="collapsible-box-{0}" class="w3-border">  <button class="w3-block w3-border-0" style="outline-style:none">{1}<i style="margin: 2px;" class="fa fa-chevron-down w3-right"></i></button>  <div class="w3-hide w3-border-top" style="overflow:auto"></div></div>'.format(++W,t)},!0),this._header=this._control.querySelector("button"),this._body=this._control.querySelector("div"),this._header.onclick=function(t){o.collapsed?o.expand():o.collapse()},"-"!=r&&(this._body.style.height=r),e&&this.setContent(e),this._onExpand=n}return t.create=function(e,n){return void 0===e&&(e="t�tulo"),void 0===n&&(n="10em"),new t(e,"",void 0,n)},t.prototype.hide=function(){return this.collapse(),this._header.classList.add("w3-hide"),this},t.prototype.show=function(){return this._header.classList.remove("w3-hide"),this},t.prototype.appendTo=function(t){return t.appendChild(this._control),this},t.prototype.collapse=function(){this._body.classList.add("w3-hide");var t=this._header.querySelector("i");return t.classList.remove("fa-chevron-up"),t.classList.add("fa-chevron-down"),this.collapsed=!0,this},t.prototype.expand=function(){this._body.classList.remove("w3-hide");var t=this._header.querySelector("i");return t.classList.remove("fa-chevron-down"),t.classList.add("fa-chevron-up"),this._onExpand&&this._onExpand(this),this.onexpand.dispatch(this),this.collapsed=!1,this},t.prototype.getControl=function(){return this._control},t.prototype.getBody=function(){return this._body},t.prototype.setContent=function(t){return i.isString(t)?this._body.innerHTML=t:(this._body.innerHTML="",this._body.appendChild(t)),this},t}(),J=function(){function t(e,n,r){var o=this;this.currentIndex=-1,this.previous=void 0,this.table=e;var i=function(e){var r=e.target,i=r.parentNode,a=i.parentNode;o.previous=r.textContent.trim(),o.currentIndex=a.rowIndex;var s={tr:a,td:i,target:r,current:o.previous};d.publish(t.OnfocusMessage,s),n&&n(o,s)},a=function(e){var n=e.target,i=n.parentNode,a=i.parentNode;if(null!=o.previous&&o.previous!=i.textContent.trim()){var s={tr:a,td:i,target:n,previous:o.previous,current:n.textContent.trim()};d.publish(t.OnChangeMessage,s),r&&r(o,s),o.previous=void 0}n.style.outline="1px solid transparent"};e.querySelectorAll("td div[contenteditable]").toArray().forEach((function(t){t.onblur=a,t.onfocus=i})),e.onkeypress=function(t){if(13==t.keyCode)return t.preventDefault&&t.preventDefault(),!1},e.onkeydown=function(t){var n=!0,r=t.target;if("DIV"==r.tagName&&[13,37,38,39,40].indexOf(t.keyCode)>-1){var o=r.parentNode,i=o.parentNode,a=window.getSelection().getRangeAt(0).startOffset,s=function(e,r,o){t.preventDefault();try{e.rows[r].cells[o].firstElementChild.focus()}catch(t){}n=!1};13==t.keyCode&&s(e,i.rowIndex,o.cellIndex+1),38==t.keyCode&&i.rowIndex>1&&s(e,i.rowIndex-1,o.cellIndex),40==t.keyCode&&i.rowIndex<e.rows.length-1&&s(e,i.rowIndex+1,o.cellIndex),39==t.keyCode&&a==r.textContent.length&&s(e,i.rowIndex,o.cellIndex+1),37==t.keyCode&&0==a&&s(e,i.rowIndex,o.cellIndex-1)}return n}}return t.OnfocusMessage="editable-grid/focus",t.OnChangeMessage="editable-grid/change",t}(),X=n(101),$=n.n(X),Y="data:text/css;base64,"+window.btoa($()),Z=0,Q=!1,K=function(){function t(){var t=this;this.id="svc_{0}".format(++Z),Q||(document.querySelector("head").appendChild(i.build("link",{rel:"stylesheet",type:"text/css",href:Y})),Q=!0),this._control=i.build("div",{className:"svc_viewer",id:this.id,innerHTML:'<div class="scv_Main">  <pre class="scv_LineContainer" id="svc_{0}_line"></pre>  <pre class="scv_TextContainer" id="svc_{0}_code"></pre></div>'.format(Z)}),this._control.querySelector(".scv_Main").onscroll=function(e){var n=e.target;t._control.querySelector(".scv_LineContainer").style.left="{0}px".format(n.scrollLeft)},this.onclick=new z("txt-viewer.onclick")}return t.prototype.setContent=function(t){var e=this;this._control.querySelector(".scv_LineContainer").innerHTML=t.replace(/(\r\n|\r|\n)/gm,"\n").split("\n").reduce((function(t,e,n){return t+(n+1+"<br/>")}),"");var n=this._control.querySelector(".scv_TextContainer");return n.textContent=t,n.onclick=function(t){return e.onclick.dispatch(t)},this},t.prototype.getControl=function(){return this._control},t}(),tt=n(549),et=n.n(tt),nt=function(){function t(){this._config=i.config(r.APP_CONFIG_NAME),this._data=[{id:1,descripcion:"Descripción 1"},{id:2,descripcion:"Descripción 2"},{id:3,descripcion:"Descripción 3"}],this._config.write("ContentEditableView",Date.now.toString()),this._textViewer=new K}return t.prototype.render=function(t){var e=this;this._content=i.build("div",{innerHTML:et()},!0),t.innerHTML="",t.appendChild(this._content),h(t,{data:this._data}),l(t,{writeLog:function(t,e,n){if(n&&"append"==n)return t.innerHTML+=e+"<br/>";t.innerHTML=e},doSave:function(){var n=t.querySelectorAll("td div[data-index]").toArray().map((function(t){return t.textContent})).split(2).map((function(t,n){return{source:e._data[n],edit:{id:t[0],descripcion:t[1]}}}));d.publish("msg/log",JSON.stringify(n,null,2))}},{});var n=t.querySelector("table");this._editableGrid=new J(n,(function(t,e){e.target.style.outline="1px solid gray",d.publish("msg/log","onfocus -> [{target.dataset.index}, {td.cellIndex}] id: {tr.id}".format(e))}),(function(t,e){d.publish("msg/log","onChange -> [{target.dataset.index}, {td.cellIndex}] id: {tr.id} [ {previous} -> {current}]".format(e))})),t.querySelector("[text-viewer]").appendChild(this._textViewer.getControl()),u.get("./js/pro-0001.txt").then((function(t){e._textViewer.setContent(t),e._textViewer.onclick.add((function(t,e){console.log(t,e)}))}));var r=new U("Mensajes").appendTo(this._content).setContent(this._content.querySelector("[log]"));r.onexpand.add((function(t,e){})),r.getControl().classList.add("w3-margin"),setTimeout((function(){return r.expand()}),5e3)},t}(),rt=n(345),ot=n.n(rt),it=function(){function t(){this._config=i.config(r.APP_CONFIG_NAME),this._config.write("PubSubView",Date.now.toString())}return t.prototype.render=function(t){var e=this;this._content=i.build("div",{innerHTML:ot()},!0),t.innerHTML="",t.appendChild(this._content),l(t,{doPublish:function(){d.publish(d.TOPICS.NOTIFICATION,"Botón doPublish"),setTimeout((function(){d.publish(d.TOPICS.NOTIFICATION,"")}),2e3)}},{}),V("./js/w3codecolor.js").then((function(){return e.__colorize()}))},t.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(t){return{e:t,mode:t.classList.contains("jsHigh")?"js":"html"}})).forEach((function(t){return t.e.innerHTML=w3CodeColorize(t.e.innerHTML,t.mode)}))},t}(),at=function(){function t(){this.BS={}}return t.prototype.generateReport=function(t,e,n){var r=this;n.clear&&n.clear(),n.message({type:"report.begin"});var o=t,a=o.parseData?o.parseData(o,e,n.message):e;n.message({type:"report.log.message",text:"Inicializando..."});var s=function(t,e){e.BS=r.BS,n.send(t.format(e))};function d(){m.forEach((function(t,e){if(!(e<l))return n.message({type:"report.sections.group.header",value:t.id}),t.definition.header?s(t.definition.header,t):t.definition.headerValueProvider?n.send(t.definition.headerValueProvider(t)):void 0}))}function c(t){var e=m.map((function(t){return t}));t&&e.splice(0,t),e.reverse().forEach((function(t){return n.message({type:"report.sections.group.footer",value:t.id}),t.definition.footer?s(t.definition.footer,t):t.definition.footerValueProvider?n.send(t.definition.footerValueProvider(t)):void 0}))}var l=-1,u=function(){var t=JSON.parse(o.summary||"{}");return o.onInitSummaryObject?o.onInitSummaryObject(t):t}(),p=(o.sections||[]).where({type:"header"}),h=(o.sections||[]).where({type:"total"}),f=((o.sections||[]).where({type:"footer"}),o.details||[]),m=o.groups.map((function(t,e){return{name:"G"+(e+1),id:t.id,rd:o,definition:t,current:"",data:i.clone(u),init:function(t){var e=t[this.definition.key].toString(),n=r.BS[this.name];n.all[e]=n.all[e]||[],n.all[e].push(t),n.recordCount=1,!1!==this.__resume&&(this.__resume||(this.__resume=Object.keys(this.data).length>0))&&r.copy(t,this.data)},sum:function(t){var e=t[this.definition.key].toString(),n=r.BS[this.name];n.all[e]=n.all[e]||[],n.all[e].push(t),n.recordCount+=1,!1!==this.__resume&&r.sum(t,this.data)},test:function(t){return t[this.definition.key]==this.current}}}))||[];r.BS={reportDefinition:o,mediator:n},o.iteratefn&&(n.message({type:"report.log.message",text:"Inicializando elementos..."}),a.forEach(o.iteratefn)),o.orderBy&&(n.message({type:"report.log.message",text:"Ordenando datos..."}),a.sortBy(o.orderBy,!1)),r.BS={recordCount:0,G0:i.clone(u),dataSet:a,reportDefinition:o,mediator:n},m.forEach((function(t,e){t.current=a&&a[0]?a[0][t.definition.key]:"",r.BS[t.name]={recordCount:0,all:{}}})),o.onStartfn&&o.onStartfn(r.BS),[o.sections,o.details,o.groups].reduce((function(t,e){return t.concat(e)}),[]).map((function(t){t.valueProviderfn&&(t.valueProvider=i.getValue(t.valueProviderfn,{BS:r.BS}),delete t.valueProviderfn),t.footerValueProviderfn&&(t.footerValueProvider=i.getValue(t.footerValueProviderfn,{BS:r.BS}),delete t.footerValueProviderfn),t.headerValueProviderfn&&(t.headerValueProvider=i.getValue(t.headerValueProviderfn,{BS:r.BS}),delete t.headerValueProviderfn)})),n.message({type:"report.render.rows"}),n.message({type:"report.log.message",text:"Generando informe..."}),p.forEach((function(t){return n.message({type:"report.sections.header",value:t}),t.template?s(t.template,t):t.valueProvider?n.send(t.valueProvider(t)):void 0})),a.length>0&&d(),a.forEach((function(t,e){if(r.BS.recordCount++,r.BS.isLastRow=a.length===r.BS.recordCount,r.BS.isLastRowInGroup=r.BS.isLastRow,r.BS.percent=r.BS.recordCount/a.length*100,r.BS.previous=r.BS.data||t,r.BS.data=t,m.forEach((function(t,e){r.BS[t.name].data=Object.create(t.data)})),r.sum(t,r.BS.G0),o.onRowfn&&o.onRowfn(r.BS),n.message({type:"report.render.row",text:r.BS.percent.toFixed(1)+" %",value:r.BS.percent}),m.every((function(e){return e.test(t)}))?m.forEach((function(e){e.sum(t)})):(m.some((function(e,n){return!e.test(t)&&(c(l=n),m.forEach((function(e,r){r>=l?(e.init(t),l=n):e.sum(t)})),!0)})),m.forEach((function(e){e.current=t[e.definition.key]})),o.onGroupChangefn&&o.onGroupChangefn(r.BS),n.message({type:"report.sections.group.change",value:m}),d()),m.length&&!r.BS.isLastRow){var i=a[r.BS.recordCount];r.BS.isLastRowInGroup=!m.every((function(t){var e=t.definition.key;return i[e]===r.BS.data[e]}))}f.forEach((function(t){return n.message({type:"report.sections.detail",value:t.id}),t.template?s(t.template,t):t.valueProvider?n.send(t.valueProvider(t)):void 0}))})),a.length>0&&(r.BS.previous=r.BS.data,c()),h.forEach((function(t){return n.message({type:"report.sections.total",value:t.id}),t.template?s(t.template,t):t.valueProvider?n.send(t.valueProvider(t)):void 0})),n.message({type:"report.render.end"}),n.message({type:"report.end"}),n.flush&&n.flush()},t.prototype.merge=function(t,e){return t.replace(/{([^{]+)?}/g,(function(t,n){if(n.indexOf(":")>0){var r=n.split(":");return r[0]=i.getValue(r[0],e),r[1]=i.getValue(r[1],e),r[0](r[1],e)}var o=i.getValue(n,e);return"function"==typeof o?o(e):o}))},t.prototype.copy=function(t,e){Object.keys(e).map((function(n){e[n]=t[n]}))},t.prototype.sum=function(t,e){Object.keys(e).map((function(n){e[n]+=t[n]}))},t.prototype.compute=function(t,e){return t.reduce((function(t,n){return t+n[e]}),0)},t.prototype.group=function(t,e){var n=t,r=function(t,o){return n.distinct((function(e){return e[t]})).forEach((function(r){e[r]=n.reduce((function(e,n,i,a){return n[t]==r?e+n[o]:e}),0)})),r};return r},t}(),st={load:function(t){var e={sections:[],groups:[],details:[]},n={},r="",o="",i=!1;function a(t){return t&&t.trim().startsWith("@")?e[t.trim().split("@")[1].trim()]||"":t?t.trim():""}function s(t){for(var e=/([a-zA-Z0-9_\-]*)\s*:\s*('[^']*'|[^\s]*)/g,n={},r=e.exec(t);null!=r;)n[r[1].trim()]=a(r[2].trim().replace(/^'([^']*)'$/g,"$1")),r=e.exec(t);return n}return t.split("\n").forEach((function(t){!function(t,e){if(!r&&!t.trim())return function(){};var a;if(!/DEFINE|#|CREATE|SET|FUNCTION|END/.test(t)){if(r)return o+=e,o+="\n",function(){};throw new Error("Tabbly : Unrecognized text")}if(/^#/.test(t))return function(){};if(/^SET (\w.*)/.test(t)){var d=t.match(/^SET (\w.*)$/);return i=!0,r=d[1].trim(),o="",function(){}}if(/^FUNCTION (\w.*)/.test(t))return d=t.match(/^FUNCTION (\w.*)$/),i=!1,r=d[1].trim(),o="",function(){};if(/^END/.test(t)){var c=o,l=r;return r=o="",i?(i=!1,function(t){n[l]=c.trim()}):function(t){t[l]=new Function("ctx",c)}}if(/^DEFINE\s\s*(\w.*)\s*=\s*(.*)$/.test(t))return d=t.match(/^DEFINE\s\s*([a-zA-Z0-9_\-]*)\s*=\s*(.*)$/),a=d,function(t){t[a[1].trim()]=a[2].trim()};if(!/^CREATE\s\s*(\w*) (.*)$/.test(t))throw new Error("Tabbly : Unrecognized text after DEFINE");return"section"==(d=t.match(/^CREATE\s\s*(\w*) (.*)$/))[1]?function(){var t=d;return function(e){e.sections.push(s(t[2])),n=e.sections[e.sections.length-1]}}():"group"==d[1]?function(){var t=d;return function(e){e.groups.push(s(t[2])),n=e.groups[e.groups.length-1]}}():"detail"==d[1]?function(){var t=d;return function(e){e.details.push(s(t[2])),n=e.details[e.details.length-1]}}():void 0}(t.trim(),t)(e)})),e}},dt=n(445),ct=n.n(dt),lt=function(){function t(){this._config=i.config(r.APP_CONFIG_NAME),this._config.write("TabblyReportsJsView",Date.now.toString()),this._content=i.build("div",{innerHTML:ct()},!0)}return t.prototype.render=function(t){var e=this;t.innerHTML="",t.appendChild(this._content),l(t,{localInnerText:function(t,e){t.innerText=e,t.innerHTML=w3CodeColorize(t.innerHTML,"js")}},{}),this.__loadReport(this._content.querySelector("[report-container]")),V("./js/w3codecolor.js").then((function(){return e.__colorize()}))},t.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(t){return{e:t,mode:t.classList.contains("jsHigh")?"js":"html"}})).forEach((function(t){return t.e.innerHTML=w3CodeColorize(t.e.innerHTML,t.mode)}))},t.prototype.__loadReport=function(t){var e={buffer:"",send:function(t){this.buffer+=t},message:function(t){},flush:function(){},clear:function(){this.buffer=""}};V("./js/pro-0001.js").then((function(n){var r=__reportDefinition(st,i);u.get("./js/data/proveedores.json").then((function(o){e.clear(),(new at).generateReport(r,JSON.parse(o),e),t.appendChild(i.build("div",{innerHTML:e.buffer})),l(t,{},r.getContext()),n(),d.publish("msg/rpt/data",JSON.stringify(JSON.parse(o),null,2))}))})),u.get("./js/pro-0001.js").then((function(t){d.publish("msg/rpt/definition",t)}))},t}(),ut=n(794),pt=n.n(ut),ht=function(){function t(){this._config=i.config(r.APP_CONFIG_NAME),this._config.write("TabblyReportsV2View",Date.now.toString()),this._content=i.build("div",{innerHTML:pt()},!0)}return t.prototype.render=function(t){var e=this;t.innerHTML="",t.appendChild(this._content),l(t,{localInnerText:function(t,e){t.innerText=e,t.innerHTML=w3CodeColorize(t.innerHTML,"js")}},{}),this.__loadReport(this._content.querySelector("[report-container]")),V("./js/w3codecolor.js").then((function(){return e.__colorize()}))},t.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(t){return{e:t,mode:t.classList.contains("jsHigh")?"js":"html"}})).forEach((function(t){return t.e.innerHTML=w3CodeColorize(t.e.innerHTML,t.mode)}))},t.prototype.__loadReport=function(t){var e={buffer:"",send:function(t){this.buffer+=t},message:function(t){},flush:function(){},clear:function(){this.buffer=""}};u.get("./js/pro-0001-v2.txt").then((function(n){var r=st.load(n);d.publish("msg/rpt/definition",n),u.get("./js/data/proveedores.json").then((function(n){(new at).generateReport(r,JSON.parse(n),e),t.appendChild(i.build("div",{innerHTML:e.buffer})),l(t,{},r.getContext()),d.publish("msg/rpt/data",JSON.stringify(JSON.parse(n),null,2))}))}))},t}(),ft=function(){function t(){this.BS={},this.module_ReportEngine_Copy=function(t,e){for(var n in e)if(e.hasOwnProperty(n)){if(t.hasOwnProperty(n)){e[n]=t[n];continue}if("_max_"===n||"_mim_"===n){var r=e[n];for(var o in r)r.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(r[o]=t[o])}if("_values_"===n){var i=e[n];for(var o in i)i.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(i[o]=[t[o]])}}},this.module_ReportEngine_Sum=function(t,e){for(var n in e)if(e.hasOwnProperty(n)){if(t.hasOwnProperty(n)){e[n]+=t[n];continue}if("_max_"===n||"_min_"===n){var r=e[n];for(var o in r)r.hasOwnProperty(o)&&t.hasOwnProperty(o)&&(r[o]="_max_"==n?t[o]>r[o]?t[o]:r[o]:t[o]<r[o]?t[o]:r[o])}if("_values_"===n){var i=e[n];for(var o in i)i.hasOwnProperty(o)&&t.hasOwnProperty(o)&&i[o].add(t[o])}}}}return t.prototype.__cloneRowTemplate=function(t){var e=t.cloneNode(!0);return t.parentNode.parentNode.deleteRow(t.rowIndex),e},t.prototype.__fillTemplate=function(t,e){var n=t.querySelectorAll("[xbind]").toArray();return t.attributes.getNamedItem("xbind")&&n.push(t),n.forEach((function(t){i.toArray(t.attributes).where({value:/{[^{]+?}/g}).map((function(t){return t.value=p(t.value,e)})),i.toArray(t.childNodes).where({nodeType:3}).where({textContent:/{[^{]+?}/g}).forEach((function(t){return t.textContent=p(t.textContent,e,t)})),String.trimValues(t.attributes.getNamedItem("xbind").value.split(";")).forEach((function(n){if(""!==n){var r=String.trimValues(n.split(":")),o=String.trimValues(r[1].split(/\s|\,/)),a=i.getValue(o[0],e);if(i.isFunction(a)){var s=o.slice(1).reduce((function(t,n){return t.push("@"==n.charAt(0)?i.getValue(n.slice(1),e):n),t}),[e,t]);a=a.apply(e,s)}else o[1]&&(a=i.getValue(o[1],e)(a,o[2],e,t));t[r[0]]=a}}))})),t},t.prototype.__mergeTemplate=function(t,e,n,r){var o=this;if(t.forEach)return t.forEach((function(t,i){o.__mergeTemplate(t,e,n[i],r)}));this.__fillTemplate(t,{BS:this.BS}),n.tag||"nofooter"==n.tag||(e.append(t.outerHTML.replace(/xbind="[^"]*"/g,"")),r&&r({sb:e,section:n}))},t.prototype.module_ReportEngine_processAll=function(t){var e=this,n=document.createDocumentFragment();if(n.appendChild(i.build("div",{innerHTML:t.ReportTemplate},!1)),t.DetailTemplate=this.__cloneRowTemplate(n.querySelector(t.DetailTemplateSelector)),t.HideTotal){var r=n.querySelector(t.TotalTemplateSelector);r.parentNode.removeChild(r)}else t.TotalTemplate=this.__cloneRowTemplate(n.querySelector(t.TotalTemplateSelector));t.GroupsTemplates=[],t.GroupsTemplates=t.Grupos.map((function(t){return e.__cloneRowTemplate(n.querySelector(t.selector))}));var o=this,a=-1;function s(){t.Grupos.forEach((function(e,n){if(!(n<a)){var r=t.Grupos[n];if(r.header){var s=i.getValue(r.header,o)(r.current,r.name);"hidden;"!=s&&(s.text?d.append("<tr {0}>{1}</tr>".format(s.attributes,s.text)):s.row?o.BS.reportDefinition.dom_tbody.appendChild(s.row):d.append('<tr class="group-header">{0}</tr>'.format(s))),t.RepeatHeadersAfter==n&&t.RepeatHeaders.forEach((function(e){""!=e&&d.append(t.Headers[e].html)}))}}}))}var d=i.createStringBuilder("");if(t.OnStart(t.DataSet),t.DataSet.forEach((function(n,r){0==r&&s(),t.OnRow(n),t.Grupos.every((function(t){return t.test(n)}))?t.Grupos.forEach((function(t){t.sum(n)})):(t.Grupos.some((function(r,o){if(!r.test(n)){a=o;var i=t.GroupsTemplates.map((function(t){return t}));i.splice(0,o),i.reverse();var s=t.Grupos.map((function(t){return t}));return s.splice(0,o),s.reverse(),e.__mergeTemplate(i,d,s,t.OnGroupFooter),t.Grupos.forEach((function(t,e){e>=o?(t.init(n),a=o):t.sum(n)})),!0}return!1})),t.OnRowEnd(n),s()),t.HideDetail||e.__mergeTemplate(t.DetailTemplate,d,{name:"detail"},t.g)})),t.DataSet.length>0){this.BS.previous=this.BS.data;var c=t.GroupsTemplates.map((function(t){return t}));c.reverse(),t.HideTotal||c.push(t.TotalTemplate);var l=t.Grupos.map((function(t){return t}));l.reverse(),l.push({name:"summary"}),this.__mergeTemplate(c,d,l,t.OnGroupFooter)}return n.querySelector(t.ReportTableSelector).innerHTML.replace("<tbody>","<tbody>"+d.value)},t.prototype.fromReportDefinition=function(t,e,n){var r=this,o=this;this.BS={reportDefinition:t},t.Iteratefn&&e.forEach(t.Iteratefn),t.orderBy&&e.sortBy(t.orderBy,!1);var a=JSON.parse(t.summary||"{}"),s={DataSet:e,HideDetail:"true"==t.hideDetail||!1,HideTotal:0==t.groups.length||"true"==t.HideTotal||!1,ReportTemplate:t.html,ReportTableSelector:"#"+t.tableId,DetailTemplateSelector:"#"+t.details[0].id,TotalTemplateSelector:0==t.groups.length?"":"#"+t.groups.lastItem().id,Grupos:t.groups.where((function(e,n){return n<t.groups.length-1})).map((function(t,e){return{name:"G"+(e+1),selector:"#"+t.id,key:t.key,tag:t.tag||"",current:"",header:t.header,data:i.clone(a),init:function(t){var e=t[this.key].toString(),n=o.BS[this.name];n.all[e]=n.all[e]||[],n.all[e].push(t),n.recordCount=1,o.module_ReportEngine_Copy(t,this.data)},sum:function(t){var e=t[this.key].toString(),n=o.BS[this.name];n.all[e]=n.all[e]||[],n.all[e].push(t),n.recordCount+=1,o.module_ReportEngine_Sum(t,this.data)},test:function(t){return t[this.key]==this.current}}}))||[],OnGroupFooter:t.OnGroupFooter,Headers:t.headers,RepeatHeaders:(t.repeatHeader||"").split(","),RepeatHeadersAfter:t.repeatHeaderAfter,OnRow:function(e){o.BS.recordCount+=1,o.BS.previous=o.BS.data||e,o.BS.data=e,s.Grupos.forEach((function(t,e){o.BS[t.name].data=Object.create(t.data)})),o.module_ReportEngine_Sum(e,o.BS.G0),t.onRowfn&&new Function("ctx",t.onRowfn)(r.BS)},OnStart:function(e){o.BS={recordCount:0,G0:i.clone(a),dataSet:e,reportDefinition:o.BS.reportDefinition},s.Grupos.forEach((function(t,n){t.current=e&&e[0]?e[0][t.key]:"",o.BS[t.name]={recordCount:0,all:{}}})),t.onStartfn&&t.onStartfn(o.BS)},OnRowEnd:function(e){s.Grupos.forEach((function(t){t.current=e[t.key]})),t.onRowEndfn&&new Function("ctx",t.onRowEndfn)(o.BS)},PrintReport:function(t){return t&&t(r.module_ReportEngine_processAll(s)),r}};return s.PrintReport(n)},t}(),mt=function(t){var e={headers:[],groups:[],details:[]},n=[{columns:[]}],r="",o="";function i(t){return t&&t.trim().startsWith("@")?e[t.trim().split("@")[1].trim()]||"":t?t.trim():""}function a(t){for(var e=/([a-zA-Z0-9_\-]*)\s*:\s*('[^']*'|[^\s]*)/g,n={},r=e.exec(t);null!=r;)n[r[1].trim()]=i(r[2].trim().replace(/^'([^']*)'$/g,"$1")),r=e.exec(t);return n}function s(t){var e=a(t);return e.columns=[],e}function d(t){var e=[];return Object.keys(t).filter((function(e){return"columns"!=e&&"html"!=e&&t.hasOwnProperty(e)})).forEach((function(n){var r="className"==n?"class":n;e.push('{0}="{1}"'.format(r,i(t[n])))})),e.length>0?" "+e.join(" "):""}return t.split("\n").forEach((function(t){!function(t,e){if(!r&&!t.trim())return function(){};var i;if(/^(DEFINE|#|ADD_COL|CREATE|FUNCTION|END)/.test(t)){if(/^#/.test(t))return function(){};if(/^FUNCTION (\w.*)/.test(t)){var d=t.match(/^FUNCTION (\w.*)$/);return r=d[1].trim(),o="",function(){}}if(/^END/.test(t)){var c=o,l=r;return r=o="",function(t){t[l]=new Function("ctx",c)}}if(/^ADD_COL /.test(t))return d=t.match(/ADD_COL (.*)$/),i=d,function(t){n[n.length-1].columns.push(a(i[1]))};if(/^DEFINE\s\s*(\w.*)\s*=\s*(.*)$/.test(t))return d=t.match(/^DEFINE\s\s*([a-zA-Z0-9_\-]*)\s*=\s*(.*)$/),function(){var t=d;return function(e){e[t[1].trim()]=t[2].trim()}}();if(/^CREATE\s\s*(\w*) (.*)$/.test(t))return"header"==(d=t.match(/^CREATE\s\s*(\w*) (.*)$/))[1]?function(){var t=d;return function(e){e.headers.push(s(t[2])),n=e.headers}}():"group"==d[1]?function(){var t=d;return function(e){e.groups.push(s(t[2])),n=e.groups}}():"detail"==d[1]?function(){var t=d;return function(e){e.details.push(s(t[2])),n=e.details}}():function(){var t=d;return function(e){e[t[1]]=t[2]}}();throw new Error("Tabbly : Unrecognized text after DEFINE")}if(r)return o+=e,o+="\n",function(){};throw new Error("Tabbly : Unrecognized text")}(t.trim(),t)(e)})),e.html=function(){function t(t,e,n){var r="",o=n?"th":"td";return(t||[]).forEach((function(t,n){var a="";a+="\n      <tr{0}>".format(d(t)),t.columns.forEach((function(t,e){a+="\n        <{2}{0}>{1}</{2}>".format(d(t),i(t.html),o)})),a+="\n      </tr>",t.html=a,e&&e.indexOf(n.toString())>-1||(r+=a)})),r}return'<div id="{3}">\n  <table class= "w3-table-all" style = "width:100%;" id="table-{3}" >\n     <thead>{0}    </thead>\n    <tbody>{1}{2}    </tbody>\n  </table>\n</div>'.format(t(e.headers,(e.hiddenHeaders||"").split(","),!0),t(e.details),t(e.groups),e.tableId||"")}(),e},gt=n(287),vt=n.n(gt),wt=function(){function t(){this._config=i.config(r.APP_CONFIG_NAME),this._config.write("TabblyReportsView",Date.now.toString()),this._content=i.build("div",{innerHTML:vt()},!0)}return t.prototype.render=function(t){var e=this;t.innerHTML="",t.appendChild(this._content),l(t,{localInnerText:function(t,e){t.innerText=e,t.innerHTML=w3CodeColorize(t.innerHTML,"js")}},{}),this.__loadReport(this._content.querySelector("[report-container]")),V("./js/w3codecolor.js").then((function(){return e.__colorize()}))},t.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(t){return{e:t,mode:t.classList.contains("jsHigh")?"js":"html"}})).forEach((function(t){return t.e.innerHTML=w3CodeColorize(t.e.innerHTML,t.mode)}))},t.prototype.__loadReport=function(t){u.get("./js/pro-0001.txt").then((function(e){var n=mt(e);d.publish("msg/rpt/definition",e),u.get("./js/data/proveedores.json").then((function(e){d.publish("msg/rpt/data",JSON.stringify(JSON.parse(e),null,2)),(new ft).fromReportDefinition(n,JSON.parse(e),(function(e){t.appendChild(i.build("div",{innerHTML:e},!0)),l(t,{},n.getContext())}))}))}))},t}(),yt=function(){function t(){}return t.getWrapper=function(t){var e=document.getElementById(t),n={container:e,title:e.querySelector(".js-title"),body:e.querySelector(".js-content"),closeButton:e.querySelector(".js-close-button"),acceptButton:e.querySelector(".js-accept-button"),close:function(){return e.style.display="none",n},show:function(t){return t&&(n.acceptButton.onclick=function(){t(n)}),e.style.display="block",n},init:function(t){return t&&t(n),n},setTitle:function(t){return n.title.innerHTML=t,n},setBody:function(t){return t.tagName?(n.body.innerHTML="",n.body.appendChild(t)):n.body.innerHTML=t,n},disableClickOutside:function(){return n.container.onclick=function(){},n}};return n.acceptButton.onclick=n.close,n.closeButton.onclick=n.close,n.container.onclick=function(t){t.target===n.container&&n.close()},n},t}(),bt=function(){function t(){}return t.paginate=function(t,e,n,r){void 0===e&&(e=1),void 0===n&&(n=10);var o=Math.ceil(t.length/n);e<1?e=1:e>o&&(e=o);var i=(e-1)*n,a=Math.min(i+n-1,t.length-1);return{totalItems:t.length,currentPage:e,pageSize:n,totalPages:o,startIndex:i,endIndex:a,allItems:t,visibleItems:t.slice(i,a+1),title:r,getChecked:function(){return t.where({__checked:!0}).map((function(e,n){return{index:t.indexOf(e),item:e}}))}}},t}(),xt=n(933),_t=n.n(xt),St=function(){function t(){this._sortBy="",this._desc=!1,this.proveedores=[],this.current={_id:0,_nif:"",_nombre:"",_descripcion:"",_fechaDeAlta:""},this.proveedores=[],this.paginationInfo=bt.paginate(this.proveedores,1,4,""),this.paginationInfo.title="Proveedores: Cargando datos..."}return t.prototype.renderTo=function(t){var e=this;return t.appendChild(i.build("div",{innerHTML:_t()},!0)),this._header=t.querySelector("[header]"),this._tbody=t.querySelector("table tbody"),d.publish("msg/table/template",this._tbody.parentElement.outerHTML),this._tr_template=t.querySelector("table tbody tr"),this._tbody.removeChild(this._tr_template),l(t,{doAction:function(t,n,r,o){e.doAction({name:r,data:o})},doGoToPage:function(t,n){e.doAction({name:"page",data:t.value})},doSearch:function(t,n){e.doAction({name:"search",data:t.value})},doSort:function(t,n){var r=["_id","_nif","_nombre","_descripcion","_fechaDeAlta"][n.target.cellIndex-1];e.doSort(r)}},{}),this},t.prototype.loadData=function(){var t=this;this.syncTitle(),u.get("js/data/proveedores.json").then((function(e){t._sortBy="_nombre",t.proveedores=JSON.parse(e).orderBy(t._sortBy),d.publish("msg/table/data",JSON.stringify(t.proveedores,null,2)),t.goToPage("first")}))},t.prototype.goToPage=function(t){var e=~~t;"current"===t&&(e=this.paginationInfo.currentPage),"first"===t&&(e=1),"last"===t&&(e=this.paginationInfo.totalPages),"previous"===t&&(e=Math.max(this.paginationInfo.currentPage-1,1)),"next"===t&&(e=Math.min(this.paginationInfo.totalPages,this.paginationInfo.currentPage+1)),this.paginationInfo=bt.paginate(this.proveedores,e,4,""),this.syncTable()},t.prototype.syncTable=function(){var t=this;this.syncTitle(),this._tbody.innerHTML="",this._tbody.appendChild(this._tr_template.cloneNode(!0)),this.paginationInfo.fn={checked:function(t,e){return t.__checked?"checked":""}},l(h(this._tbody,this.paginationInfo),{doAction:function(e,n,r,o){t.doAction({name:r,data:o})},doAddToFavorites:function(e,n,r,o){console.log("Current -> Id : {_id}, Nif : {_nif}".merge(t.proveedores[0])),console.log(t.proveedores.select("_id")),console.log("Add to favorites {0}, {1}".format(1,2))}},{})},t.prototype.syncTitle=function(){var t=this.paginationInfo.totalItems,e=this.paginationInfo.getChecked().length,n="Proveedores: {0} elementos".format(t),r=" ({0} seleccionados)".format(e);this.paginationInfo.title=e?n+r:n,h(this._header,this.paginationInfo)},t.prototype.goToPageOf=function(t){var e=this.proveedores.indexOf(t);if(e>-1){var n=Math.floor(e/this.paginationInfo.pageSize);this.goToPage((n+1).toString())}},t.prototype.doSort=function(t){this._sortBy&&this._sortBy==t?this._desc=!this._desc:this._desc=!1,this._sortBy=t,this.proveedores=this.proveedores.sortBy(t,this._desc),this.goToPage("first")},t.prototype.doAction=function(t){if("page"===t.name)return this.goToPage(t.data);if("first"===t.name||"previous"===t.name||"next"===t.name||"last"===t.name)return this.goToPage(t.name);if("check-item"===t.name){var e=this.paginationInfo.visibleItems[t.data];e.__checked=!e.__checked,this.syncTitle()}if("delete"===t.name)return this.delete();if("new"===t.name)return this.insert();if("edit"===t.name){var n=this.paginationInfo.getChecked();if(0==n.length)return;return this.edit(n[0].item)}if("edit-row"===t.name){var r=~~t.data,o=this.proveedores.where({_id:r})[0];return this.edit(o)}return"search"===t.name?t.data?(this.proveedores=this.proveedores.where((function(e){return e._nombre.toLowerCase().includes(t.data.toLowerCase())})),this.goToPage("first")):this.loadData():void 0},t.prototype.delete=function(){var t=this,e=this.paginationInfo.getChecked();if(0!=e.length){var n=e[0].item;yt.getWrapper("dialog-container").setTitle("Borrar proveedores").setBody("¿Está seguro de eliminar el proveedor seleccionado?").show((function(e){t.proveedores.remove(n),t.goToPage("current"),e.close()}))}},t.prototype.insert=function(){var t=this;this._dialog=this._dialog||i.$("proveedor-edit-dialog"),this.current={_id:0,_nif:"",_nombre:"",_descripcion:"",_fechaDeAlta:""},h(this._dialog,this.current),yt.getWrapper("dialog-container").setTitle("Nuevo vehículo").setBody(this._dialog).disableClickOutside().show((function(e){i.$("txt-nif").value,i.$("txt-nombre").value,i.$("txt-descripcion").value;var n={_id:56,_nif:"aaaa",_nombre:"rrr",_descripcion:"rrr",_fechaDeAlta:"01/02/2020"};t.current=n,t.proveedores.push(n),t.paginationInfo.visibleItems.push(n),t._dialog.style.display="none",e.close(),t.proveedores=t.proveedores.sortBy(t._sortBy,t._desc),t.goToPageOf(n)})),this._dialog.style.display="block"},t.prototype.edit=function(t){var e=this;this._dialog=this._dialog||i.$("proveedor-edit-dialog")[0],this.current=t,yt.getWrapper("dialog-container").setTitle("Edición de proveedores").setBody(this._dialog).disableClickOutside().init((function(t){h(e._dialog,e.current)})).show((function(t){var n={_id:~~i.$("txt-id").value,_nif:i.$("txt-nif").value,_nombre:i.$("txt-nombre").value,_descripcion:i.$("txt-descripcion").value,_fechaDeAlta:""};e.current._nif=n._nif,e.current._nombre=n._nombre,e.current._descripcion=n._descripcion,e._dialog.style.display="none",t.close()})),this._dialog.style.display="block"},t}(),Tt=n(500),Et=n.n(Tt),Ct=n(640),Lt=n.n(Ct),At=function(){function t(){this.proveedores=[],this._viewMode="list",this.proveedores=[],this._paginationInfo=bt.paginate(this.proveedores,1,6,""),this._paginationInfo.title="Proveedores: Cargando datos...",this._rptEngine=new at}return t.prototype.renderTo=function(t){var e=this;return t.appendChild(i.build("div",{innerHTML:Lt()},!0)),this._header=t.querySelector("[header]"),this._listView=t.querySelector("[list-view-body]"),l(t,{doAction:function(t,n,r,o){e.doAction({name:r,data:o})},doGoToPage:function(t,n){e.doAction({name:"page",data:t.value})},syncViewButtons:function(t,e,n){t.classList.remove("w3-grey"),e==n&&t.classList.add("w3-grey")}},{}),this},t.prototype.loadData=function(){var t=this;this.syncTitle(),u.get("js/data/proveedores.json").then((function(e){t.proveedores=JSON.parse(e).sortBy("_descripcion,_nombre"),t.goToPage("first")}))},t.prototype.goToPage=function(t){var e=~~t;"current"===t&&(e=this._paginationInfo.currentPage),"first"===t&&(e=1),"last"===t&&(e=this._paginationInfo.totalPages),"previous"===t&&(e=Math.max(this._paginationInfo.currentPage-1,1)),"next"===t&&(e=Math.min(this._paginationInfo.totalPages,this._paginationInfo.currentPage+1)),this._paginationInfo=bt.paginate(this.proveedores,e,6,""),this.syncView()},t.prototype.syncView=function(){this.syncTitle(),this.syncContent(),this.syncLayout()},t.prototype.syncTitle=function(){var t=this._paginationInfo.totalItems,e=this._paginationInfo.getChecked().length,n="Proveedores: {0} elementos".format(t),r=" ({0} seleccionados)".format(e);this._paginationInfo.title=e?n+r:n,h(this._header,this._paginationInfo)},t.prototype.syncContent=function(){var t,e=this,n=i.build("div",{id:"lview-root",className:"w3-left"}),r={send:function(e){return t.innerHTML+=e},message:function(r){var o;"report.begin"==r.type?(e._listView.innerHTML="",e._listView.appendChild(n),t=n):"report.sections.group.header"==r.type?(t!=n&&n.appendChild(t),o={clear:"both",padding:"16px"},t=i.build("div",{className:"w3-left rcg-group",style:o})):"report.end"==r.type&&n.appendChild(t)}};this._rptEngine.generateReport(st.load('\n\n      CREATE section type:header id:PageHeader-01 \n      SET template\n        <div class="w3-padding w3-center w3-border-bottom">\n          {BS.dataSet.length} Elementos en la página\n        </div>\n      END\n\n      CREATE group key:_descripcion id:Group-01-descripcion\n      SET header\n        <h4 class="w3-opacity w3-border-bottom w3-border-top">\n          <b>{current}</b>\n        </h4>\n      END\n      SET footer\n        <div class="w3-left w3-opacity w3-border-top w3-right-align" \n             style="clear:both;width:100%;">\n          {BS.previous._id} {current} {BS.G1.recordCount} elementos\n        </div>       \n      END\n\n      CREATE detail id:Detail-01\n      SET template\n        <div class="w3-padding w3-white w3-boder w3-display-container w3-left rcg-item"\n             style="margin-right:8px;">\n          <b>NIF</b> {BS.data._nif}<br/>\n          <b>Nombre</b> {BS.data._nombre}<br/>\n          <b>Id</b> {BS.data._id}<br/>\n          <b>Fecha</b> {BS.data._fechaDeAlta|fixDate}\n        </div>\n      END\n    '),this._paginationInfo.visibleItems,r)},t.prototype.goToPageOf=function(t){var e=this.proveedores.indexOf(t);if(e>-1){var n=Math.floor(e/this._paginationInfo.pageSize);this.goToPage((n+1).toString())}},t.prototype.doAction=function(t){if("page"===t.name)return this.goToPage(t.data);if("first"===t.name||"previous"===t.name||"next"===t.name||"last"===t.name)return this.goToPage(t.name);if("check-item"===t.name){var e=this._paginationInfo.visibleItems[t.data];e.__checked=!e.__checked,this.syncTitle()}if("list"===t.name||"grid"===t.name)return this._viewMode=t.name,this.syncLayout();if("delete"===t.name)return this.delete();if("new"===t.name)return this.insert();if("edit"===t.name){var n=this._paginationInfo.getChecked();if(0==n.length)return;return this.edit(n[0].item)}if("edit-row"===t.name){var r=~~t.data,o=this.proveedores.where({_id:r})[0];return this.edit(o)}return"search"===t.name?t.data?(this.proveedores=this.proveedores.where((function(e){return e._nombre.toLowerCase().includes(t.data.toLowerCase())})),this.goToPage("first")):this.loadData():void 0},t.prototype.delete=function(){},t.prototype.insert=function(){},t.prototype.edit=function(t){},t.prototype.syncLayout=function(){var t=i.elements(".rcg-group",this._listView),e=i.elements(".rcg-item",this._listView),n=i.element("lview-root");"list"==this._viewMode?(t.forEach((function(t){t.style.clear="both",t.style.width="100%"})),e.forEach((function(t){t.style.width="100%"})),n.style.height="300px",n.style.width="100%",n.style.overflow="auto"):(t.forEach((function(t){t.style.clear="none",t.style.width=""})),e.forEach((function(t){t.style.width=""})),n.style.height="280px",n.style.width="{0}px".format(this._rptEngine.compute(t,"clientWidth")+16*t.length),n.style.overflow=""),d.publish("msg/view/change",this._viewMode)},t}(),Mt=function(){function t(){this._config=i.config(r.APP_CONFIG_NAME),this._config.write("TablesView",Date.now.toString()),this._content=i.build("div",{innerHTML:Et()},!0)}return t.prototype.render=function(t){var e=this;t.innerHTML="",t.appendChild(this._content),l(t,{localInnerText:function(t,e,n){t.innerText=e,V("./js/w3codecolor.js").then((function(){return t.innerHTML=w3CodeColorize(t.innerHTML,n)}))}},{}),(new St).renderTo(i.element("[table-container]",this._content)).loadData(),U.create("Listview","-").appendTo(i.element("[list-view-container]",this._content)).onexpand.add(this.__loadListview),V("./js/w3codecolor.js").then((function(){return e.__colorize()}))},t.prototype.__loadListview=function(t,e){e.loaded||(e.loaded=!0,(new At).renderTo(e.getBody()).loadData())},t.prototype.__colorize=function(){this._content.querySelectorAll(".js").toArray().forEach((function(t){return t.innerHTML=w3CodeColorize(t.innerHTML,"js")}))},t}(),It=function(){function t(){}return t.prototype.run=function(){this.loadData()},t.prototype.loadData=function(){var t=this;u.get("js/data/libros.json").then((function(e){t._books=JSON.parse(e).sortBy("publisher_date,language,publisher,ID"),t.createContent()}))},t.prototype.createContent=function(){var t=m.createTree(this._books,["publisher_date","language","publisher"]),e=i.build("div",{className:"w3-margin-bottom node-leaf",innerHTML:'<h4 xbind data-level="{deep}">{name}</h4><ul>  <li xfor="book in rows" xbind>{book.ID} {book.title}</li></ul><h5 class="w3-right-align" xbind>{name} {rows.length} libros</h5>'});d.publish("msg/main-page/test/content","<p>Generación de contenido a partir de datos agrupados</p>"+m.treeToHtml(t,'<div class="w3-margin-bottom node-content">  <h3 class="w3-teal header" data-level="{deep}">{name}</h3>  {innerHTML}<h5 class="w3-right-align">{parent.parent.name} > {parent.name} > {name} {children.length} grupos</h5></div>',e))},t}();R=document.getElementById("app-content"),F=i.config(r.APP_CONFIG_NAME),R.innerHTML=e(),l(R,{openLink:function(t,e,n){document.querySelectorAll(".city").toArray().forEach((function(t){return t.style.display=t.id==n?"block":"none"})),document.querySelectorAll(".tablink").toArray().forEach((function(t){return t.classList.remove("w3-red")})),t.className+=" w3-red";var r=i.$(n);"VIEW-COMMANDS"==n&&(new q).render(r),"VIEW-PUB-SUB"==n&&(new it).render(r),"VIEW-TABLES"==n&&(new Mt).render(r),"VIEW-REPORTS"==n&&(new wt).render(r),"VIEW-REPORTS-V2"==n&&(new ht).render(r),"VIEW-REPORTS-JS"==n&&(new lt).render(r),"VIEW-CONTENT-EDITABLE"==n&&(new nt).render(r)},doAction:function(t,e,n){return"tree"==n?(new It).run():"bar"==n?(new H).run():"svg-bar"==n?(new P).run():"pie"==n?(new O).run():"lines"==n?(new j).run():void 0}},{}),F.write("LastUsed",Date.now.toString())})()})();