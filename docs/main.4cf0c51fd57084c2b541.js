!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=9)}([function(e,n){e.exports='<div class="w3-animate-left">\r\n  <div class="w3-teal w3-padding">TypeScript-app</div>\r\n\t<div class="w3-bar w3-black w3-card">\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-HOME"><i class="fa fa-home" aria-hidden="true"></i></button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-TABLES">Tablas</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-PUB-SUB">Pub-Sub</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-COMMANDS">Commands</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-REPORTS">Reports</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-REPORTS-V2">Reports V2</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-REPORTS-JS">JsReports</button>\r\n    <button class="w3-bar-item w3-button tablink" on-click="openLink:VIEW-CONTENT-EDITABLE">Content-editable</button>\r\n  </div>\r\n\r\n  <div id="VIEW-TABLES"     class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n  <div id="VIEW-PUB-SUB"    class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-COMMANDS"   class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-REPORTS"    class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-REPORTS-V2" class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\t<div id="VIEW-REPORTS-JS" class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n  <div id="VIEW-CONTENT-EDITABLE" class="w3-display-container city w3-animate-opacity" style="display:none"></div>\r\n\r\n  <div id="VIEW-HOME" class="w3-display-container city w3-animate-opacity">\r\n    <div class="w3-teal w3-center w3-padding">Página principal</div>\r\n    <div class="w3-padding">\r\n      <p>\r\n        Prueba de concepto de un framework para el desarrollo de aplicaciones con TypeScript.\r\n      </p>\r\n    </div>\r\n  </div>\r\n\r\n</div>'},function(e,n){e.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">CommandManager</div>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <p style="text-indent:1em;">\r\n      Ejemplo de uso del manejador de comandos que permite hacer y deshacer operaciones sobre un objeto o "documento".\r\n    </p>\r\n\r\n    <button on-click="doCommand">Probar comando</button>\r\n    <div message-container class="w3-container w3-padding">\r\n\r\n    </div>\r\n\r\n    <p style="text-indent:1em;">\r\n      <h3>Código del ejemplo</h3>\r\n      <div class="w3-code jsHigh notranslate" style="overflow: auto;white-space: pre;">var _commandManager = CommandManager(this._document);\r\nthis._document.name = \'Valor inicial\';\r\nlet __container = this._content.querySelector&lt;HTMLElement&gt;(\'[message-container]\');\r\n__container.innerHTML = this._document.name + \'&lt;br/&gt;\';\r\nthis._commandManager.executeCommad(ToUpperCaseCommand());\r\n__container.innerHTML += this._document.name + \'&lt;br/&gt;\';\r\nthis._commandManager.undo();\r\n__container.innerHTML += this._document.name + \'&lt;br/&gt;\';\r\nthis._commandManager.redo();\r\n__container.innerHTML += this._document.name + \'&lt;br/&gt;\';</div>\r\n    </p>\r\n\r\n    <p style="text-indent:1em;">\r\n      <h3>Código del comando</h3>\r\n      Comando para convertir el contenido del documento a mayúsculas y reestablecer su estado si se deshace la operación.\r\n      <div class="w3-code jsHigh notranslate" style="overflow: auto;white-space: pre;">function ToUpperCaseCommand(): Command {\r\nlet __command = {\r\n  bak     : \'\',\r\n  execute : function (doc:any): Command {\r\n    this.bak = doc.name;\r\n    doc.name = doc.name.toUpperCase();\r\n    return __command;\r\n  },\r\n  undo    : function (doc:any): Command {\r\n    doc.name = this.bak;\r\n    return __command;\r\n  }\r\n}\r\nreturn __command;\r\n}</div>\r\n    </p>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},function(e,n){e.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">Pub-Sub</div>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <p style="text-indent:1em;">\r\n      Ejemplo de uso del patrón Publisher/Subscriber.\r\n    </p>\r\n    <button on-click="doPublish">Publicar mensaje</button>\r\n\t  <div class="w3-container w3-padding" on-publish="TOPICS.NOTIFICATION:innerHTML">\r\n    </div>\r\n\r\n    <p style="text-indent:1em;">\r\n      <h3>Código Js del ejemplo</h3>\r\n      <div class="w3-code jsHigh notranslate" style="overflow: auto;white-space: pre;">import pubSub from \'../../lib/core.pub-sub\';\r\ndoPublish : function(){\r\n  pubSub.publish(pubSub.TOPICS.NOTIFICATION, \'Botón doPublish\'); \r\n  setTimeout( function(){\r\n    pubSub.publish(pubSub.TOPICS.NOTIFICATION, \'\'); \r\n  }, 2000);\r\n}</div>\r\n      <h3>Html</h3>\r\n      <div class="w3-code htmlHigh notranslate" style="overflow: auto;white-space: pre;">&lt;div class="w3-container w3-padding" on-publish="TOPICS.NOTIFICATION:innerHTML"&gt;</div>\r\n    </p>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},function(e,n){e.exports="<div>\r\n\r\n  <div class=\"w3-teal w3-center w3-padding\">Informes Js</div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Listado</h3>\r\n      <ul>\r\n        <li>En esta versión TODO el contenido del informe está en un único fichero javaScript. Este fichero se incluye como un <code class=\"w3-codespan\">include('./js/pro-0001.js').then((cancel:Function) => {}</code>.</li>\r\n        <li>La generación del contenido se realiza por medio de <code class=\"w3-codespan\">String.format(context)</code>.\r\n         <div class=\"w3-code jsHigh notranslate\" \r\n             style=\"overflow: auto;white-space: pre;\">'{0|toFixed,2}'.format(55);\r\n'{0|toUpperCase}'.format('aaa');\r\n'{0|toUpperCase:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format=>1;2}'.format('aaa', { format(value,a,b){ return '->' + value + a + b; } });\r\n'{format}'.format({ id : 55, format(){ return this.id; }});\r\n'{format:url;@window.location.href|toUpperCase b}'.format({ format(value, href, b){ return value + ' ' + href;}});\r\n'{id}'.format({ id : 55, format(){ return this.id; }});\r\n'{id|toFixed,3}'.format({ id : 55 });\r\n'{id|toFixed,3:format}'.format({ id : 55, format(v){ return v + ' €'; }});\r\n'{id:format=>@window.location.href|toUpperCase;b;c}'.format({ id : 55, format(v,a,b,c){ return v + ' €'; }});</div>\r\n        </li>\r\n        <li>Es posible especificar una plantilla o una función para crear el contenido <code class=\"w3-codespan\">CREATE group key:_descripcion id:Group01_tipo headerValueProviderfn:BS.fn.header_provider_fn</code>.</li>\r\n        <li>Se pueden crear una o más secciones de cabecera y de resumen del informe.</li>\r\n        <li>Se pueden crear una o más secciones de detalle.</li>\r\n        <li>Se pueden crear agrupaciones y dentro de estas indicar una cabecera y pie de grupo.</li>\r\n      </ul>\r\n    </p>\r\n    <div class=\"w3-padding w3-border\" report-container style=\"overflow:auto; max-height:400px;\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Código JavaScript</h3>\r\n      <div class=\"w3-code jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre; height:200px\">import { ReportEngine } from '../../lib/core.tabbly.v2.engine';\r\nimport { loader } from '../../lib/core.tabbly.v2.loader';\r\n\r\nprivate __loadReport(target:HTMLElement){\r\n    \r\n    /* ==========================================================================\r\n    // Receptor de mensajes\r\n    // ========================================================================*/\r\n    var __handler = { \r\n      buffer  : '' ,\r\n      send    : function(data:string){ this.buffer += data; },\r\n      message : function(message:any){ \r\n        /*console.log(message);*/ \r\n      },\r\n      flush   : function(){ },\r\n      clear   : function(){ this.buffer = ''; }\r\n    };\r\n\r\n    /* =============================================================================\r\n    // Definición del informe\r\n    // ===========================================================================*/\r\n    include('./js/pro-0001.js').then((cancel:Function) => {\r\n      var __rd = (window as any).__reportDefinition(loader, core);\r\n      /* =======================================================================\r\n      // Cargar los datos\r\n      // =====================================================================*/\r\n      ajax.get('./js/data/proveedores.json')\r\n          .then((res:string) => {\r\n            __handler.clear()\r\n            new ReportEngine().generateReport(__rd, JSON.parse(res), __handler);\r\n            target.append(core.build('div', { innerHTML : __handler.buffer }));\r\n            addEventListeners(target, {}, __rd.getContext());\r\n            cancel();      \r\n      });\r\n    });     \r\n}</div>\r\n    </p>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Definición del informe</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/definition:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/data:localInnerText\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>"},function(e,n){e.exports="<div>\r\n\r\n  <div class=\"w3-teal w3-center w3-padding\">Informes V2</div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Listado</h3>\r\n      <ul>\r\n        <li>En esta versión el fichero se carga por medio de Ajax. Las funciones javaScript están definidas en el fichero de texto.</li>\r\n        <li>La generación del contenido se realiza por medio de <code class=\"w3-codespan\">String.format(context)</code>.\r\n         <div class=\"w3-code jsHigh notranslate\" \r\n             style=\"overflow: auto;white-space: pre;\">'{0|toFixed,2}'.format(55);\r\n'{0|toUpperCase}'.format('aaa');\r\n'{0|toUpperCase:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format=>1;2}'.format('aaa', { format(value,a,b){ return '->' + value + a + b; } });\r\n'{format}'.format({ id : 55, format(){ return this.id; }});\r\n'{format:url;@window.location.href|toUpperCase b}'.format({ format(value, href, b){ return value + ' ' + href;}});\r\n'{id}'.format({ id : 55, format(){ return this.id; }});\r\n'{id|toFixed,3}'.format({ id : 55 });\r\n'{id|toFixed,3:format}'.format({ id : 55, format(v){ return v + ' €'; }});\r\n'{id:format=>@window.location.href|toUpperCase;b;c}'.format({ id : 55, format(v,a,b,c){ return v + ' €'; }});</div>\r\n        </li>\r\n        <li>Es posible especificar una plantilla o una función para crear el contenido <code class=\"w3-codespan\">CREATE group key:_descripcion id:Group01_tipo headerValueProviderfn:BS.fn.header_provider_fn</code>.</li>\r\n        <li>Se pueden crear una o más secciones de cabecera y de resumen del informe.</li>\r\n        <li>Se pueden crear una o más secciones de detalle.</li>\r\n        <li>Se pueden crear agrupaciones y dentro de estas indicar una cabecera y pie de grupo.</li>\r\n      </ul>\r\n    </p>\r\n    <div class=\"w3-padding w3-border\" report-container style=\"overflow:auto; max-height:400px;\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Código JavaScript</h3>\r\n      <div class=\"w3-code jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre; height:200px\">import { ReportEngine } from '../../lib/core.tabbly.v2.engine';\r\nimport { loader } from '../../lib/core.tabbly.v2.loader';\r\n\r\nprivate __loadReport(target:HTMLElement){\r\n    \r\n    /* ==========================================================================\r\n    // Receptor de mensajes\r\n    // ========================================================================*/\r\n    var __handler = { \r\n      buffer  : '' ,\r\n      send    : function(data:string){ this.buffer += data; },\r\n      message : function(message:any){ \r\n        /*console.log(message);*/ \r\n      },\r\n      flush   : function(){ },\r\n      clear   : function(){ this.buffer = ''; }\r\n    };\r\n\r\n    /* =============================================================================\r\n    // Definición del informe\r\n    // ===========================================================================*/\r\n    ajax.get('./js/pro-0001-v2.txt')\r\n        .then((res:string) => {\r\n          var __rd = loader.load(res);\r\n          /* =======================================================================\r\n          // Datos del informe\r\n          // =====================================================================*/\r\n          ajax.get('./js/data/proveedores.json')\r\n              .then((res:string) => {\r\n                new ReportEngine().generateReport(__rd, JSON.parse(res), __handler);\r\n                target.append(core.build('div', { innerHTML : __handler.buffer }));\r\n\r\n                addEventListeners(target, {}, __rd.getContext());            \r\n              });                          \r\n        });      \r\n}</div>\r\n    </p>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Definición del informe</h3>\r\n      <div class=\"w3-code w3-border\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/definition:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/data:localInnerText\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"},function(e,n){e.exports="<div>\r\n\r\n  <div class=\"w3-teal w3-center w3-padding\">Informes</div>\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Listado</h3>\r\n        <ul>\r\n          <li>Esta es la primera versión del generador de informes (Tabbly). Primeramente se genera una tabla html con la información del fichero.\r\n          Esta tabla se corresponde con la estructura del informe. Se le aplica la función de transformación para generar el contenido.\r\n          </li>\r\n          <li>La generación del contenido se realiza por medio de <code class=\"w3-codespan\">__fillTemplate(e: HTMLElement, scope : any)</code>.</li>\r\n          <li>El fichero .txt con la definición del informe se carga por medio de Ajax generalmente. Las funciones javaScript están definidas en el fichero de texto.</li>\r\n          <li>La función de transformación <code class=\"w3-codespan\">__fillTemplate</code> es la propia del motor</li>\r\n          <li>Se utiliza la función <code class=\"w3-codespan\">core.getValue(key : string, scope? : any)</code> por lo que se puede \r\n          aplicar una función del prototipo al valor solicitado. <code class=\"w3-codespan\">libro.name|htmlDecode,p1,p2,...</code></li>\r\n          <li>Se pueden establecer valores de atributos. <code class=\"w3-codespan\">ADD_COL xbind:'' id:'txt-{BS.data._id}'</code></li>\r\n          <li>\r\n            Se puede utilizar el reemplazo de cadena <code class=\"w3-codespan\">DEFINE  __COL_5_INNERHTML = &lt;div class=\"w3-red\"&gt;&lt;h2 xbind>{BS.data._nombre|toUpperCase}&lt;/h2&gt;&lt;/div&gt;</code>\r\n            La función de transformación <code class=\"w3-codespan\">merge(template: string, scope: any, HTMLElemnt?:HTMLElement)</code> es la de core.templates\r\n          </li>\r\n          <li>Merge:<br />\r\n    <div class=\"w3-code jsHigh notranslate\" \r\n             style=\"overflow: auto;white-space: pre;\">'{0|toFixed,2}'.format(55);\r\n'{0|toUpperCase}'.format('aaa');\r\n'{0|toUpperCase:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format}'.format('aaa', { format(value){ return '->' + value; } });\r\n'{0:format=>1;2}'.format('aaa', { format(value,a,b){ return '->' + value + a + b; } });\r\n'{format}'.format({ id : 55, format(){ return this.id; }});\r\n'{format:url;@window.location.href|toUpperCase b}'.format({ format(value, href, b){ return value + ' ' + href;}});\r\n'{id}'.format({ id : 55, format(){ return this.id; }});\r\n'{id|toFixed,3}'.format({ id : 55 });\r\n'{id|toFixed,3:format}'.format({ id : 55, format(v){ return v + ' €'; }});\r\n'{id:format=>@window.location.href|toUpperCase;b;c}'.format({ id : 55, format(v,a,b,c){ return v + ' €'; }});</div>\r\n          </li>\r\n          <li>Para establecer los valores con xbind se puede utilizar:\r\n            <ul>\r\n              <li><code class=\"w3-codespan\">xbind:'innerHTML:BS.data._nif|toUpperCase'</code></li>\r\n              <li><code class=\"w3-codespan\">xbind:'innerHTML:BS.fn.fixDate2 @BS.data._fechaDeAlta,abc,9'</code> la función recibe los parámetros de la siguiente forma  <code class=\"w3-codespan\"></code> function(scope, sender, value, a, b, c)</li>\r\n              <li><code class=\"w3-codespan\">xbind:'innerHTML:BS.data._fechaDeAlta BS.fn.fixDate extraParams'</code> la función recibe los parámetros de la siguiente forma  <code class=\"w3-codespan\">function(_value, extraParams, scope, child);</code></li>\r\n            </ul>          \r\n          </li>\r\n        </ul>\r\n    </p>\r\n\r\n    <div class=\"w3-padding w3-border\" report-container style=\"overflow:auto; max-height:400px;\">\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n  <div class=\"w3-padding\">\r\n    <p style=\"text-indent:1em;\">\r\n      <h3>Código JavaScript</h3>\r\n      <div class=\"w3-code jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre; height:200px\">import { ReportEngine as reportEngine } from '../../lib/core.tabbly.engine';\r\nimport { loader as reportLoader } from '../../lib/core.tabbly.loader';\r\n\r\najax.get('./js/pro-0001.txt')\r\n    .then((res:string) => {\r\n      var __rd = reportLoader.load(res);\r\n\r\n      pubSub.publish('msg/rpt/definition', res);\r\n\r\n      ajax.get('./js/data/proveedores.json')\r\n          .then((res:string) => {\r\n\r\n            pubSub.publish('msg/rpt/data', res);\r\n\r\n            new reportEngine()\r\n              .fromReportDefinition(__rd, JSON.parse(res), (html:string) => { \r\n                target.append(core.build('div', { innerHTML : html }, true));\r\n                addEventListeners(target, {}, __rd.getContext());                       \r\n              });\r\n                \r\n          });              \r\n    });      \r\n}</div>\r\n    </p>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Definición del informe</h3>\r\n      <div class=\"w3-code w3-border\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/definition:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"w3-half w3-padding\">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class=\"w3-code w3-border jsHigh notranslate\" \r\n           style=\"overflow: auto;white-space: pre;\" \r\n           on-publish=\"msg/rpt/data:localInnerText\">\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"},function(e,n){e.exports='<div class="">\r\n\r\n  <h1>Proveedores</h1>\r\n\r\n  <div header class="w3-bar w3-border-top w3-border-left w3-border-right">\r\n\r\n    <span xbind="innerHTML:title" class="w3-left" style="padding:6px 0 4px 8px;"></span>\r\n\r\n    <button class="w3-button w3-xlarge w3-right fa fa-plus w3-border-left" style="padding: 7px 4px;" title="Insertar" on-click="doAction:new"></button>\r\n    <button class="w3-button w3-xlarge w3-right fa fa-trash w3-border-left" style="padding: 7px 4px;" title="Eliminar" on-click="doAction:delete"></button>\r\n    <button class="w3-button w3-xlarge w3-right fa fa-edit w3-border-left" style="padding: 9px 4px 5px 4px;" title="Editar" on-click="doAction:edit"></button>\r\n\r\n    <button on-click="doAction:last" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10095;&#10095;</button>\r\n    <button on-click="doAction:next" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10095;</button>\r\n    <input on-change="doGoToPage" xbind="value:currentPage" class="w3-right w3-center" style="width: 3em;padding:8px; border:none" />\r\n    <button on-click="doAction:previous" class="w3-button w3-right w3-border-left w3-border-right" style="padding: 8px;">&#10094;</button>\r\n    <button on-click="doAction:first" class="w3-button w3-right w3-border-left" style="padding: 8px;">&#10094;&#10094;</button>\r\n\r\n    <div class="w3-right w3-border-left" style="margin:0; padding:0">\r\n      <input on-change="doSearch" type="text" class="w3-right" style="padding:8px; border:none" placeholder="Buscar.." /> \r\n    </div>\r\n\r\n  </div>\r\n\r\n  <table class="w3-table-all">\r\n    <thead>\r\n      <tr on-click="doSort">\r\n        <th style="width:1%;"></th>\r\n        <th class="w3-hover-gray sorteable">Id</th>\r\n        <th class="w3-hover-gray sorteable">Nif</th>\r\n        <th class="w3-hover-gray sorteable">Nombre</th>\r\n        <th class="w3-hover-gray sorteable">Descripción</th>\r\n        <th class="w3-hover-gray sorteable">Fecha</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr xbind xfor="proveedor in this.visibleItems" id="row-{proveedor._id}">\r\n        <td xbind class="w3-border-right">\r\n          <input xbind="checked:fn.checked=>@proveedor" type="checkbox" on-click="doAction:check-item:{index}" />\r\n        </td>\r\n        <td xbind on-click="doAction:edit-row:{proveedor._id}">{proveedor._id}</td>\r\n        <td xbind>{proveedor._nif}</td>\r\n        <td xbind>{proveedor._nombre}</td>\r\n        <td xbind>{proveedor._descripcion|toUpperCase}</td>\r\n        <td xbind>\r\n          {proveedor._fechaDeAlta|fixDate}\r\n          <button xbind title="Añadir a favoritos" class="fa fa-star" style="float:right" on-click="doAddToFavorites:{proveedor._id}"></button>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n\r\n  <form id="proveedor-edit-dialog" class="" style="display:none">\r\n    <label for="txt-id">Id</label>\r\n    <input xbind="value:_id" id="txt-id" type="text" class="w3-input w3-border w3-round" readonly /><br />\r\n    <label for="txt-nif">Nif</label>\r\n    <input xbind="value:_nif" id="txt-nif" type="text" class="w3-input w3-border w3-round" /><br />\r\n\r\n    <label for="txt-nombre">Nombre</label>\r\n    <input xbind="value:_nombre" id="txt-nombre" type="text" class="w3-input w3-border w3-round"  /><br />\r\n    <label for="txt-descripcion">Descripción</label>\r\n    <input xbind="value:_descripcion" id="txt-descripcion" type="text" class="w3-input w3-border w3-round" /><br />\r\n  </form>\r\n\r\n</div>\r\n'},function(e,n){e.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">Edición de entidades</div>\r\n\r\n  <div class="w3-padding">\r\n    <p style="text-indent:1em;">\r\n      <h3>Página de edición de entidades</h3>\r\n      Ejemplo de una página para la edición de entidades. Se utiliza FillTemplate para la generación de la tabla.\r\n    </p>\r\n    <div class="w3-padding w3-border" table-container>\r\n\r\n    </div>\r\n  </div>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <div class="w3-half w3-padding">\r\n      <h3>Código JavaScript</h3>\r\n      <div class="w3-code w3-border js notranslate" \r\n           style="overflow: auto;white-space: pre;" >/* ==========================================================================\r\n// Manejadores de eventos de los botones de navegación\r\n// ========================================================================*/        \r\naddEventListeners( \r\n  container, {\r\n    doAction : (sender:HTMLElement, event:MouseEvent, name:any, data:any) => {\r\n      this.doAction({name, data });\r\n    },\r\n    doGoToPage : (sender:HTMLInputElement, event:MouseEvent) => {\r\n      this.doAction({name: \'page\', data : sender.value});\r\n    },\r\n    doSearch : (sender:HTMLInputElement, event:MouseEvent) => {\r\n      this.doAction({name: \'search\', data : sender.value});\r\n    },\r\n    doSort : (sender:HTMLElement, event:MouseEvent) => {\r\n      let __field = [\'_id\',\r\n                     \'_nif\',\r\n                     \'_nombre\',\r\n                     \'_descripcion\',\r\n                     \'_fechaDeAlta\'][(event.target as HTMLTableCellElement).cellIndex - 1];\r\n      this.doSort(__field);\r\n    }\r\n  }, {});\r\n\r\n/* ==========================================================================\r\n// Generación de la tabla\r\n// ========================================================================*/\r\nsyncTable() {\r\n  this.syncTitle();\r\n  this._tbody.innerHTML = \'\';\r\n  this._tbody.appendChild(this._tr_template.cloneNode(true));\r\n    \r\n  (this.paginationInfo as any).fn = {\r\n    checked : (proveedor:any, b:HTMLInputElement) => { \r\n      return proveedor.__checked ? \'checked\' : \'\';\r\n    }\r\n  }\r\n\r\n  addEventListeners( \r\n    fillTemplate(this._tbody, this.paginationInfo), \r\n    {\r\n      doAction : (sender:HTMLElement, event:MouseEvent, name:any, data:any) => {\r\n        this.doAction({name, data });\r\n      },\r\n      doAddToFavorites: (sender: HTMLButtonElement, event:MouseEvent, name:any, data:any) => {\r\n        console.log(\'Current -> Id : {_id}, Nif : {_nif}\'.merge(this.proveedores[0])); \r\n        console.log(this.proveedores.select(\'_id\'));\r\n        console.log(\'Add to favorites {0}, {1}\'.format(1, 2));\r\n      }\r\n    }, {});\r\n}\r\n\r\n/* ==========================================================================\r\n// Actualización de la cabecera de la tabla\r\n// ========================================================================*/\r\nsyncTitle() {\r\n  let __total      = this.paginationInfo.totalItems\r\n  let __selected   = this.paginationInfo.getChecked().length;\r\n  let __template   = \'Proveedores: {0} elementos\'.format(__total);\r\n  let __template_s = \' ({0} seleccionados)\'.format(__selected);\r\n  if (__selected) {\r\n    this.paginationInfo.title = __template + __template_s;\r\n  } else {\r\n    this.paginationInfo.title = __template;\r\n  }\r\n  fillTemplate(this._header, this.paginationInfo);\r\n}</div>\r\n    </div>\r\n\r\n    <div class="w3-half w3-padding">\r\n      <h3>Plantilla de transformación</h3>\r\n      <div class="w3-code w3-border" \r\n           style="overflow: auto;white-space: pre;" \r\n           on-publish="msg/table/template:localInnerText:html">\r\n      </div>\r\n    </div>\r\n\r\n    <div class="w3-half w3-padding">\r\n      <h3>Datos del ejemplo</h3>\r\n      <div class="w3-code w3-border jsHigh notranslate" \r\n           style="overflow: auto;white-space: pre;" \r\n           on-publish="msg/table/data:localInnerText:js">\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},function(e,n){e.exports='<div>\r\n\r\n  <div class="w3-teal w3-center w3-padding">Content-editable</div>\r\n\r\n  <h2 class="w3-margin">\r\n    Edición de tablas.\r\n  </h2>\r\n\r\n  <div class="w3-padding">\r\n\r\n    <table class="w3-table-all"> \r\n      <thead>\r\n        <tr>\r\n          <th style="width:1%;"></th>\r\n          <th class="">Id</th>\r\n          <th class="">Descripción</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr xbind xfor="item in this.data" id="row-{item.id}">\r\n          <td xbind class="w3-border-right">\r\n            <input type="checkbox" disabled />\r\n          </td>\r\n          <td xbind data-index="{index}" contenteditable="true">{item.id}</td>\r\n          <td xbind data-index="{index}" contenteditable="true">{item.descripcion}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <div class="w3-padding">\r\n      <button on-click="doSave">Guardar</button>\r\n    </div>\r\n\t  <div class="w3-code" style="overflow: auto;white-space: pre;" on-publish="msg/log:writeLog:append"></div>\r\n\r\n  </div>\r\n\r\n  <h2 class="w3-margin">\r\n    Visor de texto\r\n  </h2>\r\n  <div class="w3-container w3-margin w3-round w3-border" style="height:250px;position:relative" text-viewer>\r\n\r\n  </div>\r\n\r\n</div>\r\n'},function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r);function i(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),o=0;for(n=0;n<t;n++)for(var i=arguments[n],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var a=new(function(){function e(){}return e.prototype.isNull=function(e){return null===e},e.prototype.toArray=function(e){return Array.from(e)},e.prototype.isArray=function(e){return Array.isArray(e)},e.prototype.isString=function(e){return"string"==typeof e},e.prototype.isBoolean=function(e){return"boolean"==typeof e},e.prototype.isNumber=function(e){return"number"==typeof e},e.prototype.isFunction=function(e){return"function"==typeof e},e.prototype.isObject=function(e){return e&&"object"==typeof e},e.prototype.apply=function(e,n,t){if(t&&this.apply(e,t),e&&n&&this.isObject(n))for(var r in n)this.isArray(n[r])?e[r]=this.clone(n[r]):this.isObject(n[r])?this.apply(e[r]=e[r]||{},n[r]):e[r]=n[r];return e},e.prototype.clone=function(e){var n=this;return this.isArray(e)?e.slice(0):this.isObject(e)&&e.clone?e.clone():this.isObject(e)?Object.keys(e).reduce((function(t,r){return t[r]=n.clone(e[r]),t}),{}):e},e.prototype.join=function(e,n,t){return e.reduce((function(e,t){return e.append(t[n||"id"])}),[]).join(void 0===t?"-":t||"")},e.prototype.createStringBuilder=function(e){return{value:e||"",append:function(e){return this.value=this.value+e,this},appendLine:function(e){return this.value=this.value+(e||"")+"\n",this}}},e.prototype.$=function(e,n){var t,r=document.getElementById(e);return r||((t=n?n.querySelectorAll(e):document.querySelectorAll(e)).length?t.toArray():null)},e.prototype.build=function(e,n,t){var r=this.isString(n)?{innerHTML:n}:n,o=this.apply(document.createElement(e),r);return t?o.firstElementChild:o},e.prototype.parseQueryString=function(){return location.search.slice(1).split("&").reduce((function(e,n){return e[n.split("=")[0]]=n.split("=")[1]||"",e}),{})},e.prototype.config=function(e){return{write:function(n,t){return localStorage.setItem("{0}.{1}".format(e,n),t),this},read:function(n){return localStorage.getItem("{0}.{1}".format(e,n))}}},e.prototype.getValue=function(e,n){return e.split(/\.|\[|\]/).reduce((function(e,n){if(""===n)return e;if("this"===n)return e;var t=n,r=n.indexOf("|")>-1,o=[];if(r){var i=String.trimValues(n.split("|"));t=i[0],o=String.trimValues(i[1].split(","))}var s=e[t];return void 0===s&&e.outerScope&&(s=a.getValue(t,e.outerScope)),null!=s?r?s.__proto__[o[0]].apply(s,o.slice(1)):s:e===self?"":self}),n||self)},e}());String.leftPad=function(e,n,t){var r=""+e;for(null!=t&&""!==t||(t=" ");r.length<n;)r=t+r;return r},String.trimValues=function(e){return e.map((function(e){return e.trim()}))},String.prototype.format=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=e[e.length-1]||self,r=function(e,n,r){var o=String.trimValues(n).reduce((function(e,n){return e.push("@"==n.charAt(0)?a.getValue(n.slice(1),t):n),e}),r);return e.apply(t,o)};return this.replace(/\{(\d+|[^{]+)\}/g,(function(n,o){var i,s=String.trimValues(o.split(":")),c=s[0],d=s[1];if(/^\d+/.test(c)){var l=String.trimValues(c.split("|")),u=~~l[0],p=0==l.length?"data":["data"].concat(l.slice(1)).join("|"),f={data:e[u],outerScope:t};i=a.getValue(p,f)}else i=a.getValue(c,t);if(a.isFunction(i))return r(i,d?d.split(/\s|\;/):[],[]);if(d){var h=String.trimValues(d.split(/=>/)),m=h[0],v=h[1];return r(a.getValue(m,t),v?v.split(/\s|\;/):[],[i])}return i}))},String.prototype.replaceAll=function(e,n){return this.split(e).join(n)},String.prototype.fixDate=function(){return this.split(" ")[0]},String.prototype.fixTime=function(){return this.split(" ")[1]},String.prototype.fixYear=function(){return this.fixDate().split("/")[2]},String.prototype.paddingLeft=function(e){return(e+this).slice(-e.length)},String.prototype.merge=function(e){return this.replace(/{([^{]+)?}/g,(function(n,t){if(t.indexOf(":")>0){var r=t.split(":");return a.getValue(r[0],e)(a.getValue(r[1],e),e)}var o=a.getValue(t,e);return"function"==typeof o?o(e):o}))},String.prototype.toXmlDocument=function(){return(new DOMParser).parseFromString(this,"text/xml")},String.prototype.htmlDecode=function(){return(new DOMParser).parseFromString(this,"text/html").documentElement.textContent},Array.prototype.remove=function(e){var n=this.indexOf(e);return-1!=n&&this.splice(n,1),this},Array.prototype.add=function(e){return this.push(e),e},Array.prototype.append=function(e){return this.push(e),this},Array.prototype.select=function(e){return a.isString(e)?this.map((function(n){return n[e]})):this.map(e)},Array.prototype.item=function(e,n,t){return this.filter((function(t){return t[e]==n}))[0]||t},Array.prototype.contains=function(e,n){return this.item(e,n)},Array.prototype.lastItem=function(){return this[this.length-1]},Array.prototype.where=function(e){return a.isFunction(e)?this.filter(e):a.isObject(e)?this.filter(new Function("a",Object.keys(e).reduce((function(n,t,r){return n+(r>0?" && ":"")+((o=e[t])instanceof RegExp?"{1}.test(a.{0})".format(t,o):a.isString(o)?"a.{0} === '{1}'".format(t,o):"a.{0} === {1}".format(t,o));var o}),"return "))):this},Array.prototype.sortBy=function(e,n){var t=[],r=e.split(",").map((function(e,n){var r=e.split(" ");return t[n]=r[1]&&"DESC"==r[1].toUpperCase()?-1:1,r[0]}));return t[0]=n?-1:1,this.sort((function(e,n){var o=0,i=function(e,n){var a=e[r[o]],s=n[r[o]];return a<s?-1*t[o]:a>s?1*t[o]:++o<r.length?i(e,n):0};return i(e,n)})),this},Array.prototype.orderBy=function(e){var n=a.isString(e)?function(n){return n[e]}:e;return this.map((function(e){return e})).sort((function(e,t){var r=n(e),o=n(t);return r<o?-1:r>o?1:0}))},Array.prototype.distinct=function(e){void 0===e&&(e="");var n=a.isString(e)?function(n){return e?n[e]:n}:e,t=[];return this.forEach((function(e){var r=n(e);-1==t.indexOf(r)&&t.push(r)})),t},Array.prototype.groupBy=function(e){return this.reduce((function(n,t){var r=t[e];return(n[r]=n[r]||[]).push(t),n}),{})},Array.prototype.toGroupWrapper=function(e){var n=this,t=function(r,o,i){return e[i]={},n.distinct((function(e){return e[r]})).forEach((function(t){e[i][t]=n.reduce((function(e,n){return n[r]==t?e+n[o]:e}),0)})),t};return t},Array.prototype.sum=function(e){return this.reduce((function(n,t){return n+t[e]}),0)},Array.prototype.toDictionary=function(e,n){return this.reduce((function(t,r){return t[r[e]]=n?r[n]:r,t}),{})},Array.prototype.split=function(e){return this.reduce((function(n,t,r,o){return r%e?n:i(n,[o.slice(r,r+e)])}),[])},NodeList.prototype.toArray=function(){return Array.from(this)};var s=new Map,c=-1,d={subscribe:function(e,n){s.has(e)||s.set(e,[]);var t=(++c).toString();return s.get(e).push({token:t,func:n}),t},publish:function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return!!s.has(e)&&(setTimeout((function(){for(var t,r=s.get(e),o=r?r.length:0;o--;)(t=r[o]).func.apply(t,i([e],n))}),0),!0)},unsubscribe:function(e){for(var n in s.keys){var t=s.get(n);if(t)for(var r=0,o=t.length;r<o;r++)if(t[r].token===e)return t.splice(r,1),e}return!1},TOPICS:{VIEW_CHANGE:"view:change",VALUE_CHANGE:"value:change",MUNICIPIO_CHANGE:"municipio:change",WINDOW_SCROLL:"window.scroll",WINDOW_RESIZE:"window.resize",NOTIFICATION:"notification.show"}},l=["[on-click]","[on-publish]","[route-link]","[on-change]"];function u(e,n,t){var r={innerHTML:function(e,n,t){return e.innerHTML=n},innerText:function(e,n,t){return e.innerText=n},className:function(e,n){return e.className=n}};l.forEach((function(o,s){e.querySelectorAll(o).toArray().concat([e]).forEach((function(e){var c=o.replace("[","").replace("]","");if(e.attributes.getNamedItem(c)){var l=e.attributes.getNamedItem(c).value,u=l.split(":");if(0!==s){if(1===s){var p=a.getValue(u[0],d);p=p===window?u[0]:p,d.subscribe(p,(function(o,s){var c=u[1];if(c){var d=r[c]||n[c]||a.getValue(c,t);d&&d.apply(t,i([e,s],u.slice(2)))}else r.innerHTML(e,s,u[1])}))}if(2===s&&(e.onclick=function(e){return!1}),3===s){var f="SELECT"===e.tagName;if("publish"===l)return void(f?e.onchange=function(){return d.publish(d.TOPICS.VALUE_CHANGE,e)}:e.oninput=function(){return d.publish(d.TOPICS.VALUE_CHANGE,e)});var h=n[l]||a.getValue(l,t);f?e.onchange=function(){return h.apply(t,[e])}:e.oninput=function(){return h.apply(t,[e])},e.onblur=function(){return h.apply(t,[e])}}}else{var m=n[u[0]]||a.getValue(u[0],t);e.onclick=function(n){var r=u.slice(1).reduce((function(e,n){return e.push("@"==n.charAt(0)?a.getValue(n.slice(1),t):n),e}),[e,n]);return m.apply(t,r)}}}}))}))}var p=t(1),f=t.n(p);var h=function(){function e(){}return e.APP_CONFIG_NAME="ts-app",e.COLORS={GOLD:"Gold",SILVER:"Silver",BRONZE:"Bronze"},e}(),m=[];function v(e){return new Promise((function(n){if(m.indexOf(e.toLowerCase())>-1)n();else{var t=document.createElement("script");t.type="text/javascript",t.onload=function(){m.push(e.toLowerCase()),n((function(){document.getElementsByTagName("head")[0].removeChild(t),m.remove(e.toLowerCase())}))},t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}}))}var g=function(){function e(){var e,n;this._config=a.config(h.APP_CONFIG_NAME),this._document={name:"Valor inicial"},this._commandManager=(e=this._document,n={getDocument:function(){return e},undos:new Array,redos:new Array,clear:function(){n.undos.length=0,n.redos.length=0},executeCommad:function(t){try{n.undos.push(t.execute(e)),n.redos.length=0}catch(e){console.error(e)}},undo:function(){n.undos.length>0&&n.redos.push(n.undos.pop().undo(e))},redo:function(){n.redos.length>0&&n.undos.push(n.redos.pop().execute(e))}}),this._config.write("CommandsView",Date.now.toString())}return e.prototype.render=function(e){var n=this;this._content=a.build("div",{innerHTML:f.a},!0),e.innerHTML="",e.appendChild(this._content),u(e,{doCommand:function(){n._document.name="Valor inicial";var e,t=n._content.querySelector("[message-container]");t.innerHTML=n._document.name+"<br/>",n._commandManager.executeCommad(e={bak:"",execute:function(n){return this.bak=n.name,n.name=n.name.toUpperCase(),e},undo:function(n){return n.name=this.bak,e}}),t.innerHTML+=n._document.name+"<br/>",n._commandManager.undo(),t.innerHTML+=n._document.name+"<br/>",n._commandManager.redo(),t.innerHTML+=n._document.name+"<br/>"}},{}),v("./js/w3codecolor.js").then((function(){return n.__colorize()}))},e.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(e){return{e:e,mode:e.classList.contains("jsHigh")?"js":"html"}})).forEach((function(e){return e.e.innerHTML=w3CodeColorize(e.e.innerHTML,e.mode)}))},e}();var y=t(2),b=t.n(y),w=function(){function e(){this._config=a.config(h.APP_CONFIG_NAME),this._config.write("PubSubView",Date.now.toString())}return e.prototype.render=function(e){var n=this;this._content=a.build("div",{innerHTML:b.a},!0),e.innerHTML="",e.appendChild(this._content),u(e,{doPublish:function(){d.publish(d.TOPICS.NOTIFICATION,"Botón doPublish"),setTimeout((function(){d.publish(d.TOPICS.NOTIFICATION,"")}),2e3)}},{}),v("./js/w3codecolor.js").then((function(){return n.__colorize()}))},e.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(e){return{e:e,mode:e.classList.contains("jsHigh")?"js":"html"}})).forEach((function(e){return e.e.innerHTML=w3CodeColorize(e.e.innerHTML,e.mode)}))},e}(),_={get:function(e,n){return new Promise((function(t,r){var o=_.createXMLHttpRequest();o.open("GET",e,!0),n&&n(o),o.onreadystatechange=function(){4==o.readyState&&t(o.responseText)},o.onerror=function(e){r(e)},o.send(null)}))},post:function(e,n,t){return new Promise((function(r,o){var i=_.createXMLHttpRequest();i.open("POST",e,!0),t?t(i):i.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset:ISO-8859-1"),i.onreadystatechange=function(){4==i.readyState&&r(i.responseText)},i.send(n)}))},callWebMethod:function(e,n,t){var r=_.createXMLHttpRequest();r.open("POST",e,!0),r.onreadystatechange=function(){4==r.readyState&&t(r.responseText)},r.setRequestHeader("Content-type","application/json; charset=utf-8"),r.send(n)},createXMLHttpRequest:function(){return new XMLHttpRequest}},S=function(){function e(){this.BS={}}return e.prototype.generateReport=function(e,n,t){var r=this;t.clear(),t.message({type:"report.begin"});var o=e,i=o.parseData?o.parseData(o,n,t.message):n;t.message({type:"report.log.message",text:"Inicializando..."});var s=function(e,n){n.BS=r.BS,t.send(e.format(n))};function c(){m.forEach((function(e,n){if(!(n<l))return t.message({type:"report.sections.group.header",value:e.id}),e.definition.header?s(e.definition.header,e):e.definition.headerValueProvider?t.send(e.definition.headerValueProvider(e)):void 0}))}function d(e){var n=m.map((function(e){return e}));e&&n.splice(0,e),n.reverse().forEach((function(e){return t.message({type:"report.sections.group.footer",value:e.id}),e.definition.footer?s(e.definition.footer,e):e.definition.footerValueProvider?t.send(e.definition.footerValueProvider(e)):void 0}))}var l=-1,u=function(){var e=JSON.parse(o.summary||"{}");return o.onInitSummaryObject?o.onInitSummaryObject(e):e}(),p=(o.sections||[]).where({type:"header"}),f=(o.sections||[]).where({type:"total"}),h=((o.sections||[]).where({type:"footer"}),o.details||[]),m=o.groups.map((function(e,n){return{name:"G"+(n+1),id:e.id,rd:o,definition:e,current:"",data:a.clone(u),init:function(e){var n=e[this.definition.key].toString(),t=r.BS[this.name];t.all[n]=t.all[n]||[],t.all[n].push(e),t.recordCount=1,!1!==this.__resume&&(this.__resume||(this.__resume=Object.keys(this.data).length>0))&&r.copy(e,this.data)},sum:function(e){var n=e[this.definition.key].toString(),t=r.BS[this.name];t.all[n]=t.all[n]||[],t.all[n].push(e),t.recordCount+=1,!1!==this.__resume&&r.sum(e,this.data)},test:function(e){return e[this.definition.key]==this.current}}}))||[];r.BS={reportDefinition:o,mediator:t},o.iteratefn&&(t.message({type:"report.log.message",text:"Inicializando elementos..."}),i.forEach(o.iteratefn)),o.orderBy&&(t.message({type:"report.log.message",text:"Ordenando datos..."}),i.sortBy(o.orderBy,!1)),r.BS={recordCount:0,G0:a.clone(u),dataSet:i,reportDefinition:o,mediator:t},m.forEach((function(e,n){e.current=i&&i[0]?i[0][e.definition.key]:"",r.BS[e.name]={recordCount:0,all:{}}})),o.onStartfn&&o.onStartfn(r.BS),[o.sections,o.details,o.groups].reduce((function(e,n){return e.concat(n)}),[]).map((function(e){e.valueProviderfn&&(e.valueProvider=a.getValue(e.valueProviderfn,{BS:r.BS}),delete e.valueProviderfn),e.footerValueProviderfn&&(e.footerValueProvider=a.getValue(e.footerValueProviderfn,{BS:r.BS}),delete e.footerValueProviderfn),e.headerValueProviderfn&&(e.headerValueProvider=a.getValue(e.headerValueProviderfn,{BS:r.BS}),delete e.headerValueProviderfn)})),t.message({type:"report.render.rows"}),t.message({type:"report.log.message",text:"Generando informe..."}),p.forEach((function(e){return t.message({type:"report.sections.header",value:e}),e.template?s(e.template,e):e.valueProvider?t.send(e.valueProvider(e)):void 0})),i.length>0&&c(),i.forEach((function(e,n){if(r.BS.recordCount++,r.BS.isLastRow=i.length===r.BS.recordCount,r.BS.isLastRowInGroup=r.BS.isLastRow,r.BS.percent=r.BS.recordCount/i.length*100,r.BS.previous=r.BS.data||e,r.BS.data=e,m.forEach((function(e,n){r.BS[e.name].data=Object.create(e.data)})),r.sum(e,r.BS.G0),o.onRowfn&&o.onRowfn(r.BS),t.message({type:"report.render.row",text:r.BS.percent.toFixed(1)+" %",value:r.BS.percent}),m.every((function(n){return n.test(e)}))?m.forEach((function(n){n.sum(e)})):(m.some((function(n,t){return!n.test(e)&&(d(l=t),m.forEach((function(n,r){r>=l?(n.init(e),l=t):n.sum(e)})),!0)})),m.forEach((function(n){n.current=e[n.definition.key]})),o.onGroupChangefn&&o.onGroupChangefn(r.BS),t.message({type:"report.sections.group.change",value:m}),c()),m.length&&!r.BS.isLastRow){var a=i[r.BS.recordCount];r.BS.isLastRowInGroup=!m.every((function(e){var n=e.definition.key;return a[n]===r.BS.data[n]}))}h.forEach((function(e){return t.message({type:"report.sections.detail",value:e.id}),e.template?s(e.template,e):e.valueProvider?t.send(e.valueProvider(e)):void 0}))})),i.length>0&&(r.BS.previous=r.BS.data,d()),f.forEach((function(e){return t.message({type:"report.sections.total",value:e.id}),e.template?s(e.template,e):e.valueProvider?t.send(e.valueProvider(e)):void 0})),t.message({type:"report.render.end"}),t.message({type:"report.end"}),t.flush()},e.prototype.merge=function(e,n){return e.replace(/{([^{]+)?}/g,(function(e,t){if(t.indexOf(":")>0){var r=t.split(":");return r[0]=a.getValue(r[0],n),r[1]=a.getValue(r[1],n),r[0](r[1],n)}var o=a.getValue(t,n);return"function"==typeof o?o(n):o}))},e.prototype.copy=function(e,n){Object.keys(n).map((function(t){n[t]=e[t]}))},e.prototype.sum=function(e,n){Object.keys(n).map((function(t){n[t]+=e[t]}))},e.prototype.compute=function(e,n){return e.reduce((function(e,t){return e+t[n]}),0)},e.prototype.group=function(e,n){var t=e,r=function(e,o){return t.distinct((function(n){return n[e]})).forEach((function(r){n[r]=t.reduce((function(n,t,i,a){return t[e]==r?n+t[o]:n}),0)})),r};return r},e}();var x={load:function(e){var n={sections:[],groups:[],details:[]},t={},r="",o="",i=!1;function a(e){return e&&e.trim().startsWith("@")?n[e.trim().split("@")[1].trim()]||"":e?e.trim():""}function s(e){for(var n=/([a-zA-Z0-9_\-]*)\s*:\s*('[^']*'|[^\s]*)/g,t={},r=n.exec(e);null!=r;)t[r[1].trim()]=a(r[2].trim().replace(/^'([^']*)'$/g,"$1")),r=n.exec(e);return t}return e.split("\n").forEach((function(e){!function(e,n){if(!r&&!e.trim())return function(){};var a;if(!/DEFINE|#|CREATE|SET|FUNCTION|END/.test(e)){if(r)return o+=n,o+="\n",function(){};throw new Error("Tabbly : Unrecognized text")}if(/^#/.test(e))return function(){};if(/^SET (\w.*)/.test(e)){var c=e.match(/^SET (\w.*)$/);return i=!0,r=c[1].trim(),o="",function(){}}if(/^FUNCTION (\w.*)/.test(e)){var c=e.match(/^FUNCTION (\w.*)$/);return i=!1,r=c[1].trim(),o="",function(){}}if(/^END/.test(e)){var d=o,l=r;return r=o="",i?(i=!1,function(e){t[l]=d.trim()}):function(e){e[l]=new Function("ctx",d)}}if(/^DEFINE\s\s*(\w.*)\s*=\s*(.*)$/.test(e)){c=e.match(/^DEFINE\s\s*([a-zA-Z0-9_\-]*)\s*=\s*(.*)$/);return a=c,function(e){e[a[1].trim()]=a[2].trim()}}if(!/^CREATE\s\s*(\w*) (.*)$/.test(e))throw new Error("Tabbly : Unrecognized text after DEFINE");return"section"==(c=e.match(/^CREATE\s\s*(\w*) (.*)$/))[1]?function(){var e=c;return function(n){n.sections.push(s(e[2])),t=n.sections[n.sections.length-1]}}():"group"==c[1]?function(){var e=c;return function(n){n.groups.push(s(e[2])),t=n.groups[n.groups.length-1]}}():"detail"==c[1]?function(){var e=c;return function(n){n.details.push(s(e[2])),t=n.details[n.details.length-1]}}():void 0}(e.trim(),e)(n)})),n}},T=t(3),E=t.n(T),C=function(){function e(){this._config=a.config(h.APP_CONFIG_NAME),this._config.write("TabblyReportsJsView",Date.now.toString()),this._content=a.build("div",{innerHTML:E.a},!0)}return e.prototype.render=function(e){var n=this;e.innerHTML="",e.appendChild(this._content),u(e,{localInnerText:function(e,n){e.innerText=n,e.innerHTML=w3CodeColorize(e.innerHTML,"js")}},{}),this.__loadReport(this._content.querySelector("[report-container]")),v("./js/w3codecolor.js").then((function(){return n.__colorize()}))},e.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(e){return{e:e,mode:e.classList.contains("jsHigh")?"js":"html"}})).forEach((function(e){return e.e.innerHTML=w3CodeColorize(e.e.innerHTML,e.mode)}))},e.prototype.__loadReport=function(e){var n={buffer:"",send:function(e){this.buffer+=e},message:function(e){},flush:function(){},clear:function(){this.buffer=""}};v("./js/pro-0001.js").then((function(t){var r=__reportDefinition(x,a);_.get("./js/data/proveedores.json").then((function(o){n.clear(),(new S).generateReport(r,JSON.parse(o),n),e.append(a.build("div",{innerHTML:n.buffer})),u(e,{},r.getContext()),t(),d.publish("msg/rpt/data",JSON.stringify(JSON.parse(o),null,2))}))})),_.get("./js/pro-0001.js").then((function(e){d.publish("msg/rpt/definition",e)}))},e}(),I=t(4),A=t.n(I),L=function(){function e(){this._config=a.config(h.APP_CONFIG_NAME),this._config.write("TabblyReportsV2View",Date.now.toString()),this._content=a.build("div",{innerHTML:A.a},!0)}return e.prototype.render=function(e){var n=this;e.innerHTML="",e.appendChild(this._content),u(e,{localInnerText:function(e,n){e.innerText=n,e.innerHTML=w3CodeColorize(e.innerHTML,"js")}},{}),this.__loadReport(this._content.querySelector("[report-container]")),v("./js/w3codecolor.js").then((function(){return n.__colorize()}))},e.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(e){return{e:e,mode:e.classList.contains("jsHigh")?"js":"html"}})).forEach((function(e){return e.e.innerHTML=w3CodeColorize(e.e.innerHTML,e.mode)}))},e.prototype.__loadReport=function(e){var n={buffer:"",send:function(e){this.buffer+=e},message:function(e){},flush:function(){},clear:function(){this.buffer=""}};_.get("./js/pro-0001-v2.txt").then((function(t){var r=x.load(t);d.publish("msg/rpt/definition",t),_.get("./js/data/proveedores.json").then((function(t){(new S).generateReport(r,JSON.parse(t),n),e.append(a.build("div",{innerHTML:n.buffer})),u(e,{},r.getContext()),d.publish("msg/rpt/data",JSON.stringify(JSON.parse(t),null,2))}))}))},e}();function O(e,n,t){var r=function(e,r,o){var i=String.trimValues(r).reduce((function(e,t){return e.push("@"==t.charAt(0)?a.getValue(t.slice(1),n):t),e}),o);return t&&i.push(t),e.apply(n,i)};return e.replace(/{([^{]+)?}/g,(function(e,t){if(t.indexOf(":")>0){var o=String.trimValues(t.split(":")),i=a.getValue(o[0],n),s=String.trimValues(o[1].split(/=>/)),c=s[0],d=s[1],l=d?String.trimValues(d.split(/\s|\;/)):[];return r(a.getValue(c,n),l,[i])}var u=String.trimValues(t.split(/=>/)),p=u[0],f=u[1],h=a.getValue(p,n);return a.isFunction(h)?r(h,f.split(/\s|\;/),[]):h}))}function H(e,n){var t=e,r=t.querySelectorAll("[xfor]").toArray(),o=r.reduce((function(e,n){return e.concat(a.$("[xbind]",n))}),i(r)),s=t.querySelectorAll("[xbind]").toArray().filter((function(e){return!o.includes(e)}));return t.attributes.getNamedItem("xbind")&&s.push(t),s.forEach((function(e){if(e.attributes.getNamedItem("xif")){var t=new Function("ctx","return {0};".format(e.attributes.getNamedItem("xif").value).replaceAll("@","this."));e.style.display=t.apply(n)?"":"none"}a.toArray(e.attributes).where({value:/{[^{]+?}/g}).map((function(e){return e.value=O(e.value,n)})),a.toArray(e.childNodes).where({nodeType:3}).where({textContent:/{[^{]+?}/g}).forEach((function(e){return e.textContent=O(e.textContent,n,e)})),String.trimValues(e.attributes.getNamedItem("xbind").value.split(";")).forEach((function(t){if(""!==t){var r=String.trimValues(t.split(":")),o=r[0],i=r[1],s=String.trimValues(i.split(/=>/)),c=s[0],d=s[1],l=a.getValue(c,n);if(a.isFunction(l)){var u=String.trimValues((d||"").split(/\s|#/)).reduce((function(e,t){return e.push("@"==t.charAt(0)?a.getValue(t.slice(1),n):t),e}),[]);u.push(e),l=l.apply(n,u)}o&&(e[o]=l)}}))})),r.map((function(e){var t=String.trimValues(e.attributes.getNamedItem("xfor").value.split(" in ")),r=t[0],o=t[1],i=a.getValue(o,n);return i&&i!=window&&i.map((function(t,o){var i={index:o,outerScope:n};i[r]=a.clone(t);var s=H(e.cloneNode(!0),i);e.parentNode.insertBefore(s,e)})),e})).forEach((function(e){return e.parentNode.removeChild(e)})),e}var M=function(){function e(){this.BS={},this.module_ReportEngine_Copy=function(e,n){for(var t in n)if(n.hasOwnProperty(t)){if(e.hasOwnProperty(t)){n[t]=e[t];continue}if("_max_"===t||"_mim_"===t){var r=n[t];for(var o in r)r.hasOwnProperty(o)&&e.hasOwnProperty(o)&&(r[o]=e[o])}if("_values_"===t){var i=n[t];for(var o in i)i.hasOwnProperty(o)&&e.hasOwnProperty(o)&&(i[o]=[e[o]])}}},this.module_ReportEngine_Sum=function(e,n){for(var t in n)if(n.hasOwnProperty(t)){if(e.hasOwnProperty(t)){n[t]+=e[t];continue}if("_max_"===t||"_min_"===t){var r=n[t];for(var o in r)r.hasOwnProperty(o)&&e.hasOwnProperty(o)&&(r[o]="_max_"==t?e[o]>r[o]?e[o]:r[o]:e[o]<r[o]?e[o]:r[o])}if("_values_"===t){var i=n[t];for(var o in i)i.hasOwnProperty(o)&&e.hasOwnProperty(o)&&i[o].add(e[o])}}}}return e.prototype.__cloneRowTemplate=function(e){var n=e.cloneNode(!0);return e.parentNode.parentNode.deleteRow(e.rowIndex),n},e.prototype.__fillTemplate=function(e,n){var t=e.querySelectorAll("[xbind]").toArray();return e.attributes.getNamedItem("xbind")&&t.push(e),t.forEach((function(e){a.toArray(e.attributes).where({value:/{[^{]+?}/g}).map((function(e){return e.value=O(e.value,n)})),a.toArray(e.childNodes).where({nodeType:3}).where({textContent:/{[^{]+?}/g}).forEach((function(e){return e.textContent=O(e.textContent,n,e)})),String.trimValues(e.attributes.getNamedItem("xbind").value.split(";")).forEach((function(t){if(""!==t){var r=String.trimValues(t.split(":")),o=String.trimValues(r[1].split(/\s|\,/)),i=a.getValue(o[0],n);if(a.isFunction(i)){var s=o.slice(1).reduce((function(e,t){return e.push("@"==t.charAt(0)?a.getValue(t.slice(1),n):t),e}),[n,e]);i=i.apply(n,s)}else if(o[1]){i=a.getValue(o[1],n)(i,o[2],n,e)}e[r[0]]=i}}))})),e},e.prototype.__mergeTemplate=function(e,n,t,r){var o=this;if(e.forEach)return e.forEach((function(e,i){o.__mergeTemplate(e,n,t[i],r)}));this.__fillTemplate(e,{BS:this.BS}),t.tag||"nofooter"==t.tag||(n.append(e.outerHTML.replace(/xbind="[^"]*"/g,"")),r&&r({sb:n,section:t}))},e.prototype.module_ReportEngine_processAll=function(e){var n=this,t=document.createDocumentFragment();if(t.appendChild(a.build("div",{innerHTML:e.ReportTemplate},!1)),e.DetailTemplate=this.__cloneRowTemplate(t.querySelector(e.DetailTemplateSelector)),e.HideTotal){var r=t.querySelector(e.TotalTemplateSelector);r.parentNode.removeChild(r)}else e.TotalTemplate=this.__cloneRowTemplate(t.querySelector(e.TotalTemplateSelector));e.GroupsTemplates=[],e.GroupsTemplates=e.Grupos.map((function(e){return n.__cloneRowTemplate(t.querySelector(e.selector))}));var o=this,i=-1;function s(){e.Grupos.forEach((function(n,t){if(!(t<i)){var r=e.Grupos[t];if(r.header){var s=a.getValue(r.header,o)(r.current,r.name);"hidden;"!=s&&(s.text?c.append("<tr {0}>{1}</tr>".format(s.attributes,s.text)):s.row?o.BS.reportDefinition.dom_tbody.appendChild(s.row):c.append('<tr class="group-header">{0}</tr>'.format(s))),e.RepeatHeadersAfter==t&&e.RepeatHeaders.forEach((function(n){""!=n&&c.append(e.Headers[n].html)}))}}}))}var c=a.createStringBuilder("");if(e.OnStart(e.DataSet),e.DataSet.forEach((function(t,r){0==r&&s(),e.OnRow(t),e.Grupos.every((function(e){return e.test(t)}))?e.Grupos.forEach((function(e){e.sum(t)})):(e.Grupos.some((function(r,o){if(!r.test(t)){i=o;var a=e.GroupsTemplates.map((function(e){return e}));a.splice(0,o),a.reverse();var s=e.Grupos.map((function(e){return e}));return s.splice(0,o),s.reverse(),n.__mergeTemplate(a,c,s,e.OnGroupFooter),e.Grupos.forEach((function(e,n){n>=o?(e.init(t),i=o):e.sum(t)})),!0}return!1})),e.OnRowEnd(t),s()),e.HideDetail||n.__mergeTemplate(e.DetailTemplate,c,{name:"detail"},e.g)})),e.DataSet.length>0){this.BS.previous=this.BS.data;var d=e.GroupsTemplates.map((function(e){return e}));d.reverse(),e.HideTotal||d.push(e.TotalTemplate);var l=e.Grupos.map((function(e){return e}));l.reverse(),l.push({name:"summary"}),this.__mergeTemplate(d,c,l,e.OnGroupFooter)}return t.querySelector(e.ReportTableSelector).innerHTML.replace("<tbody>","<tbody>"+c.value)},e.prototype.fromReportDefinition=function(e,n,t){var r=this,o=this;this.BS={reportDefinition:e},e.Iteratefn&&n.forEach(e.Iteratefn),e.orderBy&&n.sortBy(e.orderBy,!1);var i=JSON.parse(e.summary||"{}");var s={DataSet:n,HideDetail:"true"==e.hideDetail||!1,HideTotal:0==e.groups.length||"true"==e.HideTotal||!1,ReportTemplate:e.html,ReportTableSelector:"#"+e.tableId,DetailTemplateSelector:"#"+e.details[0].id,TotalTemplateSelector:0==e.groups.length?"":"#"+e.groups.lastItem().id,Grupos:e.groups.where((function(n,t){return t<e.groups.length-1})).map((function(e,n){return{name:"G"+(n+1),selector:"#"+e.id,key:e.key,tag:e.tag||"",current:"",header:e.header,data:a.clone(i),init:function(e){var n=e[this.key].toString(),t=o.BS[this.name];t.all[n]=t.all[n]||[],t.all[n].push(e),t.recordCount=1,o.module_ReportEngine_Copy(e,this.data)},sum:function(e){var n=e[this.key].toString(),t=o.BS[this.name];t.all[n]=t.all[n]||[],t.all[n].push(e),t.recordCount+=1,o.module_ReportEngine_Sum(e,this.data)},test:function(e){return e[this.key]==this.current}}}))||[],OnGroupFooter:e.OnGroupFooter,Headers:e.headers,RepeatHeaders:(e.repeatHeader||"").split(","),RepeatHeadersAfter:e.repeatHeaderAfter,OnRow:function(n){o.BS.recordCount+=1,o.BS.previous=o.BS.data||n,o.BS.data=n,s.Grupos.forEach((function(e,n){o.BS[e.name].data=Object.create(e.data)})),o.module_ReportEngine_Sum(n,o.BS.G0),e.onRowfn&&new Function("ctx",e.onRowfn)(r.BS)},OnStart:function(n){o.BS={recordCount:0,G0:a.clone(i),dataSet:n,reportDefinition:o.BS.reportDefinition},s.Grupos.forEach((function(e,t){e.current=n&&n[0]?n[0][e.key]:"",o.BS[e.name]={recordCount:0,all:{}}})),e.onStartfn&&e.onStartfn(o.BS)},OnRowEnd:function(n){s.Grupos.forEach((function(e){e.current=n[e.key]})),e.onRowEndfn&&new Function("ctx",e.onRowEndfn)(o.BS)},PrintReport:function(e){return e&&e(r.module_ReportEngine_processAll(s)),r}};return s.PrintReport(t)},e}();var j,N,P={load:function(e){var n={headers:[],groups:[],details:[]},t=[{columns:[]}],r="",o="";function i(e){return e&&e.trim().startsWith("@")?n[e.trim().split("@")[1].trim()]||"":e?e.trim():""}function a(e){for(var n=/([a-zA-Z0-9_\-]*)\s*:\s*('[^']*'|[^\s]*)/g,t={},r=n.exec(e);null!=r;)t[r[1].trim()]=i(r[2].trim().replace(/^'([^']*)'$/g,"$1")),r=n.exec(e);return t}function s(e){var n=a(e);return n.columns=[],n}function c(e){var n=[];return Object.keys(e).filter((function(n){return"columns"!=n&&"html"!=n&&e.hasOwnProperty(n)})).forEach((function(t){var r="className"==t?"class":t;n.push('{0}="{1}"'.format(r,i(e[t])))})),n.length>0?" "+n.join(" "):""}function d(e,n){if(!r&&!e.trim())return function(){};var i;if(/^(DEFINE|#|ADD_COL|CREATE|FUNCTION|END)/.test(e)){if(/^#/.test(e))return function(){};if(/^FUNCTION (\w.*)/.test(e)){var c=e.match(/^FUNCTION (\w.*)$/);return r=c[1].trim(),o="",function(){}}if(/^END/.test(e)){var d=o,l=r;return r=o="",function(e){e[l]=new Function("ctx",d)}}if(/^ADD_COL /.test(e)){c=e.match(/ADD_COL (.*)$/);return i=c,function(e){t[t.length-1].columns.push(a(i[1]))}}if(/^DEFINE\s\s*(\w.*)\s*=\s*(.*)$/.test(e)){c=e.match(/^DEFINE\s\s*([a-zA-Z0-9_\-]*)\s*=\s*(.*)$/);return function(){var e=c;return function(n){n[e[1].trim()]=e[2].trim()}}()}if(/^CREATE\s\s*(\w*) (.*)$/.test(e))return"header"==(c=e.match(/^CREATE\s\s*(\w*) (.*)$/))[1]?function(){var e=c;return function(n){n.headers.push(s(e[2])),t=n.headers}}():"group"==c[1]?function(){var e=c;return function(n){n.groups.push(s(e[2])),t=n.groups}}():"detail"==c[1]?function(){var e=c;return function(n){n.details.push(s(e[2])),t=n.details}}():function(){var e=c;return function(n){n[e[1]]=e[2]}}();throw new Error("Tabbly : Unrecognized text after DEFINE")}if(r)return o+=n,o+="\n",function(){};throw new Error("Tabbly : Unrecognized text")}return e.split("\n").forEach((function(e){d(e.trim(),e)(n)})),n.html=function(){function e(e,n,t){var r="",o=t?"th":"td";return(e||[]).forEach((function(e,t){var a="";a+="\n      <tr{0}>".format(c(e)),e.columns.forEach((function(e,n){a+="\n        <{2}{0}>{1}</{2}>".format(c(e),i(e.html),o)})),a+="\n      </tr>",e.html=a,n&&n.indexOf(t.toString())>-1||(r+=a)})),r}return'<div id="{3}">\n  <table class= "w3-table-all" style = "width:100%;" id="table-{3}" >\n     <thead>{0}    </thead>\n    <tbody>{1}{2}    </tbody>\n  </table>\n</div>'.format(e(n.headers,(n.hiddenHeaders||"").split(","),!0),e(n.details),e(n.groups),n.tableId||"")}(),n}},B=t(5),k=t.n(B),V=function(){function e(){this._config=a.config(h.APP_CONFIG_NAME),this._config.write("TabblyReportsView",Date.now.toString()),this._content=a.build("div",{innerHTML:k.a},!0)}return e.prototype.render=function(e){var n=this;e.innerHTML="",e.appendChild(this._content),u(e,{localInnerText:function(e,n){e.innerText=n,e.innerHTML=w3CodeColorize(e.innerHTML,"js")}},{}),this.__loadReport(this._content.querySelector("[report-container]")),v("./js/w3codecolor.js").then((function(){return n.__colorize()}))},e.prototype.__colorize=function(){this._content.querySelectorAll(".jsHigh,.htmlHigh").toArray().map((function(e){return{e:e,mode:e.classList.contains("jsHigh")?"js":"html"}})).forEach((function(e){return e.e.innerHTML=w3CodeColorize(e.e.innerHTML,e.mode)}))},e.prototype.__loadReport=function(e){_.get("./js/pro-0001.txt").then((function(n){var t=P.load(n);d.publish("msg/rpt/definition",n),_.get("./js/data/proveedores.json").then((function(n){d.publish("msg/rpt/data",JSON.stringify(JSON.parse(n),null,2)),(new M).fromReportDefinition(t,JSON.parse(n),(function(n){e.append(a.build("div",{innerHTML:n},!0)),u(e,{},t.getContext())}))}))}))},e}(),D=function(){function e(){}return e.getWrapper=function(e){var n=document.getElementById(e),t={container:n,title:n.querySelector(".js-title"),body:n.querySelector(".js-content"),closeButton:n.querySelector(".js-close-button"),acceptButton:n.querySelector(".js-accept-button"),close:function(){return n.style.display="none",t},show:function(e){return e&&(t.acceptButton.onclick=function(){e(t)}),n.style.display="block",t},init:function(e){return e&&e(t),t},setTitle:function(e){return t.title.innerHTML=e,t},setBody:function(e){return e.tagName?(t.body.innerHTML="",t.body.appendChild(e)):t.body.innerHTML=e,t},disableClickOutside:function(){return t.container.onclick=function(){},t}};return t.acceptButton.onclick=t.close,t.closeButton.onclick=t.close,t.container.onclick=function(e){e.target===t.container&&t.close()},t},e}(),R=function(){function e(){}return e.paginate=function(e,n,t,r){void 0===n&&(n=1),void 0===t&&(t=10);var o=Math.ceil(e.length/t);n<1?n=1:n>o&&(n=o);var i=(n-1)*t,a=Math.min(i+t-1,e.length-1);return{totalItems:e.length,currentPage:n,pageSize:t,totalPages:o,startIndex:i,endIndex:a,allItems:e,visibleItems:e.slice(i,a+1),title:r,getChecked:function(){return e.where({__checked:!0}).map((function(n,t){return{index:e.indexOf(n),item:n}}))}}},e}(),F=t(6),G=t.n(F),q=function(){function e(){this._sortBy="",this._desc=!1,this.proveedores=[],this.current={_id:0,_nif:"",_nombre:"",_descripcion:"",_fechaDeAlta:""},this.proveedores=[],this.paginationInfo=R.paginate(this.proveedores,1,4,""),this.paginationInfo.title="Proveedores: Cargando datos..."}return e.prototype.renderTo=function(e){var n=this;return e.appendChild(a.build("div",{innerHTML:G.a},!0)),this._header=e.querySelector("[header]"),this._tbody=e.querySelector("table tbody"),d.publish("msg/table/template",this._tbody.parentElement.outerHTML),this._tr_template=e.querySelector("table tbody tr"),this._tbody.removeChild(this._tr_template),u(e,{doAction:function(e,t,r,o){n.doAction({name:r,data:o})},doGoToPage:function(e,t){n.doAction({name:"page",data:e.value})},doSearch:function(e,t){n.doAction({name:"search",data:e.value})},doSort:function(e,t){var r=["_id","_nif","_nombre","_descripcion","_fechaDeAlta"][t.target.cellIndex-1];n.doSort(r)}},{}),this},e.prototype.loadData=function(){var e=this;this.syncTitle(),_.get("js/data/proveedores.json").then((function(n){e._sortBy="_nombre",e.proveedores=JSON.parse(n).orderBy(e._sortBy),d.publish("msg/table/data",JSON.stringify(e.proveedores,null,2)),e.goToPage("first")}))},e.prototype.goToPage=function(e){var n=~~e;"current"===e&&(n=this.paginationInfo.currentPage),"first"===e&&(n=1),"last"===e&&(n=this.paginationInfo.totalPages),"previous"===e&&(n=Math.max(this.paginationInfo.currentPage-1,1)),"next"===e&&(n=Math.min(this.paginationInfo.totalPages,this.paginationInfo.currentPage+1)),this.paginationInfo=R.paginate(this.proveedores,n,4,""),this.syncTable()},e.prototype.syncTable=function(){var e=this;this.syncTitle(),this._tbody.innerHTML="",this._tbody.appendChild(this._tr_template.cloneNode(!0)),this.paginationInfo.fn={checked:function(e,n){return e.__checked?"checked":""}},u(H(this._tbody,this.paginationInfo),{doAction:function(n,t,r,o){e.doAction({name:r,data:o})},doAddToFavorites:function(n,t,r,o){console.log("Current -> Id : {_id}, Nif : {_nif}".merge(e.proveedores[0])),console.log(e.proveedores.select("_id")),console.log("Add to favorites {0}, {1}".format(1,2))}},{})},e.prototype.syncTitle=function(){var e=this.paginationInfo.totalItems,n=this.paginationInfo.getChecked().length,t="Proveedores: {0} elementos".format(e),r=" ({0} seleccionados)".format(n);this.paginationInfo.title=n?t+r:t,H(this._header,this.paginationInfo)},e.prototype.goToPageOf=function(e){var n=this.proveedores.indexOf(e);if(n>-1){var t=Math.floor(n/this.paginationInfo.pageSize);this.goToPage((t+1).toString())}},e.prototype.doSort=function(e){this._sortBy&&this._sortBy==e?this._desc=!this._desc:this._desc=!1,this._sortBy=e,this.proveedores=this.proveedores.sortBy(e,this._desc),this.goToPage("first")},e.prototype.doAction=function(e){if("page"===e.name)return this.goToPage(e.data);if("first"===e.name||"previous"===e.name||"next"===e.name||"last"===e.name)return this.goToPage(e.name);if("check-item"===e.name){var n=this.paginationInfo.visibleItems[e.data];n.__checked=!n.__checked,this.syncTitle()}if("delete"===e.name)return this.delete();if("new"===e.name)return this.insert();if("edit"===e.name){var t=this.paginationInfo.getChecked();if(0==t.length)return;return this.edit(t[0].item)}if("edit-row"===e.name){var r=~~e.data,o=this.proveedores.where({_id:r})[0];return this.edit(o)}return"search"===e.name?e.data?(this.proveedores=this.proveedores.where((function(n){return n._nombre.toLowerCase().includes(e.data.toLowerCase())})),this.goToPage("first")):this.loadData():void 0},e.prototype.delete=function(){var e=this,n=this.paginationInfo.getChecked();if(0!=n.length){var t=n[0].item;D.getWrapper("dialog-container").setTitle("Borrar proveedores").setBody("¿Está seguro de eliminar el proveedor seleccionado?").show((function(n){e.proveedores.remove(t),e.goToPage("current"),n.close()}))}},e.prototype.insert=function(){var e=this;this._dialog=this._dialog||a.$("proveedor-edit-dialog"),this.current={_id:0,_nif:"",_nombre:"",_descripcion:"",_fechaDeAlta:""},H(this._dialog,this.current),D.getWrapper("dialog-container").setTitle("Nuevo vehículo").setBody(this._dialog).disableClickOutside().show((function(n){a.$("txt-nif").value,a.$("txt-nombre").value,a.$("txt-descripcion").value;var t={_id:56,_nif:"aaaa",_nombre:"rrr",_descripcion:"rrr",_fechaDeAlta:"01/02/2020"};e.current=t,e.proveedores.push(t),e.paginationInfo.visibleItems.push(t),e._dialog.style.display="none",n.close(),e.proveedores=e.proveedores.sortBy(e._sortBy,e._desc),e.goToPageOf(t)})),this._dialog.style.display="block"},e.prototype.edit=function(e){var n=this;this._dialog=this._dialog||a.$("proveedor-edit-dialog"),this.current=e,D.getWrapper("dialog-container").setTitle("Edición de proveedores").setBody(this._dialog).disableClickOutside().init((function(e){H(n._dialog,n.current)})).show((function(e){var t={_id:~~a.$("txt-id").value,_nif:a.$("txt-nif").value,_nombre:a.$("txt-nombre").value,_descripcion:a.$("txt-descripcion").value,_fechaDeAlta:""};n.current._nif=t._nif,n.current._nombre=t._nombre,n.current._descripcion=t._descripcion,n._dialog.style.display="none",e.close()})),this._dialog.style.display="block"},e}(),z=t(7),U=t.n(z),W=function(){function e(){this._config=a.config(h.APP_CONFIG_NAME),this._config.write("TablesView",Date.now.toString()),this._content=a.build("div",{innerHTML:U.a},!0)}return e.prototype.render=function(e){var n=this;e.innerHTML="",e.appendChild(this._content),u(e,{localInnerText:function(e,n,t){e.innerText=n,v("./js/w3codecolor.js").then((function(){return e.innerHTML=w3CodeColorize(e.innerHTML,t)}))}},{});var t=this._content.querySelector("[table-container]");(new q).renderTo(t).loadData(),v("./js/w3codecolor.js").then((function(){return n.__colorize()}))},e.prototype.__colorize=function(){this._content.querySelectorAll(".js").toArray().forEach((function(e){return e.innerHTML=w3CodeColorize(e.innerHTML,"js")}))},e}(),J=t(8),$=t.n(J),X=function(){function e(n,t,r){var o=this;this.currentIndex=-1,this.previous=void 0,this.table=n;var i=function(n){var r=n.target,i=r.parentNode;o.previous=r.textContent.trim(),o.currentIndex=i.rowIndex;var a={tr:i,td:r,target:r,current:o.previous};d.publish(e.OnfocusMessage,a),t&&t(o,a)},a=function(n){var t=n.target,i=t.parentNode;if(null!=o.previous&&o.previous!=t.textContent.trim()){var a={tr:i,td:t,target:t,previous:o.previous,current:t.textContent.trim()};d.publish(e.OnChangeMessage,a),r&&r(o,a),o.previous=void 0}};n.querySelectorAll("td[contenteditable]").toArray().forEach((function(e){e.onblur=a,e.onfocus=i})),n.onkeypress=function(e){if(13==e.keyCode)return e.preventDefault&&e.preventDefault(),!1},n.onkeydown=function(e){var t=!0,r=e.target;if("TD"==r.tagName&&[13,37,38,39,40].indexOf(e.keyCode)>-1){var o=r,i=r.parentNode,a=window.getSelection().getRangeAt(0).startOffset,s=function(n,r,o){e.preventDefault();try{n.rows[r].cells[o].focus()}catch(e){}t=!1};13==e.keyCode&&s(n,i.rowIndex,o.cellIndex+1),38==e.keyCode&&i.rowIndex>1&&s(n,i.rowIndex-1,o.cellIndex),40==e.keyCode&&i.rowIndex<n.rows.length-1&&s(n,i.rowIndex+1,o.cellIndex),39==e.keyCode&&a==r.textContent.length&&s(n,i.rowIndex,o.cellIndex+1),37==e.keyCode&&0==a&&s(n,i.rowIndex,o.cellIndex-1)}return t}}return e.OnfocusMessage="editable-grid/focus",e.OnChangeMessage="editable-grid/change",e}(),Z='<div class="scv_overlayText"></div><div class="scv_overlayLine"></div><div class="scv_Main">  <pre class="scv_LineContainer" id="svc_{0}_line"></pre>  <pre class="scv_TextContainer" id="svc_{0}_code"></pre></div>',Q=0,Y=function(){function e(){var e=this;this._control=a.build("div",{className:"svc_viewer",id:"svc_{0}".format(++Q),innerHTML:Z.format(Q)}),this._control.querySelector(".scv_Main").onscroll=function(n){var t=n.target;e._control.querySelector(".scv_overlayText").style.left="-{0}px".format(t.scrollLeft),e._control.querySelector(".scv_overlayLine").style.left="-{0}px".format(t.scrollLeft)}}return e.prototype.setContent=function(e){var n=0;return this._control.querySelector(".scv_LineContainer").innerHTML=(e+"\r\n").replace(/(.*)\r\n|\r|\n/gm,(function(){return++n+"<br/>"})),this._control.querySelector(".scv_TextContainer").textContent=e,this},e.prototype.getControl=function(){return this._control},e}(),K=function(){function e(){this._config=a.config(h.APP_CONFIG_NAME),this._data=[{id:1,descripcion:"Descripción 1"},{id:2,descripcion:"Descripción 2"},{id:3,descripcion:"Descripción 3"}],this._config.write("ContentEditableView",Date.now.toString()),this._textViewer=new Y}return e.prototype.render=function(e){var n=this;this._content=a.build("div",{innerHTML:$.a},!0),e.innerHTML="",e.appendChild(this._content),H(e,{data:this._data}),u(e,{writeLog:function(e,n,t){if(t&&"append"==t)return e.innerHTML+=n+"<br/>";e.innerHTML=n},doSave:function(){var t=e.querySelectorAll("td[data-index]").toArray().map((function(e){return e.textContent})).split(2).map((function(e,t){return{source:n._data[t],edit:{id:e[0],descripcion:e[1]}}}));d.publish("msg/log",JSON.stringify(t,null,2))}},{});var t=e.querySelector("table");this._editableGrid=new X(t,(function(e,n){n.td.style.outline="0px solid transparent";d.publish("msg/log","onfocus -> [{td.dataset.index}, {td.cellIndex}] id: {tr.id}".format(n))}),(function(e,n){d.publish("msg/log","onChange -> [{td.dataset.index}, {td.cellIndex}] id: {tr.id} [ {previous} -> {current}]".format(n))})),e.querySelector("[text-viewer]").appendChild(this._textViewer.getControl()),_.get("./js/pro-0001.txt").then((function(e){n._textViewer.setContent(e)}))},e}();j=document.getElementById("app-content"),N=a.config(h.APP_CONFIG_NAME),j.innerHTML=o.a,u(j,{openLink:function(e,n,t){document.querySelectorAll(".city").toArray().forEach((function(e){return e.style.display=e.id==t?"block":"none"})),document.querySelectorAll(".tablink").toArray().forEach((function(e){return e.classList.remove("w3-red")})),e.className+=" w3-red";var r=a.$(t);"VIEW-COMMANDS"==t&&(new g).render(r),"VIEW-PUB-SUB"==t&&(new w).render(r),"VIEW-TABLES"==t&&(new W).render(r),"VIEW-REPORTS"==t&&(new V).render(r),"VIEW-REPORTS-V2"==t&&(new L).render(r),"VIEW-REPORTS-JS"==t&&(new C).render(r),"VIEW-CONTENT-EDITABLE"==t&&(new K).render(r)}},{}),N.write("LastUsed",Date.now.toString())}]);